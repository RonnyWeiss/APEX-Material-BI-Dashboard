!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("d3-axis"),require("d3-brush"),require("d3-color"),require("d3-drag"),require("d3-dsv"),require("d3-ease"),require("d3-interpolate"),require("d3-scale"),require("d3-selection"),require("d3-shape"),require("d3-time-format"),require("d3-transition"),require("d3-zoom"));else if("function"==typeof define&&define.amd)define(["d3-axis","d3-brush","d3-color","d3-drag","d3-dsv","d3-ease","d3-interpolate","d3-scale","d3-selection","d3-shape","d3-time-format","d3-transition","d3-zoom"],e);else{var i,n="object"==typeof exports?e(require("d3-axis"),require("d3-brush"),require("d3-color"),require("d3-drag"),require("d3-dsv"),require("d3-ease"),require("d3-interpolate"),require("d3-scale"),require("d3-selection"),require("d3-shape"),require("d3-time-format"),require("d3-transition"),require("d3-zoom")):e(t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3);for(i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(this,function(e,a,r,s,o,c,l,u,d,h,g,f,p){return function(){"use strict";var i=[,,function(t){t.exports=d},function(t){t.exports=a},function(t){t.exports=g},function(t){t.exports=o},function(t){t.exports=u},function(t){t.exports=s},function(t){t.exports=f},function(t){t.exports=h},function(t){t.exports=e},function(t){t.exports=c},function(t){t.exports=l},function(t){t.exports=r},function(t){t.exports=p}],n={};function Ri(t){var e=n[t];if(void 0!==e)return e.exports;e=n[t]={exports:{}};return i[t](e,e.exports,Ri),e.exports}Ri.d=function(t,e){for(var i in e)Ri.o(e,i)&&!Ri.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},Ri.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},Ri.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var Li={};return function(){Ri.r(Li),Ri.d(Li,{bb:function(){return Ei},default:function(){return Ei}});var e={};Ri.r(e),Ri.d(e,{area:function(){return Ze},areaLineRange:function(){return qe},areaSpline:function(){return Ke},areaSplineRange:function(){return Je},areaStep:function(){return Qe},bar:function(){return oi},bubble:function(){return ci},candlestick:function(){return li},donut:function(){return ni},gauge:function(){return ai},line:function(){return ti},pie:function(){return ri},radar:function(){return si},scatter:function(){return ui},spline:function(){return ei},step:function(){return ii}});var i={};Ri.r(i),Ri.d(i,{selection:function(){return Ai},subchart:function(){return ki},zoom:function(){return Si}});var o=Ri(4),D=Ri(2),I={arc:"bb-arc",arcLabelLine:"bb-arc-label-line",arcs:"bb-arcs",area:"bb-area",areas:"bb-areas",axis:"bb-axis",axisX:"bb-axis-x",axisXLabel:"bb-axis-x-label",axisY:"bb-axis-y",axisY2:"bb-axis-y2",axisY2Label:"bb-axis-y2-label",axisYLabel:"bb-axis-y-label",bar:"bb-bar",bars:"bb-bars",brush:"bb-brush",button:"bb-button",buttonZoomReset:"bb-zoom-reset",candlestick:"bb-candlestick",candlesticks:"bb-candlesticks",chart:"bb-chart",chartArc:"bb-chart-arc",chartArcs:"bb-chart-arcs",chartArcsBackground:"bb-chart-arcs-background",chartArcsGaugeMax:"bb-chart-arcs-gauge-max",chartArcsGaugeMin:"bb-chart-arcs-gauge-min",chartArcsGaugeUnit:"bb-chart-arcs-gauge-unit",chartArcsTitle:"bb-chart-arcs-title",chartArcsGaugeTitle:"bb-chart-arcs-gauge-title",chartBar:"bb-chart-bar",chartBars:"bb-chart-bars",chartCandlestick:"bb-chart-candlestick",chartCandlesticks:"bb-chart-candlesticks",chartCircles:"bb-chart-circles",chartLine:"bb-chart-line",chartLines:"bb-chart-lines",chartRadar:"bb-chart-radar",chartRadars:"bb-chart-radars",chartText:"bb-chart-text",chartTexts:"bb-chart-texts",circle:"bb-circle",circles:"bb-circles",colorPattern:"bb-color-pattern",colorScale:"bb-colorscale",defocused:"bb-defocused",dragarea:"bb-dragarea",empty:"bb-empty",eventRect:"bb-event-rect",eventRects:"bb-event-rects",eventRectsMultiple:"bb-event-rects-multiple",eventRectsSingle:"bb-event-rects-single",focused:"bb-focused",gaugeValue:"bb-gauge-value",grid:"bb-grid",gridLines:"bb-grid-lines",legend:"bb-legend",legendBackground:"bb-legend-background",legendItem:"bb-legend-item",legendItemEvent:"bb-legend-item-event",legendItemFocused:"bb-legend-item-focused",legendItemHidden:"bb-legend-item-hidden",legendItemPoint:"bb-legend-item-point",legendItemTile:"bb-legend-item-tile",level:"bb-level",levels:"bb-levels",line:"bb-line",lines:"bb-lines",main:"bb-main",region:"bb-region",regions:"bb-regions",selectedCircle:"bb-selected-circle",selectedCircles:"bb-selected-circles",shape:"bb-shape",shapes:"bb-shapes",stanfordElements:"bb-stanford-elements",stanfordLine:"bb-stanford-line",stanfordLines:"bb-stanford-lines",stanfordRegion:"bb-stanford-region",stanfordRegions:"bb-stanford-regions",subchart:"bb-subchart",target:"bb-target",text:"bb-text",texts:"bb-texts",title:"bb-title",tooltip:"bb-tooltip",tooltipContainer:"bb-tooltip-container",tooltipName:"bb-tooltip-name",valueDown:"bb-value-down",valueUp:"bb-value-up",xgrid:"bb-xgrid",xgridFocus:"bb-xgrid-focus",xgridLine:"bb-xgrid-line",xgridLines:"bb-xgrid-lines",xgrids:"bb-xgrids",ygrid:"bb-ygrid",ygridFocus:"bb-ygrid-focus",ygridLine:"bb-ygrid-line",ygridLines:"bb-ygrid-lines",ygrids:"bb-ygrids",zoomBrush:"bb-zoom-brush",EXPANDED:"_expanded_",SELECTED:"_selected_",INCLUDED:"_included_",TextOverlapping:"text-overlapping"},n={element:function(){return{chart:null,main:null,svg:null,axis:{x:null,y:null,y2:null,subX:null},defs:null,tooltip:null,legend:null,title:null,subchart:{main:null,bar:null,line:null,area:null},arcs:null,bar:null,candlestick:null,line:null,area:null,circle:null,radar:null,text:null,grid:{main:null,x:null,y:null},gridLines:{main:null,x:null,y:null},region:{main:null,list:null},eventRect:null,zoomResetBtn:null}},state:function(){return{width:0,width2:0,height:0,height2:0,margin:{top:0,bottom:0,left:0,right:0},margin2:{top:0,bottom:0,left:0,right:0},margin3:{top:0,bottom:0,left:0,right:0},arcWidth:0,arcHeight:0,xAxisHeight:0,hasAxis:!1,hasRadar:!1,current:{width:0,height:0,dataMax:0,maxTickWidths:{x:{size:0,ticks:[],clipPath:0,domain:""},y:{size:0,domain:""},y2:{size:0,domain:""}},types:[]},isLegendRight:!1,isLegendInset:!1,isLegendTop:!1,isLegendLeft:!1,legendStep:0,legendItemWidth:0,legendItemHeight:0,legendHasRendered:!1,eventReceiver:{currentIdx:-1,rect:{},data:[],coords:[]},axis:{x:{padding:{left:0,right:0},tickCount:0}},rotatedPadding:{left:30,right:0,top:5},withoutFadeIn:{},inputType:"",datetimeId:"",clip:{id:"",idXAxis:"",idYAxis:"",idXAxisTickTexts:"",idGrid:"",idSubchart:"",path:"",pathXAxis:"",pathYAxis:"",pathXAxisTickTexts:"",pathGrid:""},event:null,dragStart:null,dragging:!1,flowing:!1,cancelClick:!1,mouseover:!1,rendered:!1,transiting:!1,redrawing:!1,resizing:!1,toggling:!1,zooming:!1,hasNegativeValue:!1,hasPositiveValue:!0,orgAreaOpacity:"0.2",hiddenTargetIds:[],hiddenLegendIds:[],focusedTargetIds:[],defocusedTargetIds:[],radius:0,innerRadius:0,outerRadius:void 0,innerRadiusRatio:0,gaugeArcWidth:0,radiusExpanded:0,xgridAttr:{x1:null,x2:null,y1:null,y2:null}}}},a=function(){function t(){var e=this;Object.keys(n).forEach(function(t){e[t]=new n[t]})}return t.prototype.getStore=function(t){return this[t]},t}();function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var s={bindto:"#chart",background:{},clipPath:!0,svg_classname:void 0,size_width:void 0,size_height:void 0,padding_left:void 0,padding_right:void 0,padding_top:void 0,padding_bottom:void 0,resize_auto:!0,onover:void 0,onout:void 0,onresize:void 0,onresized:void 0,onbeforeinit:void 0,oninit:void 0,onafterinit:void 0,onrendered:void 0,transition_duration:350,plugins:[],render:{},regions:[]},c={data_x:void 0,data_idConverter:function(t){return t},data_names:{},data_classes:{},data_type:void 0,data_types:{},data_order:"desc",data_groups:[],data_color:void 0,data_colors:{},data_labels:{},data_labels_backgroundColors:void 0,data_labels_colors:void 0,data_labels_position:{},data_hide:!1,data_filter:void 0,data_onclick:function(){},data_onover:function(){},data_onout:function(){},data_onshown:void 0,data_onhidden:void 0,data_onmin:void 0,data_onmax:void 0,data_url:void 0,data_headers:void 0,data_json:void 0,data_rows:void 0,data_columns:void 0,data_mimeType:"csv",data_keys:void 0,data_empty_label_text:""},l={color_pattern:[],color_tiles:void 0,color_threshold:{},color_onover:void 0},u={interaction_enabled:!0,interaction_brighten:!0,interaction_inputType_mouse:!0,interaction_inputType_touch:{}},d={legend_show:!0,legend_hide:!1,legend_contents_bindto:void 0,legend_contents_template:void 0,legend_position:"bottom",legend_inset_anchor:"top-left",legend_inset_x:10,legend_inset_y:0,legend_inset_step:void 0,legend_item_onclick:void 0,legend_item_onover:void 0,legend_item_onout:void 0,legend_equally:!1,legend_padding:0,legend_item_tile_width:10,legend_item_tile_height:10,legend_usePoint:!1},h={title_text:void 0,title_padding:{top:0,right:0,bottom:0,left:0},title_position:"center"},g={tooltip_show:!0,tooltip_doNotHide:!1,tooltip_grouped:!0,tooltip_format_title:void 0,tooltip_format_name:void 0,tooltip_format_value:void 0,tooltip_position:void 0,tooltip_contents:{},tooltip_init_show:!1,tooltip_init_x:0,tooltip_init_position:{top:"0px",left:"50px"},tooltip_linked:!1,tooltip_linked_name:"",tooltip_onshow:function(){},tooltip_onhide:function(){},tooltip_onshown:function(){},tooltip_onhidden:function(){},tooltip_order:null},f=Ri(3),p="object"==typeof globalThis&&null!==globalThis&&globalThis.Object===Object&&globalThis||"object"==typeof global&&null!==global&&global.Object===Object&&global||"object"==typeof self&&null!==self&&self.Object===Object&&self||Function("return this")();p.requestIdleCallback=p.requestIdleCallback||function(t){return setTimeout(t,1)},p.cancelIdleCallback=p.cancelIdleCallback||function(t){return clearTimeout(t)};var P=p&&p.document;function x(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}function v(e){for(var i,t=1;t<arguments.length;t++)i=null==arguments[t]?{}:arguments[t],t%2?x(Object(i),!0).forEach(function(t){r(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))});return e}function z(t){return t||0===t}function M(t){return void 0===t}function X(t){return void 0!==t}function _(t){return"boolean"==typeof t}function m(t){return 10*Math.ceil(t/10)}function y(t){return Math.ceil(t)+.5}function k(t){return t[1]-t[0]}function b(t){return"object"==typeof t}function T(t){return M(t)||null===t||w(t)&&0===t.length||b(t)&&!(t instanceof Date)&&0===Object.keys(t).length||F(t)&&isNaN(t)}var O=function(t){return"function"==typeof t},w=function(t){return"string"==typeof t},F=function(t){return"number"==typeof t},$=function(t){return!T(t)},B=function(t){return Array.isArray(t)},N=function(t){return t&&!t.nodeType&&b(t)&&!B(t)};function A(t,e,i){return X(t[e])?t[e]:i}function S(t){for(var e=O(t),i=arguments.length,n=Array(1<i?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];return e&&t.call.apply(t,n),e}function C(t,n){function e(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];--a||n.apply.apply(n,[this].concat(e))}var a=0;"duration"in t?t.each(function(){return++a}).on("end",e):(++a,t.call(e))}function Y(t){return w(t)?t.replace(/</g,"&lt;").replace(/>/g,"&gt;"):t}function E(i,t,n,e){var a,r;void 0===n&&(n=[-1,1]),void 0===e&&(e=!1),i&&w(t)&&(-1===t.indexOf("\n")?i.text(t):(a=[i.text(),t].map(function(t){return t.replace(/[\s\n]/g,"")}))[0]!==a[1]&&(t=t.split("\n"),r=e?t.length-1:1,i.html(""),t.forEach(function(t,e){i.append("tspan").attr("x",0).attr("dy",(0===e?n[0]*r:n[1])+"em").text(t)})))}function R(t){var e=t.getBBox(),i=e.x,n=e.y,t=e.width,e=e.height;return[{x:i,y:n+e},{x:i,y:n},{x:i+t,y:n},{x:i+t,y:n+e}]}function L(t,e){var i=t&&(t.touches||t.sourceEvent&&t.sourceEvent.touches);return t?(0,D.pointer)(i?i[0]:t,e):[0,0]}function G(t){var e,i=t.event,t=t.$el,t=t.subchart.main||t.main;return i&&"brush"===i.type?e=i.selection:t&&(e=t.select("."+I.brush).node())&&(e=(0,f.brushSelection)(e)),e}function V(t){return!("rect"in t)||"rect"in t&&t.hasAttribute("width")&&t.rect.width!==+t.getAttribute("width")?t.rect=t.getBoundingClientRect():t.rect}function j(t){void 0===t&&(t=!0);var e=Math.random();return t?e+"":e}function H(t){t=G(t);return!t||t[0]===t[1]}function W(e,t){for(var i in void 0===e&&(e={}),B(t)&&t.forEach(function(t){return W(e,t)}),t)/^\d+$/.test(i)||i in e||(e[i]=t[i]);return e}function U(t){return t.charAt(0).toUpperCase()+t.slice(1)}var Z=function(t){return[].slice.call(t)};function q(t){return(t=(t=t?t.transform:null)&&t.baseVal)&&t.numberOfItems?t.getItem(0).matrix:{a:0,b:0,c:0,d:0,e:0,f:0}}function K(t){var e=t[0]instanceof Date,t=(e?t.map(Number):t).filter(function(t,e,i){return i.indexOf(t)===e});return e?t.map(function(t){return new Date(t)}):t}function J(t){return t&&t.length?t.reduce(function(t,e){return t.concat(e)}):[]}function Q(i){for(var t=arguments.length,e=Array(1<t?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];if(!e.length||1===e.length&&!e[0])return i;var a=e.shift();return N(i)&&N(a)&&Object.keys(a).forEach(function(t){var e=a[t];N(e)?(i[t]||(i[t]={}),i[t]=Q(i[t],e)):i[t]=B(e)?e.concat():e}),Q.apply(void 0,[i].concat(e))}function tt(t,e){var i;return void 0===e&&(e=!0),t[0]instanceof Date?i=e?function(t,e){return t-e}:function(t,e){return e-t}:e&&!t.every(isNaN)?i=function(t,e){return t-e}:e||(i=function(t,e){return(e<t?-1:t<e&&1)||t===e&&0}),t.concat().sort(i)}function et(t,e){e=e.filter(function(t){return $(t)});return e.length?F(e[0])?e=Math[t].apply(Math,e):e[0]instanceof Date&&(e=tt(e,"min"===t)[0]):e=void 0,e}function it(t,e,i){void 0===i&&(i=1);for(var n=[],a=0|Math.max(0,Math.ceil((e-t)/i)),r=t;r<a;r++)n.push(t+r*i);return n}var nt={mouse:function(){function a(){return{bubbles:!1,cancelable:!1,screenX:0,screenY:0,clientX:0,clientY:0}}try{return new MouseEvent("t"),function(t,e,i){void 0===i&&(i=a()),t.dispatchEvent(new MouseEvent(e,i))}}catch(t){return function(t,e,i){void 0===i&&(i=a());var n=P.createEvent("MouseEvent");n.initMouseEvent(e,i.bubbles,i.cancelable,p,0,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}}(),touch:function(t,e,i){i=new Touch(Q({identifier:Date.now(),target:t,radiusX:2.5,radiusY:2.5,rotationAngle:10,force:.5},i));t.dispatchEvent(new TouchEvent(e,{cancelable:!0,bubbles:!0,shiftKey:!0,touches:[i],targetTouches:[],changedTouches:[i]}))}};function at(t,e){var i,n=t;for(i in e)n=n.replace(new RegExp("{="+i+"}","g"),e[i]);return n}function rt(t){var e,i;return t instanceof Date?i=t:w(t)?(e=this.config,i=this.format.dataTime(e.data_xFormat)(t)):F(t)&&!isNaN(t)&&(i=new Date(+t)),(!i||isNaN(+i))&&console&&console.error&&console.error("Failed to parse x '"+t+"' to Date object"),i}function st(){return!P.hidden}function ot(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}function ct(e){for(var i,t=1;t<arguments.length;t++)i=null==arguments[t]?{}:arguments[t],t%2?ot(Object(i),!0).forEach(function(t){r(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ot(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))});return e}var lt=function(){function t(){return function(){for(var t,n=(t=function(t){if(N(t)&&t.constructor){var e,i=new t.constructor;for(e in t)i[e]=n(t[e]);return i}return t},r.toString=function(){return t.toString()},r),e=arguments.length,i=Array(e),a=0;a<e;a++)i[a]=arguments[a];function r(){return t.apply(this,arguments)}return i.map(function(t){return n(t)}).reduce(function(t,e){return v(v({},t),e)})}(s,c,l,u,d,h,g,t.data)}return t.setOptions=function(t){this.data=t.reduce(function(t,e){return ct(ct({},t),e)},this.data)},t}();lt.data={};var ut="$baseLength",dt="__colorPattern__",ht="$dataMinMax",gt="$dataTotalSum",t="$totalPerIndex",ft="legendItemTextBox",pt="$radarPoints",xt="setOverOut",vt="callOverOutForTouch",_t="textRect",mt=function(){function t(){this.cache={}}var e=t.prototype;return e.add=function(t,e,i){return this.cache[t]=(i=void 0===i?!1:i)?this.cloneTarget(e):e,this.cache[t]},e.remove=function(t){var e=this;Z(t).forEach(function(t){return delete e.cache[t]})},e.get=function(t,e){if(e=void 0===e?!1:e){for(var i,n=[],a=0;i=t[a];a++)i in this.cache&&n.push(this.cloneTarget(this.cache[i]));return n}e=this.cache[t];return z(e)?e:null},e.reset=function(t){for(var e in this.cache)(t||/^\$/.test(e))&&(this.cache[e]=null)},e.cloneTarget=function(t){return{id:t.id,id_org:t.id_org,values:t.values.map(function(t){return{x:t.x,value:t.value,id:t.id}})}},t}(),yt=p.setTimeout,bt=p.clearTimeout;function Tt(){function t(t,a){var r;!function t(){for(var e,i=0,n=0;e=s[n];n++)if(!0===e||e.empty&&e.empty())i++;else try{e.transition()}catch(t){i++}r&&bt(r),i===s.length?a&&a():r=yt(t,50)}()}var s=[];return t.add=function(t){B(t)?s=s.concat(t):s.push(t)},t}var wt=Ri(5),At={convertData:function(i,t){var n;if(i.bindto?(n={},["url","mimeType","headers","keys","json","keys","rows","columns"].forEach(function(t){var e="data_"+t;e in i&&(n[t]=i[e])})):n=i,n.url&&t)this.convertUrlToData(n.url,n.mimeType,n.headers,n.keys,t);else if(n.json)n=this.convertJsonToData(n.json,n.keys);else if(n.rows)n=this.convertRowsToData(n.rows);else if(n.columns)n=this.convertColumnsToData(n.columns);else if(i.bindto)throw Error("url or json or rows or columns is required.");return B(n)&&n},convertUrlToData:function(e,i,n,a,r){var s=this;void 0===i&&(i="csv");var o=new XMLHttpRequest;o.open("GET",e),n&&Object.keys(n).forEach(function(t){o.setRequestHeader(t,n[t])}),o.onreadystatechange=function(){if(4===o.readyState){if(200!==o.status)throw new Error(e+": Something went wrong loading!");var t=o.responseText;t&&r.call(s,s["convert"+U(i)+"ToData"]("json"===i?JSON.parse(t):t,a))}},o.send()},convertCsvTsvToData:function(t,e){var i,n=t.rows(e);return 1===n.length?(i=[{}],n[0].forEach(function(t){i[0][t]=null})):i=t.parse(e),i},convertCsvToData:function(t){return this.convertCsvTsvToData({rows:wt.csvParseRows,parse:wt.csvParse},t)},convertTsvToData:function(t){return this.convertCsvTsvToData({rows:wt.tsvParseRows,parse:wt.tsvParse},t)},convertJsonToData:function(i,t){var n,a=this,e=this.config,r=[],s=B(i)?((s=t||e.data_keys).x?(n=s.value.concat(s.x),e.data_x=s.x):n=s.value,r.push(n),i.forEach(function(e){var t=n.map(function(t){t=a.findValueInJson(e,t);return t=M(t)?null:t});r.push(t)}),this.convertRowsToData(r)):(Object.keys(i).forEach(function(t){var e=i[t].concat();e.unshift(t),r.push(e)}),this.convertColumnsToData(r));return s},findValueInJson:function(t,e){if(void 0!==t[e])return t[e];var e=e.replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split("."),i=t;return e.some(function(t){return!(i=i&&t in i?i[t]:void 0)}),i},convertRowsToData:function(t){var a=t[0],e=[];return t.forEach(function(t,i){var n;0<i&&(n={},t.forEach(function(t,e){if(M(t))throw new Error("Source data is missing a component at ("+i+", "+e+")!");n[a[e]]=t}),e.push(n))}),e},convertColumnsToData:function(t){var a=[];return t.forEach(function(t,i){var n=t[0];t.forEach(function(t,e){if(0<e){if(M(a[e-1])&&(a[e-1]={}),M(t))throw new Error("Source data is missing a component at ("+i+", "+e+")!");a[e-1][n]=t}})}),a},convertDataToTargets:function(t,n){var a=this,h=this,e=h.axis,g=h.config,f=h.state,i=!1,r=!1,p=!1;e&&(i=e.isCategorized(),r=e.isTimeSeries(),p=e.isCustomX());var s,o=Object.keys(t[0]||{}),e=o.length?o.filter(h.isNotX,h):[],c=o.length?o.filter(h.isX,h):[];e.forEach(function(i){var e=a.getXKey(i);p||r?0<=c.indexOf(e)?s=(n&&h.data.xs[i]||[]).concat(t.map(function(t){return t[e]}).filter(z).map(function(t,e){return h.generateTargetX(t,i,e)})):g.data_x?s=a.getOtherTargetXs():$(g.data_xs)&&(s=h.getXValuesOfXKey(e,h.data.targets)):s=t.map(function(t,e){return e}),s&&(a.data.xs[i]=s)}),e.forEach(function(t){if(!a.data.xs[t])throw new Error('x is not defined for id = "'+t+'".')});e=e.map(function(a,r){var s=g.data_idConverter.bind(h.api)(a),o=h.getXKey(a),c=p&&i,l=c&&t.map(function(t){return t.x}).every(function(t){return-1<g.axis_x_categories.indexOf(t)}),u=t.__append__,d=null===o&&u?h.api.data.values(a).length:0;return{id:s,id_org:a,values:t.map(function(t,e){var i,n=t[o],t=null===(t=t[a])||isNaN(t)||N(t)?B(t)||N(t)?t:null:+t;return!c&&!f.hasRadar||0!==r||M(n)?i=h.generateTargetX(n,a,d+e):(l||0!==r||0!==e||u||(g.axis_x_categories=[]),-1===(i=g.axis_x_categories.indexOf(n))&&(i=g.axis_x_categories.length,g.axis_x_categories.push(n))),{x:i=M(t)||h.data.xs[a].length<=e?void 0:i,value:t,id:s}}).filter(function(t){return X(t.x)})}});return e.forEach(function(t){g.data_xSort&&(t.values=t.values.sort(function(t,e){return(t.x||0===t.x?t.x:1/0)-(e.x||0===e.x?e.x:1/0)})),t.values.forEach(function(t,e){return t.index=e}),h.data.xs[t.id].sort(function(t,e){return t-e})}),f.hasNegativeValue=h.hasNegativeValueInTargets(e),f.hasPositiveValue=h.hasPositiveValueInTargets(e),g.data_type&&h.setTargetType(h.mapToIds(e).filter(function(t){return!(t in g.data_types)}),g.data_type),e.forEach(function(t){return h.cache.add(t.id_org,t,!0)}),e}},kt={isX:function(t){var e,i,n,a=this.config,r=a.data_x&&t===a.data_x,t=$(a.data_xs)&&(e=a.data_xs,i=t,n=!1,Object.keys(e).forEach(function(t){return e[t]===i&&(n=!0)}),n);return r||t},isNotX:function(t){return!this.isX(t)},isStackNormalized:function(){var t=this.config;return!(!t.data_stack_normalize||!t.data_groups.length)},isGrouped:function(e){var t=this.config.data_groups;return e?t.some(function(t){return 0<=t.indexOf(e)&&1<t.length}):0<t.length},getXKey:function(t){var e=this.config;return e.data_x||($(e.data_xs)?e.data_xs[t]:null)},getXValuesOfXKey:function(e,t){var i,n=this;return(t&&$(t)?n.mapToIds(t):[]).forEach(function(t){n.getXKey(t)===e&&(i=n.data.xs[t])}),i},getIndexByX:function(t,e){return e?e.indexOf(w(t)?t:+t):(this.filterByX(this.data.targets,t)[0]||{index:null}).index},getXValue:function(t,e){return t in this.data.xs&&this.data.xs[t]&&z(this.data.xs[t][e])?this.data.xs[t][e]:e},getOtherTargetXs:function(){var t=Object.keys(this.data.xs);return t.length?this.data.xs[t[0]]:null},getOtherTargetX:function(t){var e=this.getOtherTargetXs();return e&&t<e.length?e[t]:null},addXs:function(e){var i=this.config;Object.keys(e).forEach(function(t){i.data_xs[t]=e[t]})},isMultipleX:function(){return $(this.config.data_xs)||!this.config.data_xSort||this.hasType("bubble")||this.hasType("scatter")},addName:function(t){var e=this.config;return t&&(e=e.data_names[t.id],t.name=void 0===e?t.id:e),t},getAllValuesOnIndex:function(e,t){void 0===t&&(t=!1);var i=this,n=i.filterTargetsToShow(i.data.targets).map(function(t){return i.addName(i.getValueOnIndex(t.values,e))});return n=t?n.filter(function(t){return z(t.value)}):n},getValueOnIndex:function(t,e){t=t.filter(function(t){return t.index===e});return t.length?t[0]:null},updateTargetX:function(t,n){var a=this;t.forEach(function(i){i.values.forEach(function(t,e){t.x=a.generateTargetX(n[e],i.id,e)}),a.data.xs[i.id]=n})},updateTargetXs:function(t,e){var i=this;t.forEach(function(t){e[t.id]&&i.updateTargetX([t],e[t.id])})},generateTargetX:function(t,e,i){var n=this.axis,a=(!n||!n.isCategorized())&&t||i;return n&&n.isTimeSeries()?a=rt.bind(this)(t||this.getXValue(e,i)):n&&n.isCustomX()&&!n.isCategorized()&&(a=z(t)?+t:this.getXValue(e,i)),a},updateXs:function(t){t.length&&(this.axis.xs=t.map(function(t){return t.x}))},getPrevX:function(t){t=this.axis.xs[t-1];return X(t)?t:null},getNextX:function(t){t=this.axis.xs[t+1];return X(t)?t:null},getBaseValue:function(t){var e=this,i=e.state.hasAxis,n=t.value;return n&&i&&(e.isAreaRangeType(t)?n=e.getRangedData(t,"mid"):e.isBubbleZType(t)&&(n=e.getBubbleZData(n,"y"))),n},getMinMaxValue:function(t){var i,n,a=this.getBaseValue.bind(this);return(t||this.data.targets.map(function(t){return t.values})).forEach(function(t,e){t=t.map(a).filter(F);i=Math.min.apply(Math,[e?i:1/0].concat(t)),n=Math.max.apply(Math,[e?n:-1/0].concat(t))}),{min:i,max:n}},getMinMaxData:function(){var t,i,n,a,r=this,e=ht,s=r.cache.get(e);return s||(t=r.data.targets.map(function(t){return t.values}),i=r.getMinMaxValue(t),n=[],a=[],t.forEach(function(t){var e=r.getFilteredDataByValue(t,i.min),t=r.getFilteredDataByValue(t,i.max);e.length&&(n=n.concat(e)),t.length&&(a=a.concat(t))}),r.cache.add(e,s={min:n,max:a})),s},getTotalPerIndex:function(){var i=this.cache.get(t);return this.isStackNormalized()&&!i&&(i=[],this.data.targets.forEach(function(t){t.values.forEach(function(t,e){i[e]||(i[e]=0),i[e]+=F(t.value)?t.value:0})})),i},getTotalDataSum:function(t){var e,i=gt,n=this.cache.get(i);return F(n)||(e=J(this.data.targets.map(function(t){return t.values})).map(function(t){return t.value}).reduce(function(t,e){return t+e}),this.cache.add(i,n=e)),t&&(n-=this.getHiddenTotalDataSum()),n},getHiddenTotalDataSum:function(){var t=this.api,e=this.state.hiddenTargetIds,i=0;return i=e.length?t.data.values.bind(t)(e).reduce(function(t,e){return t+e}):i},getFilteredDataByValue:function(t,e){var i=this;return t.filter(function(t){return i.getBaseValue(t)===e})},getMaxDataCount:function(){return Math.max.apply(Math,this.data.targets.map(function(t){return t.values.length}))},getMaxDataCountTarget:function(){var t=this.filterTargetsToShow()||[],e=t.length;return 1<e?t=tt(K(t=t.map(function(t){return t.values}).reduce(function(t,e){return t.concat(e)}).map(function(t){return t.x}))).map(function(t,e){return{x:t,index:e}}):e&&(t=t[0].values),t},mapToIds:function(t){return t.map(function(t){return t.id})},mapToTargetIds:function(t){return t?B(t)?t.concat():[t]:this.mapToIds(this.data.targets)},hasTarget:function(t,e){for(var i,n=this.mapToIds(t),a=0;i=n[a];a++)if(i===e)return!0;return!1},isTargetToShow:function(t){return this.state.hiddenTargetIds.indexOf(t)<0},isLegendToShow:function(t){return this.state.hiddenLegendIds.indexOf(t)<0},filterTargetsToShow:function(t){var e=this;return(t||e.data.targets).filter(function(t){return e.isTargetToShow(t.id)})},mapTargetsToUniqueXs:function(t){var e=this.axis,i=[];return t&&t.length&&(i=K(J(t.map(function(t){return t.values.map(function(t){return+t.x})}))),i=e&&e.isTimeSeries()?i.map(function(t){return new Date(+t)}):i.map(function(t){return+t})),tt(i)},addTargetIds:function(e,t){var i=this.state;(B(t)?t:[t]).forEach(function(t){i[e].indexOf(t)<0&&i[e].push(t)})},removeTargetIds:function(e,t){var i=this.state;(B(t)?t:[t]).forEach(function(t){t=i[e].indexOf(t);0<=t&&i[e].splice(t,1)})},addHiddenTargetIds:function(t){this.addTargetIds("hiddenTargetIds",t)},removeHiddenTargetIds:function(t){this.removeTargetIds("hiddenTargetIds",t)},addHiddenLegendIds:function(t){this.addTargetIds("hiddenLegendIds",t)},removeHiddenLegendIds:function(t){this.removeTargetIds("hiddenLegendIds",t)},getValuesAsIdKeyed:function(t){var n=this,a=n.state.hasAxis,e={},r=n.isMultipleX(),s=r?n.mapTargetsToUniqueXs(t).map(function(t){return w(t)?t:+t}):null;return t.forEach(function(t){var i=[];t.values.filter(function(t){t=t.value;return z(t)||null===t}).forEach(function(t){var e=t.value;null!==e&&n.isCandlestickType(t)&&(e=B(e)?e.slice(0,4):[e.open,e.high,e.low,e.close]),B(e)?i.push.apply(i,e):N(e)&&"high"in e?i.push.apply(i,Object.values(e)):n.isBubbleZType(t)?i.push(a&&n.getBubbleZData(e,"y")):r?i[n.getIndexByX(t.x,s)]=e:i.push(e)}),e[t.id]=i}),e},checkValueInTargets:function(t,e){for(var i=Object.keys(t),n=0;n<i.length;n++)for(var a=t[i[n]].values,r=0;r<a.length;r++)if(e(a[r].value))return!0;return!1},hasMultiTargets:function(){return 1<this.filterTargetsToShow().length},hasNegativeValueInTargets:function(t){return this.checkValueInTargets(t,function(t){return t<0})},hasPositiveValueInTargets:function(t){return this.checkValueInTargets(t,function(t){return 0<t})},orderTargets:function(t){var e=[].concat(t),t=this.getSortCompareFn();return t&&e.sort(t),e},getSortCompareFn:function(i){void 0===i&&(i=!1);var n,t,e=this.config.data_order,a=/asc/i.test(e),r=/desc/i.test(e);return a||r?(n=function(t,e){return t+Math.abs(e.value)},t=function(t,e){t=t.values.reduce(n,0),e=e.values.reduce(n,0);return i?a?t-e:e-t:a?e-t:t-e}):O(e)&&(t=e.bind(this.api)),t||null},filterByX:function(t,e){return J(t.map(function(t){return t.values})).filter(function(t){return t.x-e==0})},filterRemoveNull:function(t){var e=this;return t.filter(function(t){return z(e.getBaseValue(t))})},filterByXDomain:function(t,e){return t.map(function(t){return{id:t.id,id_org:t.id_org,values:t.values.filter(function(t){return e[0]<=t.x&&t.x<=e[1]})}})},hasDataLabel:function(){var t=this.config.data_labels;return _(t)&&t||b(t)&&$(t)},getDataIndexFromEvent:function(t){var e=this.config,i=this.state,n=i.inputType,a=i.eventReceiver,i=a.coords,a=a.rect,e=e.axis_rotated,t="touch"===n&&t.changedTouches?t.changedTouches[0]:t;return function t(e,i,n,a,r){if(a<n)return-1;var s=Math.floor((n+a)/2),o=e[s],c=o.x,o=o.w,o=void 0===o?0:o;return r&&(c=e[s].y,o=e[s].h),c<=i&&i<=c+o?s:i<c?t(e,i,n,s-1,r):t(e,i,s+1,a,r)}(i,e?t.clientY-a.top:t.clientX-a.left,0,i.length-1,e)},getDataLabelLength:function(t,e,i){var n=this,a=[0,0];return n.$el.chart.select("svg").selectAll(".dummy").data([t,e]).enter().append("text").text(function(t){return n.dataLabelFormat(t.id)(t)}).each(function(t,e){a[e]=1.3*this.getBoundingClientRect()[i]}).remove(),a},isNoneArc:function(t){return this.hasTarget(this.data.targets,t.id)},isArc:function(t){return"data"in t&&this.hasTarget(this.data.targets,t.data.id)},findSameXOfValues:function(t,e){for(var i=t[e].x,n=[],a=e-1;0<=a&&i===t[a].x;a--)n.push(t[a]);for(a=e;a<t.length&&i===t[a].x;a++)n.push(t[a]);return n},findClosestFromTargets:function(t,e){var i=this,t=t.map(function(t){return i.findClosest(t.values,e)});return i.findClosest(t,e)},findClosest:function(t,i){var n,a=this,e=a.config,r=a.$el.main,t=t.filter(function(t){return t&&z(t.value)}),s=e.point_sensitivity;return t.filter(function(t){return a.isBarType(t.id)}).forEach(function(t){var e=r.select("."+I.bars+a.getTargetSelectorSuffix(t.id)+" ."+I.bar+"-"+t.index).node();!n&&a.isWithinBar(e)&&(n=t)}),t.filter(function(t){return!a.isBarType(t.id)}).forEach(function(t){var e=a.dist(t,i);e<s&&(s=e,n=t)}),n},dist:function(t,e){var i=this.config.axis_rotated,n=this.scale,a=i?1:0,r=i?0:1,i=this.circleY(t,t.index),t=(n.zoom||n.x)(t.x);return Math.sqrt(Math.pow(t-e[a],2)+Math.pow(i-e[r],2))},convertValuesToStep:function(t){var e=this.axis,i=this.config.line_step_type,n=!!e&&e.isCategorized(),a=B(t)?t.concat():[t];if(!n&&!/step\-(after|before)/.test(i))return t;var r=a[0],s=a[a.length-1],e=r.id,t=r.x;return a.unshift({x:--t,value:r.value,id:e}),n&&"step-after"===i&&a.unshift({x:--t,value:r.value,id:e}),t=s.x,a.push({x:++t,value:s.value,id:e}),n&&"step-before"===i&&a.push({x:++t,value:s.value,id:e}),a},convertValuesToRange:function(t){var t=B(t)?t.concat():[t],n=[];return t.forEach(function(t){var e=t.x,i=t.id;n.push({x:e,id:i,value:t.value[0]}),n.push({x:e,id:i,value:t.value[2]})}),n},updateDataAttributes:function(t,e){var i=this.config["data_"+t];return M(e)||(Object.keys(e).forEach(function(t){i[t]=e[t]}),this.redraw({withLegend:!0})),i},getRangedData:function(t,e,i){void 0===e&&(e=""),void 0===i&&(i="areaRange");t=null==t?void 0:t.value;if(B(t)){i={areaRange:["high","mid","low"],candlestick:["open","high","low","close","volume"]}[i].indexOf(e);return 0<=i&&t?t[i]:void 0}return t&&t[e]},getRatio:function(t,e,i){var n,a,r=this,s=r.config,o=r.state,c=r.api,l=0;return e&&c.data.shown().length&&(l=e.ratio||e.value,"arc"===t?l=r.pie.padAngle()()?e.value/r.getTotalDataSum(!0):(n=s.gauge_fullCircle?r.getArcLength():-2*r.getStartAngle(),n=r.hasType("gauge")?n:2*Math.PI,(e.endAngle-e.startAngle)/n):"index"===t?(n=c.data.values.bind(c),c=this.getTotalPerIndex(),!o.hiddenTargetIds.length||(a=n(o.hiddenTargetIds,!1)).length&&(a=a.reduce(function(t,i){return t.map(function(t,e){return(F(t)?t:0)+i[e]})}),c=c.map(function(t,e){return t-a[e]})),e.ratio=F(e.value)&&c&&0<c[e.index]?e.value/c[e.index]:0,l=e.ratio):"radar"===t?l=parseFloat(Math.max(e.value,0)+"")/o.current.dataMax*s.radar_size_ratio:"bar"===t&&(r=r.getYScaleById.bind(r)(e.id).domain().reduce(function(t,e){return e-t}),l=Math.abs(e.value)/r)),i&&l?100*l:l},updateDataIndexByX:function(t){var n=t.reduce(function(t,e,i){return t[+e.x]=i,t},{});this.data.targets.forEach(function(t){t.values.forEach(function(t,e){var i=n[+t.x];t.index=i=void 0===i?e:i})})},isBubbleZType:function(t){return this.isBubbleType(t)&&(N(t.value)&&("z"in t.value||"y"in t.value)||B(t.value)&&2===t.value.length)},getDataById:function(t){t=this.cache.get(t)||this.api.data(t);return B(t)?t[0]:t}},St={load:function(t,i){var n=this,a=i.append,r=t;r&&(i.filter&&(r=r.filter(i.filter)),(i.type||i.types)&&r.forEach(function(t){var e=i.types&&i.types[t.id]||i.type;n.setTargetType(t.id,e)}),n.data.targets.forEach(function(t){for(var e=0;e<r.length;e++)if(t.id===r[e].id){t.values=a?t.values.concat(r[e].values):r[e].values,r.splice(e,1);break}}),n.data.targets=n.data.targets.concat(r)),n.updateTargets(n.data.targets),n.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),n.updateTypesElements(),i.done&&i.done.call(n.api)},loadFromArgs:function(e){var t,i=this;i.config&&(i.cache.reset(),t=e.data||i.convertData(e,function(t){return i.load(i.convertDataToTargets(t),e)}),e.append&&(t.__append__=!0),t&&i.load(i.convertDataToTargets(t),e))},unload:function(t,e){var i=this,n=i.config,a=i.state,r=i.$el,s=e,e=t;i.cache.reset(),s=s||function(){},(e=e.filter(function(t){return i.hasTarget(i.data.targets,t)}))&&0!==e.length?(t=r.svg.selectAll(e.map(function(t){return i.selectorTarget(t)})),(n.transition_duration?t.transition().style("opacity","0"):t).remove().call(C,s),e.forEach(function(e){a.withoutFadeIn[e]=!1,r.legend&&r.legend.selectAll("."+I.legendItem+i.getTargetSelectorSuffix(e)).remove(),i.data.targets=i.data.targets.filter(function(t){return t.id!==e})}),i.updateTypesElements()):s()}},Ct=Ri(7),Et={selectRectForSingle:function(i,n,a){var r=this,t=r.config,e=r.$el.main,s=t.data_selection_enabled,o=t.data_selection_grouped,c=t.data_selection_isselectable,l=t.tooltip_grouped,t=r.getAllValuesOnIndex(a);l&&(r.showTooltip(t,i),r.showGridFocus&&r.showGridFocus(t),!s||o)||e.selectAll("."+I.shape+"-"+a).each(function(){(0,D.select)(this).classed(I.EXPANDED,!0),s&&n.style("cursor",o?"pointer":null),l||(r.hideGridFocus&&r.hideGridFocus(),r.hideTooltip(),o||r.setExpand(a))}).filter(function(t){return r.isWithinShape(this,t)}).call(function(t){var e=t.data();s&&(o||c&&c.bind(r.api)(e))&&n.style("cursor","pointer"),l||(r.showTooltip(e,i),r.showGridFocus&&r.showGridFocus(e),r.unexpandCircles&&r.unexpandCircles(),t.each(function(t){return r.setExpand(a,t.id)}))})},setExpand:function(t,e,i){var n=this.config;this.$el.circle&&n.point_focus_expand_enabled&&this.expandCircles(t,e,i),this.expandBarTypeShapes(!0,t,e,i)},expandBarTypeShapes:function(e,i,n,a){void 0===e&&(e=!0);var r=this;["bar","candlestick"].filter(function(t){return r.$el[t]}).forEach(function(t){a&&r.$el[t].classed(I.EXPANDED,!1),r.getShapeByIndex(t,i,n).classed(I.EXPANDED,e)})},setOverOut:function(t,e){var i,n,a=this,r=a.config,s=a.state.hasRadar,o=a.$el.main,c=N(e);!c&&-1===e||(i=r[t?"data_onover":"data_onout"].bind(a.api),r.color_onover&&a.setOverColor(t,e,c),c?i(e,o.select("."+I.arc+a.getTargetSelectorSuffix(e.id)).node()):r.tooltip_grouped?(t&&(r.point_focus_only&&s?a.showCircleFocus(a.getAllValuesOnIndex(e,!0)):a.setExpand(e,null,!0)),a.isMultipleX()||o.selectAll("."+I.shape+"-"+e).each(function(t){i(t,this)})):(n=a.cache.get(xt)||[],(e=o.selectAll("."+I.shape+"-"+e).filter(function(t){return a.isWithinShape(this,t)})).each(function(t){var e=this;0!==n.length&&!n.every(function(t){return t!==e})||(i(t,this),n.push(this))}),0<n.length&&e.empty()&&(i=r.data_onout.bind(a.api),n.forEach(function(t){return i((0,D.select)(t).datum(),t)}),n=[]),a.cache.add(xt,n)))},callOverOutForTouch:function(t){var e=this.cache.get(vt);(N(t)&&e?t.id!==e.id:t!==e)&&((e||F(e))&&this.setOverOut(!1,e),(t||F(t))&&this.setOverOut(!0,t),this.cache.add(vt,t))},getDraggableSelection:function(){var e=this,t=e.config,i=e.state;return t.interaction_enabled&&t.data_selection_draggable&&e.drag?(0,Ct.drag)().on("drag",function(t){i.event=t,e.drag(L(t,this))}).on("start",function(t){i.event=t,e.dragstart(L(t,this))}).on("end",function(t){i.event=t,e.dragend()}):function(){}},dispatchEvent:function(t,i,e){var n=this.config,a=this.state,r=a.eventReceiver,s=a.hasAxis,o=a.hasRadar,c=this.$el,l=c.eventRect,u=c.arcs,d=c.radar,a=this.isMultipleX(),c=(o?d.axes.select("."+I.axis+"-"+i+" text"):l||u.selectAll("."+I.target+" path").filter(function(t,e){return e===i})).node(),d=c.getBoundingClientRect(),l=d.width,u=d.left,d=d.top;!s||o||a||(l=(r=r.coords[i]).w,u+=r.x,d+=r.y);l=u+(e?e[0]:0)+(a||n.axis_rotated?0:l/2),e=d+(e?e[1]:0);nt[/^(mouse|click)/.test(t)?"mouse":"touch"](c,t,{screenX:l,screenY:e,clientX:l,clientY:e})},setDragStatus:function(t){this.state.dragging=t},unbindZoomEvent:function(){var t=this.$el,e=t.eventRect,t=t.zoomResetBtn;e.on(".zoom",null).on(".drag",null),null!=t&&t.style("display","none")}},Rt={generateClass:function(t,e){return" "+t+" "+(t+this.getTargetSelectorSuffix(e))},getClass:function(e,i){var n=this,a=/s$/.test(e),r=/^(area|arc|line)s?$/.test(e),s=a?"id":"index";return function(t){t=t.data||t;return((i?n.generateClass(I[a?"shapes":"shape"],t[s]):"")+n.generateClass(I[e],t[r?"id":s])).trim()}},getChartClass:function(e){var i=this;return function(t){return I["chart"+e]+i.classTarget((t.data||t).id)}},generateExtraLineClass:function(){var e=this.config.line_classes||[],i=[];return function(t){t=t.id||t.data&&t.data.id||t;return i.indexOf(t)<0&&i.push(t),e[i.indexOf(t)%e.length]}},classRegion:function(t,e){return this.generateClass(I.region,e)+" "+("class"in t?t.class:"")},classTarget:function(t){var e=this.config.data_classes[t],i="";return e&&(i=" "+I.target+"-"+e),this.generateClass(I.target,t)+i},classFocus:function(t){return this.classFocused(t)+this.classDefocused(t)},classFocused:function(t){return" "+(0<=this.state.focusedTargetIds.indexOf(t.id)?I.focused:"")},classDefocused:function(t){return" "+(0<=this.state.defocusedTargetIds.indexOf(t.id)?I.defocused:"")},getTargetSelectorSuffix:function(t){return(t||0===t?"-"+t:"").replace(/([\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\])/g,"-")},selectorTarget:function(t,e){e=e||"",t=this.getTargetSelectorSuffix(t);return e+"."+(I.target+t)+", "+e+"."+(I.circles+t)},selectorTargets:function(t,e){var i=this,t=t||[];return t.length?t.map(function(t){return i.selectorTarget(t,e)}):null},selectorLegend:function(t){return"."+(I.legendItem+this.getTargetSelectorSuffix(t))},selectorLegends:function(t){var e=this;return t&&t.length?t.map(function(t){return e.selectorLegend(t)}):null}},Lt=Ri(6),Ot=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Dt={getColorFromCss:function(){var t,e,i=dt,n=P.body,a=n[i];return a||((t=P.createElement("span")).className=I.colorPattern,t.style.display="none",n.appendChild(t),e=p.getComputedStyle(t).backgroundImage,t.parentNode.removeChild(t),-1<e.indexOf(";")&&(a=e.replace(/url[^#]*|["'()]|(\s|%20)/g,"").split(";").map(function(t){return t.trim().replace(/[\"'\s]/g,"")}).filter(Boolean),n[i]=a)),a},generateColor:function(){var n,t,a=this,r=a.config,s=r.data_colors,o=r.data_color,c=[],l=$(r.color_pattern)?r.color_pattern:(0,Lt.scaleOrdinal)(a.getColorFromCss()||Ot).range(),u=l;return O(r.color_tiles)&&(n=r.color_tiles.bind(a.api)(),l=(t=l.map(function(t,e){var i=t.replace(/[#\(\)\s,]/g,""),i=a.state.datetimeId+"-pattern-"+i+"-"+e;return function(t,e,i){t=(0,D.select)(t.cloneNode(!0));return t.attr("id",i).insert("rect",":first-child").attr("width",t.attr("width")).attr("height",t.attr("height")).style("fill",e),{id:i,node:t.node()}}(n[e%n.length],t,i)})).map(function(t){return"url(#"+t.id+")"}),a.patterns=t),function(t){var e,i=t.id||t.data&&t.data.id||t,n=a.isTypeOf(i,["line","spline","step"])||!r.data_types[i];return O(s[i])?e=s[i].bind(a.api)(t):s[i]?e=s[i]:(c.indexOf(i)<0&&c.push(i),e=n?u[c.indexOf(i)%u.length]:l[c.indexOf(i)%l.length],s[i]=e),O(o)?o.bind(a.api)(e,t):e}},generateLevelColor:function(){var t=this.config,r=t.color_pattern,t=t.color_threshold,s="value"===t.unit,o=t.max||100,c=t.values&&t.values.length?t.values:[];return $(t)?function(t){for(var e=s?t:100*t/o,i=r[r.length-1],n=0,a=c.length;n<a;n++)if(e<=c[n]){i=r[n];break}return i}:null},generateDataLabelBackgroundColorFilter:function(){var i=this,n=i.$el,t=i.config,a=i.state,r=t.data_labels_backgroundColors;r&&(t=[],w(r)?t.push(""):N(r)&&(t=Object.keys(r)),t.forEach(function(t){var e=a.datetimeId+"-labels-bg"+i.getTargetSelectorSuffix(t);n.defs.append("filter").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("id",e).html('<feFlood flood-color="'+(""===t?r:r[t])+'" /><feComposite in="SourceGraphic"/>')}))},setOverColor:function(t,e){var i=this,n=i.config,a=i.$el.main,r=n.color_onover,t=t?r:i.color;N(t)?t=function(t){t=t.id;return t in r?r[t]:i.color(t)}:w(t)?t=function(){return r}:O(r)&&(t=t.bind(i.api)),a.selectAll(N(e)?"."+I.arc+i.getTargetSelectorSuffix(e.id):"."+I.shape+"-"+e).style("fill",t)}},It={AREA:"area",AREA_LINE_RANGE:"area-line-range",AREA_SPLINE:"area-spline",AREA_SPLINE_RANGE:"area-spline-range",AREA_STEP:"area-step",BAR:"bar",BUBBLE:"bubble",CANDLESTICK:"candlestick",DONUT:"donut",GAUGE:"gauge",LINE:"line",PIE:"pie",RADAR:"radar",SCATTER:"scatter",SPLINE:"spline",STEP:"step"},Pt={Area:[It.AREA,It.AREA_SPLINE,It.AREA_SPLINE_RANGE,It.AREA_LINE_RANGE,It.AREA_STEP],AreaRange:[It.AREA_SPLINE_RANGE,It.AREA_LINE_RANGE],Arc:[It.PIE,It.DONUT,It.GAUGE,It.RADAR],Line:[It.LINE,It.SPLINE,It.AREA,It.AREA_SPLINE,It.AREA_SPLINE_RANGE,It.AREA_LINE_RANGE,It.STEP,It.AREA_STEP],Step:[It.STEP,It.AREA_STEP],Spline:[It.SPLINE,It.AREA_SPLINE,It.AREA_SPLINE_RANGE]},zt={getYDomainMinMax:function(e,i){var n=this,o=n.axis,t=n.config,c="min"===i,a=t.data_groups,l=n.mapToIds(e),u=n.getValuesAsIdKeyed(e);return 0<a.length&&function(){for(var r,s=n["has"+(c?"Negative":"Positive")+"ValueInTargets"](e),t=0;r=a[t];t++)(function(t){if(0===(t=t.filter(function(t){return 0<=l.indexOf(t)})).length)return r=t;var n=t[0],a=o.getId(n);s&&u[n]&&(u[n]=u[n].map(function(t){return(c?t<0:0<t)?t:0}));for(var e,i=1;e=t[i];i++)(function(t){if(!u[t])return;var i=o.getId(t);u[t].forEach(function(t,e){t=+t;i!==a||s&&(c?0<t:t<0)||(u[n][e]+=t)})})(e);r=t})(r)}(),et(i,Object.keys(u).map(function(t){return et(i,u[t])}))},getYDomainMin:function(t){return this.getYDomainMinMax(t,"min")},getYDomainMax:function(t){return this.getYDomainMinMax(t,"max")},isHiddenTargetWithYDomain:function(e){var i=this;return i.state.hiddenTargetIds.some(function(t){return i.axis.getId(t)===e})},getYDomain:function(t,e,i){var n=this,a=n.axis,r=n.config,s=n.scale,o="axis_"+e;if(n.isStackNormalized())return[0,100];var c=s&&s[e]&&"log"===s[e].type,l=t.filter(function(t){return a.getId(t.id)===e}),u=i?n.filterByXDomain(l,i):l;if(0===u.length)return n.isHiddenTargetWithYDomain(e)?s[e].domain():"y2"===e?s.y.domain():n.getYDomain(t,"y2",i);var d=r[o+"_min"],h=r[o+"_max"],g=n.getYDomainMin(u),f=n.getYDomainMax(u),p=r[o+"_center"],x=[It.BAR,It.BUBBLE,It.SCATTER].concat(Pt.Line).some(function(t){var e=-1<t.indexOf("area")?"area":t;return n.hasType(t,u)&&r[e+"_zerobased"]}),v=r[o+"_inverted"],_=n.hasDataLabel()&&r.axis_rotated,l=n.hasDataLabel()&&!r.axis_rotated;g=z(d)?d:!z(h)||g<h?g:h-10,f=z(h)?h:!z(d)||d<f?f:d+10,(g=isNaN(g)?0:g)===(f=isNaN(f)?g:f)&&(g<0?f=0:g=0);t=0<=g&&0<=f,i=g<=0&&f<=0;(x=z(d)&&t||z(h)&&i?!1:x)&&(t&&(g=0),i&&(f=0));var m,y,b,T=Math.abs(f-g),w={top:.1*T,bottom:.1*T};X(p)&&(f=p+(h=Math.max(Math.abs(g),Math.abs(f))),g=p-h),_?(m=k(s.y.range()),y=n.getDataLabelLength(g,f,"width").map(function(t){return t/m}),["bottom","top"].forEach(function(t,e){w[t]+=T*(y[e]/(1-y[0]-y[1]))})):l&&(b=n.getDataLabelLength(g,f,"height"),["bottom","top"].forEach(function(t,e){w[t]+=a.convertPixelsToAxisPadding(b[e],T)}));var A=r[o+"_padding"];$(A)&&["bottom","top"].forEach(function(t){w[t]=a.getPadding(A,t,w[t],T)}),x&&(t&&(w.bottom=g),i&&(w.top=-f));f=c?[g,f].map(function(t){return t<0?0:t}):[g-w.bottom,f+w.top];return v?f.reverse():f},getXDomainMinMax:function(t,e){var i=this.config["axis_x_"+e],n=et(e,t.map(function(t){return et(e,t.values.map(function(t){return t.x}))})),t=N(i)?i.value:i,t=X(t)&&this.axis.isTimeSeries()?rt.bind(this)(t):t;return N(i)&&i.fit&&("min"===e&&t<n||"max"===e&&n<t)&&(t=void 0),X(t)?t:n},getXDomainMin:function(t){return this.getXDomainMinMax(t,"min")},getXDomainMax:function(t){return this.getXDomainMinMax(t,"max")},getXDomainPadding:function(t){var e=this.axis,i=this.config,n=t[1]-t[0],t=i.axis_x_padding,e=e.isCategorized()?0:this.hasType("bar")?1<(a=this.getMaxDataCount())?n/(a-1)/2:.5:.01*n,a=e,n=e;return N(t)&&$(t)?(a=z(t.left)?t.left:e,n=z(t.right)?t.right:e):F(i.axis_x_padding)&&(n=a=t),{left:a,right:n}},getXDomain:function(t){var e,i=this,n="log"===i.scale.x.type,a=[i.getXDomainMin(t),i.getXDomainMax(t)],r=0,s=0;return n?(r=a[0],s=a[1]):(e=i.axis.isCategorized(),t=i.axis.isTimeSeries(),n=i.getXDomainPadding(a),(i=a[0])-(a=a[1])!=0||e||(a=t?(i=new Date(.5*i.getTime()),new Date(1.5*a.getTime())):(i=0===i?1:.5*i,0===a?-1:1.5*a)),!i&&0!==i||(r=t?new Date(i.getTime()-n.left):i-n.left),!a&&0!==a||(s=t?new Date(a.getTime()+n.right):a+n.right)),[r,s]},updateXDomain:function(t,e,i,n,a){var r=this,s=r.config,o=r.org,c=r.scale,l=c.x,c=c.subX,s=s.zoom_enabled;return i&&(l.domain(a||tt(r.getXDomain(t))),o.xDomain=l.domain(),s&&r.zoom.updateScaleExtent(),c.domain(l.domain()),r.brush&&r.brush.scale(c)),e&&(c=a||!r.brush||H(r)?o.xDomain:G(r).map(c.invert),l.domain(c),s&&r.zoom.updateScaleExtent()),n&&l.domain(r.trimXDomain(l.orgDomain())),l.domain()},trimXDomain:function(t){var e=this.getZoomDomain(),i=e[0],e=e[1];return t[0]<=i&&(t[1]=+t[1]+(i-t[0]),t[0]=i),e<=t[1]&&(t[0]=+t[0]-(t[1]-e),t[1]=e),t},getZoomDomain:function(){var t=this.config,e=this.org.xDomain,i=e[0],e=e[1];return[i=X(t.zoom_x_min)?et("min",[i,t.zoom_x_min]):i,e=X(t.zoom_x_max)?et("max",[e,t.zoom_x_max]):e]}};function Mt(t,e,i){var n=t.config,e="axis_"+e+"_tick_format";return(n[e]||t.defaultValueFormat)(i)}var Xt={yFormat:function(t){return Mt(this,"y",t)},y2Format:function(t){return Mt(this,"y2",t)},getDefaultValueFormat:function(){return this.hasArcType()&&!this.hasType("gauge")?this.defaultArcValueFormat:this.defaultValueFormat},defaultValueFormat:function(t){return z(t)?+t:""},defaultArcValueFormat:function(t,e){return(100*e).toFixed(1)+"%"},dataLabelFormat:function(t){function e(t){return z(t)?+t:""}var i=this.config.data_labels,n=e;return O(i.format)?n=i.format:b(i.format)&&(n=i.format[t]?!0===i.format[t]?e:i.format[t]:function(){return""}),n.bind(this.api)}},Ft={initLegend:function(){var t=this,e=t.config,i=t.$el;t.legendItemTextBox={},t.state.legendHasRendered=!1,e.legend_show?(e.legend_contents_bindto||(i.legend=t.$el.svg.append("g").classed(I.legend,!0).attr("transform",t.getTranslate("legend"))),t.updateLegend()):t.state.hiddenLegendIds=t.mapToIds(t.data.targets)},updateLegend:function(t,e,i){var n=this,a=n.config,r=n.state,s=n.scale,o=n.$el,e=e||{withTransform:!1,withTransitionForTransform:!1,withTransition:!1};e.withTransition=A(e,"withTransition",!0),e.withTransitionForTransform=A(e,"withTransitionForTransform",!0),a.legend_contents_bindto&&a.legend_contents_template?n.updateLegendTemplate():n.updateLegendElement(t||n.mapToIds(n.data.targets),e,i),o.legend.selectAll("."+I.legendItem).classed(I.legendItemHidden,function(t){t=!n.isTargetToShow(t);return t&&(this.style.opacity=null),t}),n.updateScales(!1,!s.zoom),n.updateSvgSize(),n.transformAll(e.withTransitionForTransform,i),r.legendHasRendered=!0},updateLegendTemplate:function(){var i,n,a=this,t=a.config,e=a.$el,r=(0,D.select)(t.legend_contents_bindto),s=t.legend_contents_template;r.empty()||(t=a.mapToIds(a.data.targets),i=[],n="",t.forEach(function(t){var e=O(s)?s.bind(a.api)(t,a.color(t),a.api.data(t)[0].values):at(s,{COLOR:a.color(t),TITLE:t});e&&(i.push(t),n+=e)}),t=r.html(n).selectAll(function(){return this.childNodes}).data(i),a.setLegendItem(t),e.legend=r)},updateSizeForLegend:function(t){var e=this,i=e.config,n=e.state,a=n.isLegendTop,r=n.isLegendLeft,s=n.isLegendRight,o=n.isLegendInset,c=n.current,n=t.width,t=t.height,i={top:a?e.getCurrentPaddingTop()+i.legend_inset_y+5.5:c.height-t-e.getCurrentPaddingBottom()-i.legend_inset_y,left:r?e.getCurrentPaddingLeft()+i.legend_inset_x+.5:c.width-n-e.getCurrentPaddingRight()-i.legend_inset_x+.5};e.state.margin3={top:s?0:o?i.top:c.height-t,right:NaN,bottom:0,left:s?c.width-n:o?i.left:0}},transformLegend:function(t){var e=this.$el.legend;(t?e.transition():e).attr("transform",this.getTranslate("legend"))},updateLegendStep:function(t){this.state.legendStep=t},updateLegendItemWidth:function(t){this.state.legendItemWidth=t},updateLegendItemHeight:function(t){this.state.legendItemHeight=t},updateLegendItemColor:function(t,e){var i=this.$el.legend;i&&i.select("."+I.legendItem+"-"+t+" line").style("stroke",e)},getLegendWidth:function(){var t=this.state,e=t.current.width,i=t.isLegendRight,n=t.isLegendInset,a=t.legendItemWidth,t=t.legendStep;return this.config.legend_show?i||n?a*(t+1):e:0},getLegendHeight:function(){var t=this.state,e=t.current,i=t.isLegendRight,n=t.legendItemHeight,t=t.legendStep;return this.config.legend_show?i?e.height:Math.max(20,n)*(t+1):0},opacityForUnfocusedLegend:function(t){return t.classed(I.legendItemHidden)?null:"0.3"},toggleFocusLegend:function(t,e){var i=this,n=i.$el.legend,a=i.mapToTargetIds(t);n&&n.selectAll("."+I.legendItem).filter(function(t){return 0<=a.indexOf(t)}).classed(I.legendItemFocused,e).transition().duration(100).style("opacity",function(){return e?null:i.opacityForUnfocusedLegend.call(i,(0,D.select)(this))})},revertLegend:function(){var t=this.$el.legend;t&&t.selectAll("."+I.legendItem).classed(I.legendItemFocused,!1).transition().duration(100).style("opacity",null)},showLegend:function(t){var e=this,i=e.config,n=e.$el;i.legend_show||(i.legend_show=!0,n.legend?n.legend.style("visibility",null):e.initLegend(),e.state.legendHasRendered||e.updateLegend()),e.removeHiddenLegendIds(t),n.legend.selectAll(e.selectorLegends(t)).style("visibility",null).transition().style("opacity",null)},hideLegend:function(t){var e=this.config,i=this.$el.legend;e.legend_show&&T(t)&&(e.legend_show=!1,i.style("visibility","hidden")),this.addHiddenLegendIds(t),i.selectAll(this.selectorLegends(t)).style("opacity","0").style("visibility","hidden")},getLegendItemTextBox:function(t,e){var i,n=this.cache,a=this.state,r=ft;return t&&((i=!a.redrawing&&n.get(r)||{})[t]||(i[t]=this.getTextRect(e,I.legendItem),n.add(r,i)),i=i[t]),i},setLegendItem:function(t){var i=this,n=i.api,a=i.config,r=i.state,s="touch"===r.inputType,o=i.hasType("gauge");t.attr("class",function(t){var e=(0,D.select)(this);return(!e.empty()&&e.attr("class")||"")+i.generateClass(I.legendItem,t)}).style("visibility",function(t){return i.isLegendToShow(t)?null:"hidden"}),a.interaction_enabled&&(t.style("cursor","pointer").on("click",function(t,e){S(a.legend_item_onclick,n,e)||(t.altKey?(n.hide(),n.show(e)):(n.toggle(e),(0,D.select)(this).classed(I.legendItemFocused,!1))),s&&i.hideTooltip()}),s||t.on("mouseout",function(t,e){S(a.legend_item_onout,n,e)||((0,D.select)(this).classed(I.legendItemFocused,!1),o&&i.undoMarkOverlapped(i,"."+I.gaugeValue),i.api.revert())}).on("mouseover",function(t,e){S(a.legend_item_onover,n,e)||((0,D.select)(this).classed(I.legendItemFocused,!0),o&&i.markOverlapped(e,i,"."+I.gaugeValue),!r.transiting&&i.isTargetToShow(e)&&n.focus(e))}))},updateLegendElement:function(t,e){function i(t,e,i){function n(t,e){e||(a=(o-f-s)/2)<10&&(a=(o-s)/2,f=0,y++),m[t]=y,_[y]=l.isLegendInset?10:a,p[t]=f,f+=s}var a,r=i===T.length-1,r=(t=c.getLegendItemTextBox(e,t)).width+d+(r&&!b?0:10)+u.legend_padding,t=t.height+4,s=b?t:r,o=b?c.getLegendHeight():c.getLegendWidth();if(0===i&&(g=h=y=f=0),u.legend_show&&!c.isLegendToShow(e))return x[e]=0,v[e]=0,m[e]=0,p[e]=0;x[e]=r,v[e]=t,(!h||h<=r)&&(h=r),(!g||g<=t)&&(g=t),t=b?g:h,u.legend_equally?(Object.keys(x).forEach(function(t){return x[t]=h}),Object.keys(v).forEach(function(t){return v[t]=g}),(a=(o-t*T.length)/2)<10?(y=f=0,T.forEach(function(t){return n(t)})):n(e,!0)):n(e)}var n,c=this,u=c.config,l=c.state,a=c.$el.legend,d=u.legend_item_tile_width+5,h=0,g=0,f=0,p={},x={},v={},_=[0],m={},y=0,b=l.isLegendRight||l.isLegendInset,T=t.filter(function(t){return!X(u.data_names[t])||null!==u.data_names[t]}),r=e.withTransition;l.isLegendInset&&(y=u.legend_inset_step||T.length,c.updateLegendStep(y));function s(t,e){return n(t,e)+4+u.legend_item_tile_width}function o(t,e){return n(t,e)}function w(t,e){return n(t,e)-2}function A(t,e){return n(t,e)-2+u.legend_item_tile_width}function k(t,e){return C(t,e)-5}function S(t,e){return C(t,e)+4}var C=l.isLegendRight?(n=function(t){return h*m[t]},function(t){return _[m[t]]+p[t]}):l.isLegendInset?(n=function(t){return h*m[t]+10},function(t){return _[m[t]]+p[t]}):(n=function(t){return _[m[t]]+p[t]},function(t){return g*m[t]}),E=function(t,e){return C(t,e)+9},R=-200,L=a.selectAll("."+I.legendItem).data(T).enter().append("g");c.setLegendItem(L),L.append("text").text(function(t){return X(u.data_names[t])?u.data_names[t]:t}).each(function(t,e){i(this,t,e)}).style("pointer-events","none").attr("x",b?s:R).attr("y",b?R:E),L.append("rect").attr("class",I.legendItemEvent).style("fill-opacity","0").attr("x",b?o:R).attr("y",b?R:k);var O,t=function(t){t=c.getDataById(t);return c.levelColor?c.levelColor(t.values[0].value):c.color(t)},e=u.legend_usePoint;e?(O=[],L.append(function(t){var e=$(u.point_pattern)?u.point_pattern:[u.point_type];-1===O.indexOf(t)&&O.push(t);e=e[O.indexOf(t)%e.length];return"rectangle"===e&&(e="rect"),P.createElementNS(D.namespaces.svg,"hasValidPointType"in c&&c.hasValidPointType(e)?e:"use")}).attr("class",I.legendItemPoint).style("fill",t).style("pointer-events","none").attr("href",function(t,e,i){return"use"===i[e].nodeName.toLowerCase()?"#"+l.datetimeId+"-point-"+t:void 0})):L.append("line").attr("class",I.legendItemTile).style("stroke",t).style("pointer-events","none").attr("x1",b?w:R).attr("y1",b?R:S).attr("x2",b?A:R).attr("y2",b?R:S).attr("stroke-width",u.legend_item_tile_height),L=a.select("."+I.legendBackground+" rect"),l.isLegendInset&&0<h&&0===L.size()&&(L=a.insert("g","."+I.legendItem).attr("class",I.legendBackground).append("rect"));R=a.selectAll("text").data(T).text(function(t){return X(u.data_names[t])?u.data_names[t]:t}).each(function(t,e){i(this,t,e)});(r?R.transition():R).attr("x",s).attr("y",E);E=a.selectAll("rect."+I.legendItemEvent).data(T);(r?E.transition():E).attr("width",function(t){return x[t]}).attr("height",function(t){return v[t]}).attr("x",o).attr("y",k),e?(e=a.selectAll("."+I.legendItemPoint).data(T),(r?e.transition():e).each(function(){var t,e,i,n,a=this.nodeName.toLowerCase(),r=u.point_r,s="x",o="y",c=2,l=2.5;"circle"===a?(s="cx",o="cy",e=r+(t=.2*r),c=2*r,l=-t):"rect"===a&&(n=i=2.5*r,l=3),(0,D.select)(this).attr(s,function(t){return w(t)+c}).attr(o,function(t){return S(t)-l}).attr("r",e).attr("width",i).attr("height",n)})):(a=a.selectAll("line."+I.legendItemTile).data(T),(r?a.transition():a).style("stroke",t).attr("x1",w).attr("y1",S).attr("x2",A).attr("y2",S)),L&&(r?L.transition():L).attr("height",c.getLegendHeight()-12).attr("width",h*(y+1)+10),c.updateLegendItemWidth(h),c.updateLegendItemHeight(g),c.updateLegendStep(y)}},$t=Ri(8),Bt={redraw:function(t){void 0===t&&(t={});var i=this,e=i.config,n=i.state,a=i.$el,r=a.main;n.redrawing=!0;var s=i.filterTargetsToShow(i.data.targets),o=t.initializing,c=t.flow,l=i.getWithOption(t),u=l.Transition?e.transition_duration:0,d=l.TransitionForExit?u:0,h=l.TransitionForAxis?u:0,h=i.axis&&i.axis.generateTransitions(h);i.updateSizes(o),l.Legend&&e.legend_show?(t.withTransition=!!u,i.updateLegend(i.mapToIds(i.data.targets),t,h)):l.Dimension&&i.updateDimension(!0),i.hasArcType()&&!n.hasRadar||!i.updateCircleY||(i.circleY=i.updateCircleY()),n.hasAxis?(i.axis.redrawAxis(s,l,h,c,o),e.data_empty_label_text&&r.select("text."+I.text+"."+I.empty).attr("x",n.width/2).attr("y",n.height/2).text(e.data_empty_label_text).style("display",s.length?"none":null),i.hasGrid()&&i.updateGrid(u),e.regions.length&&i.updateRegion(u),["bar","candlestick","line","area"].forEach(function(t){var e=U(t);(/^(line|area)$/.test(t)&&i.hasTypeOf(e)||i.hasType(t))&&i["update"+e](d)}),a.text&&r.selectAll("."+I.selectedCircles).filter(i.isBarType.bind(i)).selectAll("circle").remove(),e.interaction_enabled&&!c&&l.EventRect&&(i.redrawEventRect(),i.bindZoomEvent&&i.bindZoomEvent())):(a.arcs&&i.redrawArc(u,d,l.Transform),a.radar&&i.redrawRadar(d)),n.resizing||!i.hasPointType()&&!n.hasRadar||i.updateCircle(),i.hasDataLabel()&&!i.hasArcType(null,["radar"])&&i.updateText(d),i.redrawTitle&&i.redrawTitle(),o&&i.updateTypesElements(),i.generateRedrawList(s,c,u,l.Subchart),i.callPluginHook("$redraw",t,u)},generateRedrawList:function(t,e,i,n){var a=this,r=a.config,s=a.state,o=a.getDrawShape();s.hasAxis&&r.subchart_show&&a.redrawSubchart(n,i,o);var c,l=e&&a.generateFlow({targets:t,flow:e,duration:e.duration,shape:o,xv:a.xv.bind(a)}),t=(i||l)&&st(),u=a.getRedrawList(o,e,l,t),e=function(){l&&l(),s.redrawing=!1,S(r.onrendered,a.api)};t&&u.length?(c=Tt(),(0,$t.transition)().duration(i).each(function(){u.reduce(function(t,e){return t.concat(e)},[]).forEach(function(t){return c.add(t)})}).call(c,e)):s.transiting||e(),a.mapToIds(a.data.targets).forEach(function(t){s.withoutFadeIn[t]=!0})},getRedrawList:function(n,t,e,a){var r=this,i=r.config,s=r.state,o=s.hasAxis,c=s.hasRadar,l=r.$el.grid,u=n.pos,d=u.cx,h=u.cy,s=u.xForText,u=u.yForText,g=[];return o&&((i.grid_x_lines.length||i.grid_y_lines.length)&&g.push(r.redrawGrid(a)),i.regions.length&&g.push(r.redrawRegion(a)),Object.keys(n.type).forEach(function(t){var e=U(t),i=n.type[t];(/^(area|line)$/.test(t)&&r.hasTypeOf(e)||r.hasType(t))&&g.push(r["redraw"+e](i,a))}),!t&&l.main&&g.push(r.updateGridFocus())),r.hasArcType()&&!c||!$(i.data_labels)||!1===i.data_labels||g.push(r.redrawText(s,u,t,a)),(r.hasPointType()||c)&&!i.point_focus_only&&r.redrawCircle&&g.push(r.redrawCircle(d,h,a,e)),g},updateAndRedraw:function(t){var e,i=this,n=i.config,a=i.state;(t=void 0===t?{}:t).withTransition=A(t,"withTransition",!0),t.withTransform=A(t,"withTransform",!1),t.withLegend=A(t,"withLegend",!1),t.withUpdateXDomain=!0,t.withUpdateOrgXDomain=!0,t.withTransitionForExit=!1,t.withTransitionForTransform=A(t,"withTransitionForTransform",t.withTransition),t.withLegend&&n.legend_show||(a.hasAxis&&(e=i.axis.generateTransitions(t.withTransitionForAxis?n.transition_duration:0)),i.updateScales(),i.updateSvgSize(),i.transformAll(t.withTransitionForTransform,e)),i.redraw(t,e)},redrawWithoutRescale:function(){this.redraw({withY:!1,withSubchart:!1,withEventRect:!1,withTransitionForAxis:!1})}};function Nt(t,e,i){void 0===e&&(e=0),void 0===i&&(i=1);var n={linear:Lt.scaleLinear,log:Lt.scaleSymlog,_log:Lt.scaleLog,time:Lt.scaleTime,utc:Lt.scaleUtc}[t=void 0===t?"linear":t]();return n.type=t,/_?log/.test(t)&&n.clamp(!0),n.range([e,i])}var Yt={getXScale:function(t,e,i,n){e=this.scale.zoom||Nt(this.axis.getAxisType("x"),t,e);return this.getCustomizedScale(i?e.domain(i):e,n)},getYScale:function(t,e,i,n){i=Nt(this.axis.getAxisType(t),e,i);return n&&i.domain(n),i},getYScaleById:function(t,e){void 0===e&&(e=!1);t="y2"===this.axis.getId(t);return this.scale[e?t?"subY2":"subY":t?"y2":"y"]},getCustomizedScale:function(i,t){function e(t,e){return t=i(t)+r(),e?t:Math.ceil(t)}var n,a=this,r=t||function(){return a.axis.x.tickOffset()};for(n in i)e[n]=i[n];return e.orgDomain=function(){return i.domain()},e.orgScale=function(){return i},a.axis.isCategorized()&&(e.domain=function(t){return arguments.length?(i.domain(t),e):[(t=this.orgDomain())[0],t[1]+1]}),e},updateScales:function(t,e){void 0===e&&(e=!0);var i=this,n=i.axis,a=i.config,r=i.format,s=i.org,o=i.scale,c=i.state,l=c.width,u=c.height,d=c.width2,h=c.height2;c.hasAxis?(h={x:(c=a.axis_rotated)?1:0,y:c?0:u,subX:c?1:0,subY:c?0:h},c={x:c?u:l,y:c?l:1,subX:c?u:l,subY:c?d:1},d=e&&o.x&&o.x.orgDomain(),s=e&&s.xDomain,o.x=i.getXScale(h.x,c.x,d,function(){return n.x.tickOffset()}),o.subX=i.getXScale(h.x,c.x,s,function(t){return t%1?0:n.subX.tickOffset()}),r.xAxisTick=n.getXAxisTickFormat(),n.setAxis("x",o.x,a.axis_x_tick_outer,t),a.subchart_show&&n.setAxis("subX",o.subX,a.axis_x_tick_outer,t),o.y=i.getYScale("y",h.y,c.y,o.y?o.y.domain():a.axis_y_default),o.subY=i.getYScale("y",h.subY,c.subY,o.subY?o.subY.domain():a.axis_y_default),n.setAxis("y",o.y,a.axis_y_tick_outer,t),a.axis_y2_show&&(o.y2=i.getYScale("y2",h.y,c.y,o.y2?o.y2.domain():a.axis_y2_default),o.subY2=i.getYScale("y2",h.subY,c.subY,o.subY2?o.subY2.domain():a.axis_y2_default),n.setAxis("y2",o.y2,a.axis_y2_tick_outer,t))):i.updateArc&&i.updateArc()},xx:function(t){var e=this.config,i=this.scale,n=i.x,i=i.zoom,n=e.zoom_enabled&&i?i:n;return t?n(z(t.x)?t.x:t):null},xv:function(t){var e=this,i=e.axis,n=e.config,a=e.scale,r=a.x,a=a.zoom,r=n.zoom_enabled&&a?a:r,t=e.getBaseValue(t);return i.isTimeSeries()?t=rt.call(e,t):i.isCategorized()&&w(t)&&(t=n.axis_x_categories.indexOf(t)),Math.ceil(r(t))},yv:function(t){var e=this.scale,i=e.y,e=e.y2,i=t.axis&&"y2"===t.axis?e:i;return Math.ceil(i(this.getBaseValue(t)))},subxx:function(t){return t?this.scale.subX(t.x):null}},Gt=Ri(9),Vt={getDrawShape:function(){var t,n=this,e=n.config.axis_rotated,i=n.state.hasRadar,a={type:{},indices:{},pos:{}};return["bar","candlestick","line","area"].forEach(function(t){var e,i=U(/^(bubble|scatter)$/.test(t)?"line":t);(n.hasType(t)||n.hasTypeOf(i)||"line"===t&&(n.hasType("bubble")||n.hasType("scatter")))&&(e=n.getShapeIndices(n["is"+i+"Type"]),i=n["generateDraw"+i],a.indices[t]=e,a.type[t]=i?i.bind(n)(e,!1):void 0)}),n.hasArcType()&&!i||(t=i?n.radarCircleX:e?n.circleY:n.circleX,e=i?n.radarCircleY:e?n.circleX:n.circleY,a.pos={xForText:n.generateXYForText(a.indices,!0),yForText:n.generateXYForText(a.indices,!1),cx:(t||function(){}).bind(n),cy:(e||function(){}).bind(n)}),a},getShapeIndices:function(t){var o=this.config,c=o.data_xs,e=$(c),l={},u=e?{}:0;return e&&K(Object.keys(c).map(function(t){return c[t]})).forEach(function(t){u[t]=0,l[t]={}}),this.filterTargetsToShow(this.data.targets.filter(t,this)).forEach(function(t){for(var e,i=(t.id in c?c[t.id]:""),n=i?l[i]:l,a=0;e=o.data_groups[a];a++)if(!(e.indexOf(t.id)<0))for(var r,s=0;r=e[s];s++)if(r in n){n[t.id]=n[r];break}M(n[t.id])&&(n[t.id]=i?u[i]++:u++,n.__max__=(i?u[i]:u)-1)}),l},getIndices:function(t,e){var i=this.config.data_xs;return $(i)?t[i[e]]:t},getIndicesMax:function(e){return $(this.config.data_xs)?Object.keys(e).map(function(t){return e[t].__max__||0}).reduce(function(t,e){return t+e}):e.__max__},getShapeX:function(r,s,t){function o(t,e){return t+e}var c=this,e=c.config,i=c.scale,l=t?i.subX:i.zoom||i.x,u=e.bar_padding,d=b(r)&&(r._$total.length?r._$total.reduce(o)/2:0);return function(t){var e=c.getIndices(s,t.id),i=t.id in e?e[t.id]:0,n=(e.__max__||0)+1,a=0;return $(t.x)&&(e=l(t.x,!0),a=d?e-(r[t.id]||r._$width)+r._$total.slice(0,i+1).reduce(o)-d:e-(F(r)?r:r._$width)*(n/2-i)),r&&a&&1<n&&u&&(i&&(a+=u*i),2<n?a-=(n-1)*u/2:2===n&&(a-=u/2)),a}},getShapeY:function(i){var n=this,a=n.isStackNormalized();return function(t){var e=t.value;return F(t)?e=t:a?e=n.getRatio("index",t,!0):n.isBubbleZType(t)&&(e=n.getBubbleZData(t.value,"y")),n.getYScaleById(t.id,i)(e)}},getShapeYMin:function(t){var e=this.scale[this.axis.getId(t)].domain()[0];return!this.isGrouped(t)&&0<e?e:0},getShapeOffsetData:function(t){var a=this,e=a.orderTargets(a.filterTargetsToShow(a.data.targets.filter(t,a))),r=a.isStackNormalized(),t=e.map(function(t){var e=t.values,n={},i=(e=a.isStepType(t)?a.convertValuesToStep(e):e).reduce(function(t,e){var i=+e.x;return t[i]=e,n[i]=r?a.getRatio("index",e,!0):e.value,t},{});return{id:t.id,rowValues:e,rowValueMapByXValue:i,values:n}});return{indexMapByTargetId:e.reduce(function(t,e,i){return t[e.id]=i,t},{}),shapeOffsetTargets:t}},getShapeOffset:function(t,e,i){var n=this,t=n.getShapeOffsetData(t),h=t.shapeOffsetTargets,g=t.indexMapByTargetId;return function(t,a){var r=t.id,s=t.value,t=t.x,o=n.getIndices(e,r),c=n.getYScaleById(r,i),l=c(n.getShapeYMin(r)),u=+t,d=l;return h.filter(function(t){return t.id!==r}).forEach(function(t){var e=t.id,i=t.rowValueMapByXValue,n=t.rowValues,t=t.values;o[e]===o[r]&&g[e]<g[r]&&((n=!(n=n[a])||+n.x!=u?i[u]:n)&&0<=n.value*s&&F(t[u])&&(d+=c(t[u])-l))}),d}},getBarW:function(t,e,n){function i(t){var e=t?r[u][t]:r[u],i=t?e.ratio:r[u+"_ratio"],t=t?e.max:r[u+"_max"],i=F(e)?e:n?d*i/n:0;return t&&t<i?t:i}var a=this,r=a.config,s=a.org,o=a.scale,c=a.getMaxDataCount(),l="bar"===t&&r.data_groups.length,u=t+"_width",d=o.zoom&&!a.axis.isCategorized()?s.xDomain.map(function(t){return o.zoom(t)}).reduce(function(t,e){return Math.abs(t)+e})/c:e.tickInterval(c),h=i();return!l&&b(r[u])&&(h={_$width:h,_$total:[]},a.filterTargetsToShow(a.data.targets).forEach(function(t){r[u][t.id]&&(h[t.id]=i(t.id),h._$total.push(h[t.id]||h._$width))})),h},getShapeByIndex:function(t,e,i){var n=this.$el.main,e=z(e)?"-"+e:"";return(i?n.selectAll("."+I[t+"s"]+this.getTargetSelectorSuffix(i)):n).selectAll("."+I[t]+e)},isWithinShape:function(t,e){var i,n=this,a=(0,D.select)(t);return n.isTargetToShow(e.id)?"hasValidPointType"in n&&n.hasValidPointType(t.nodeName)?i=n.isStepType(e)?n.isWithinStep(t,n.getYScaleById(e.id)(e.value)):n.isWithinCircle(t,n.isBubbleType(e)?1.5*n.pointSelectR(e):0):"path"===t.nodeName&&(i=!a.classed(I.bar)||n.isWithinBar(t)):i=!1,i},getInterpolate:function(t){t=this.getInterpolateType(t);return{basis:Gt.curveBasis,"basis-closed":Gt.curveBasisClosed,"basis-open":Gt.curveBasisOpen,bundle:Gt.curveBundle,cardinal:Gt.curveCardinal,"cardinal-closed":Gt.curveCardinalClosed,"cardinal-open":Gt.curveCardinalOpen,"catmull-rom":Gt.curveCatmullRom,"catmull-rom-closed":Gt.curveCatmullRomClosed,"catmull-rom-open":Gt.curveCatmullRomOpen,"monotone-x":Gt.curveMonotoneX,"monotone-y":Gt.curveMonotoneY,natural:Gt.curveNatural,"linear-closed":Gt.curveLinearClosed,linear:Gt.curveLinear,step:Gt.curveStep,"step-after":Gt.curveStepAfter,"step-before":Gt.curveStepBefore}[t]},getInterpolateType:function(t){var e=this.config,i=e.spline_interpolation_type,i=this.isInterpolationType(i)?i:"cardinal";return this.isSplineType(t)?i:this.isStepType(t)?e.line_step_type:"linear"}},jt={setContainerSize:function(){var t=this.state;t.current.width=this.getCurrentWidth(),t.current.height=this.getCurrentHeight()},getCurrentWidth:function(){return this.config.size_width||this.getParentWidth()},getCurrentHeight:function(){var t=this.config,e=t.size_height||this.getParentHeight();return 0<e?e:320/(this.hasType("gauge")&&!t.gauge_fullCircle?2:1)},getCurrentPaddingTop:function(){var t=this,e=t.config,i=t.state.hasAxis,n=t.$el,a=i?e.axis_y2_axes.length:0,i=z(e.padding_top)?e.padding_top:0;return n.title&&n.title.node()&&(i+=t.getTitlePadding()),a&&e.axis_rotated&&(i+=t.getHorizontalAxisHeight("y2")*a),i},getCurrentPaddingBottom:function(){var t=this.config,e=this.state.hasAxis,i=t.axis_rotated?"y":"x",e=e?t["axis_"+i+"_axes"].length:0;return(z(t.padding_bottom)?t.padding_bottom:0)+(e?this.getHorizontalAxisHeight(i)*e:0)},getCurrentPaddingLeft:function(t){var e=this.config,i=this.state.hasAxis,n=e.axis_rotated,a=n?"x":"y",r=i?e["axis_"+a+"_axes"].length:0,t=i?this.getAxisWidthByAxisId(a,t):0;return(z(e.padding_left)?e.padding_left:i&&n?e.axis_x_show?Math.max(m(t),40):1:!i||e.axis_y_show&&!e.axis_y_inner?m(t):this.axis.getAxisLabelPosition("y").isOuter?30:1)+t*r},getCurrentPaddingRight:function(t){void 0===t&&(t=!1);var e=this,i=e.config,n=e.state.hasAxis,a=e.state.isLegendRight?e.getLegendWidth()+20:0,r=n?i.axis_y2_axes.length:0,n=n?e.getAxisWidthByAxisId("y2"):0,t=t?e.axis.getXAxisTickTextY2Overflow(10):0;return(z(i.padding_right)?i.padding_right+1:e.axis&&i.axis_rotated?10+a:!e.axis||i.axis_y2_show&&!i.axis_y2_inner?Math.max(m(n)+a,t):Math.max(2+a+(e.axis.getAxisLabelPosition("y2").isOuter?20:0),t))+n*r},getParentRectValue:function(t){for(var e="offset"+U(t),i=this.$el.chart.node(),n=0;n<30&&i&&"BODY"!==i.tagName;){try{n=i.getBoundingClientRect()[t]}catch(t){e in i&&(n=i[e])}i=i.parentNode}var a=P.body[e];return n=a<n?a:n},getParentWidth:function(){return this.getParentRectValue("width")},getParentHeight:function(){var t=this.$el.chart.style("height"),e=0;return e=t?/px$/.test(t)?parseInt(t,10):this.getParentRectValue("height"):e},getSvgLeft:function(t){var e=this.config,i=this.$el,n=e.axis_rotated||!e.axis_rotated&&!e.axis_y_inner,e=e.axis_rotated?I.axisX:I.axisY,e=i.main.select("."+e).node(),n=e&&n?e.getBoundingClientRect():{right:0},e=i.chart.node().getBoundingClientRect(),i=this.hasArcType(),t=n.right-e.left-(i?0:this.getCurrentPaddingLeft(t));return 0<t?t:0},updateDimension:function(t){var e=this,i=e.config,n=e.state.hasAxis,a=e.$el;n&&!t&&e.axis.x&&i.axis_rotated&&e.axis.subX&&e.axis.subX.create(a.axis.subX),e.updateScales(t),e.updateSvgSize(),e.transformAll(!1)},updateSvgSize:function(){var t=this,e=t.state,i=e.clip,n=e.current,a=e.hasAxis,r=e.width,s=e.height,e=t.$el.svg;e.attr("width",n.width).attr("height",n.height),a&&(n={width:0,height:0},(a=e.select("."+I.brush+" .overlay")).size()&&(n.width=+a.attr("width"),n.height=+a.attr("height")),e.selectAll(["#"+i.id,"#"+i.idGrid]).select("rect").attr("width",r).attr("height",s),e.select("#"+i.idXAxis).select("rect").call(t.setXAxisClipPath.bind(t)),e.select("#"+i.idYAxis).select("rect").call(t.setYAxisClipPath.bind(t)),i.idSubchart&&e.select("#"+i.idSubchart).select("rect").attr("width",r).attr("height",n.height))},updateSizes:function(t){var e=this,i=e.config,n=e.state,a=e.$el.legend,r=i.axis_rotated,s=e.hasArcType();t||e.setContainerSize();var o={width:a?e.getLegendWidth():0,height:a?e.getLegendHeight():0};!s&&i.axis_x_show&&i.axis_x_tick_autorotate&&e.updateXAxisTickClip();var c=n.isLegendRight||n.isLegendInset?0:o.height,l=r||s?0:e.getHorizontalAxisHeight("x"),t=i.subchart_axis_x_show&&i.subchart_axis_x_tick_text_show?l:30,a=i.subchart_show&&!s?i.subchart_size_height+t:0;n.margin=!s&&r?{top:e.getHorizontalAxisHeight("y2")+e.getCurrentPaddingTop(),right:s?0:e.getCurrentPaddingRight(!0),bottom:e.getHorizontalAxisHeight("y")+c+e.getCurrentPaddingBottom(),left:a+(s?0:e.getCurrentPaddingLeft())}:{top:4+e.getCurrentPaddingTop(),right:s?0:e.getCurrentPaddingRight(!0),bottom:l+a+c+e.getCurrentPaddingBottom(),left:s?0:e.getCurrentPaddingLeft()},n.margin2=r?{top:n.margin.top,right:NaN,bottom:20+c,left:e.state.rotatedPadding.left}:{top:n.current.height-a-c,right:NaN,bottom:t+c,left:n.margin.left},n.margin3={top:0,right:NaN,bottom:0,left:0},e.updateSizeForLegend&&e.updateSizeForLegend(o),n.width=n.current.width-n.margin.left-n.margin.right,n.height=n.current.height-n.margin.top-n.margin.bottom,n.width<0&&(n.width=0),n.height<0&&(n.height=0),n.width2=r?n.margin.left-n.rotatedPadding.left-n.rotatedPadding.right:n.width,n.height2=r?n.height:n.current.height-n.margin2.top-n.margin2.bottom,n.width2<0&&(n.width2=0),n.height2<0&&(n.height2=0);c=e.hasType("gauge"),r=i.legend_show&&n.isLegendRight;n.arcWidth=n.width-(r?o.width+10:0),n.arcHeight=n.height-(r&&!c?0:10),c&&!i.gauge_fullCircle&&(n.arcHeight+=n.height-e.getPaddingBottomForGauge()),e.updateRadius&&e.updateRadius(),n.isLegendRight&&s&&(n.margin3.left=n.arcWidth/2+1.1*n.radiusExpanded)}},Ht={opacityForText:function(t){return(!this.isBarType(t)||this.meetsLabelThreshold(Math.abs(this.getRatio("bar",t)),"bar"))&&this.hasDataLabel?null:"0"},initText:function(){this.$el.main.select("."+I.chart).append("g").attr("class",I.chartTexts)},updateTargetsForText:function(t){var e=this,i=e.getChartClass("Text"),n=e.getClass("texts","id"),a=e.classFocus.bind(e);e.$el.main.select("."+I.chartTexts).selectAll("."+I.chartText).data(t).attr("class",function(t){return i(t)+a(t)}).enter().append("g").style("opacity","0").attr("class",i).style("pointer-events","none").append("g").attr("class",n)},updateText:function(t){var s=this,e=s.$el,i=s.config,n=s.getClass("text","index"),a=e.main.selectAll("."+I.texts).selectAll("."+I.text).data(s.labelishData.bind(s));a.exit().transition().duration(t).style("fill-opacity","0").remove(),e.text=a.enter().append("text").merge(a).attr("class",n).attr("text-anchor",function(t){var e=t.value<0;return s.isCandlestickType(t)&&(e=(t=s.getCandlestickData(t))&&!t._isUp),i.axis_rotated?e?"end":"start":"middle"}).style("fill",s.updateTextColor.bind(s)).style("fill-opacity","0").each(function(t,e,i){var n,a=(0,D.select)(this),r=t.value;s.isBubbleZType(t)?r=s.getBubbleZData(r,"z"):!s.isCandlestickType(t)||(n=s.getCandlestickData(t))&&(r=n.close),r=s.dataLabelFormat(t.id)(r,t.id,e,i),F(r)?this.textContent=r:E(a,r)})},updateTextColor:function(t){var e,i=this,n=i.config,a=n.data_labels_colors,r=i.isArcType(t)&&!i.isRadarType(t)?null:i.color(t);return w(a)?e=a:N(a)?e=a[(t.data||t).id]:O(a)&&(e=a.bind(i.api)(r,t)),!i.isCandlestickType(t)||O(a)||(i=i.getCandlestickData(t))&&!i._isUp&&(n=n.candlestick_color_down,e=N(n)?n[t.id]:n),e||r},updateTextBacgroundColor:function(t){var e=this.$el,i=this.config.data_labels_backgroundColors,n="";return(w(i)||N(i))&&(t=w(i)?"":this.getTargetSelectorSuffix(("id"in t?t:t.data).id),(t=e.defs.select(["filter[id*='labels-bg","']"].join(t))).size()&&(n="url(#"+t.attr("id")+")")),n||null},redrawText:function(a,r,t,s){var e=this,o=j(!0);return e.$el.text.style("fill",e.updateTextColor.bind(e)).attr("filter",e.updateTextBacgroundColor.bind(e)).style("fill-opacity",t?0:e.opacityForText.bind(e)).each(function(t,e){var i=s&&this.getAttribute("x")?(0,D.select)(this).transition(o):(0,D.select)(this),n=a.bind(this)(t,e),e=r.bind(this)(t,e);this.childElementCount?i.attr("transform","translate("+n+" "+e+")"):i.attr("x",n).attr("y",e)}),!0},getTextRect:function(t,e){var i=t.node?t.node():t,n=(i=!/text/i.test(i.tagName)?i.querySelector("text"):i).textContent,t=_t+"-"+n.replace(/\W/g,"_"),a=this.cache.get(t);return a||(this.$el.svg.append("text").style("visibility","hidden").style("font",(0,D.select)(i).style("font")).classed(e,!0).text(n).call(function(t){a=V(t.node())}).remove(),this.cache.add(t,a)),a},generateXYForText:function(e,t){var n=this,i=Object.keys(e),a={},r=t?n.getXForText:n.getYForText;return n.hasType("radar")&&i.push("radar"),i.forEach(function(t){a[t]=n["generateGet"+U(t)+"Points"](e[t],!1)}),function(t,e){var i=(n.isAreaType(t)?"area":n.isBarType(t)&&"bar")||n.isCandlestickType(t)&&"candlestick"||n.isRadarType(t)&&"radar"||"line";return r.call(n,a[i](t,e),t,this)}},getCenteredTextPos:function(t,e,i){var n=this.config,a=n.axis_rotated;if(n.data_labels.centered&&this.isBarType(t)){i=V(i),t=0<=t.value;if(a){a=(t?e[1][1]-e[0][1]:e[0][1]-e[1][1])/2+i.width/2;return t?-a-3:2+a}i=(t?e[0][1]-e[1][1]:e[1][1]-e[0][1])/2+i.height/2;return t?i:-i-2}return 0},getTextPos:function(t,e){var i=this.config.data_labels_position;return(t in i?i[t]:i)[e]||0},getXForText:function(t,e,i){var n,a=this,r=a.config,s=a.state,o=r.axis_rotated,r=t[0][0];return a.hasType("candlestick")?o?r=a.getCandlestickData(e)._isUp?t[2][2]+4:t[2][1]-4:r+=(t[1][0]-r)/2:r=o?(n=a.isBarType(e)?4:6,t[2][1]+n*(e.value<0?-1:1)):a.hasType("bar")?(t[2][0]+t[0][0])/2:r,null===e.value&&(r>s.width?(n=V(i).width,r=s.width-n):r<0&&(r=4)),o&&(r+=a.getCenteredTextPos(e,t,i)),r+a.getTextPos(e.id,"x")},getYForText:function(t,e,i){var n,a=this,r=a.config,s=a.state,o=r.axis_rotated,c=r.point_r,l=V(i),u=e.value,d=3;return a.isCandlestickType(e)?(u=a.getCandlestickData(e),o?(n=t[0][0],n+=(t[1][0]-n)/2+d):n=u&&u._isUp?t[2][2]-d:t[2][1]+4*d):o?n=(t[0][0]+t[2][0]+.6*l.height)/2:(n=t[2][1],F(c)&&5<c&&(a.isLineType(e)||a.isScatterType(e))&&(d+=r.point_r/2.3),u<0||0===u&&!s.hasPositiveValue&&s.hasNegativeValue?n+=l.height+(a.isBarType(e)?-d:d):(u=2*-d,a.isBarType(e)?u=-d:a.isBubbleType(e)&&(u=d),n+=u)),null!==e.value||o||(n<(l=l.height)?n=l:n>s.height&&(n=s.height-4)),o||(n+=a.getCenteredTextPos(e,t,i)),n+a.getTextPos(e.id,"y")},markOverlapped:function(e,t,i){function n(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}var t=t.$el.arcs.selectAll(i),i=t.filter(function(t){return t.data.id!==e}),a=t.filter(function(t){return t.data.id===e}),r=q(a.node());a.node()&&i.each(function(){var t=q(this),e=(0,D.select)(this),i=n(r.e,r.f)>n(t.e,t.f)?a:e,i=Math.ceil(Math.abs(r.e-t.e))<Math.ceil(i.node().getComputedTextLength()),t=Math.ceil(Math.abs(r.f-t.f))<parseInt(a.style("font-size"),10);e.classed(I.TextOverlapping,i&&t)})},undoMarkOverlapped:function(t,e){t.$el.arcs.selectAll(e).each(function(){(0,D.selectAll)([this,this.previousSibling]).classed(I.TextOverlapping,!1)})},meetsLabelThreshold:function(t,e){return(this.config[e+"_label_threshold"]||0)<=(t=void 0===t?0:t)}};function Wt(t,e){void 0===t&&(t="left");var i=F(e);return-1<t.indexOf("center")?i?e/2:"middle":-1<t.indexOf("right")?i?e:"end":i?0:"start"}var Ut={initTitle:function(){var t=this.config,e=this.$el;t.title_text&&(e.title=e.svg.append("g"),E(e.title.append("text").style("text-anchor",Wt(t.title_position)).attr("class",I.title),t.title_text,[.3,1.5]))},redrawTitle:function(){var t,e=this,i=e.config,n=e.state.current,a=e.$el.title;a&&(t=e.yForTitle.call(e),/g/i.test(a.node().tagName)?a.attr("transform","translate("+Wt(i.title_position,n.width)+", "+t+")"):a.attr("x",e.xForTitle.call(e)).attr("y",t))},xForTitle:function(){var t,e=this.config,i=this.state.current,n=e.title_position||"left",a=this.getTextRect(this.$el.title,I.title).width;return/(right|center)/.test(n)?(t=i.width-a,0<=n.indexOf("right")?t=i.width-a-e.title_padding.right:0<=n.indexOf("center")&&(t=(i.width-a)/2)):t=e.title_padding.left||0,t},yForTitle:function(){return(this.config.title_padding.top||0)+this.getTextRect(this.$el.title,I.title).height},getTitlePadding:function(){return this.yForTitle()+(this.config.title_padding.bottom||0)}},Zt={initTooltip:function(){var t=this.config,e=this.$el;e.tooltip=(0,D.select)(t.tooltip_contents.bindto),e.tooltip.empty()&&(e.tooltip=e.chart.style("position","relative").append("div").attr("class",I.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none")),this.bindTooltipResizePos()},initShowTooltip:function(){var i=this,n=i.config,t=i.$el,e=i.state,a=e.hasAxis,e=e.hasRadar;if(n.tooltip_init_show){var r=!(a&&e);if(i.axis&&i.axis.isTimeSeries()&&w(n.tooltip_init_x)){var s,o,c=i.data.targets[0];for(n.tooltip_init_x=rt.call(i,n.tooltip_init_x),s=0;(o=c.values[s])&&o.x-n.tooltip_init_x!=0;s++);n.tooltip_init_x=s}e=i.data.targets.map(function(t){var e=r?0:n.tooltip_init_x;return i.addName(t.values[e])});r&&(e=[e[n.tooltip_init_x]]),t.tooltip.html(i.getTooltipHTML(e,i.axis&&i.axis.getXAxisTickFormat(),i.getDefaultValueFormat(),i.color)),n.tooltip_contents.bindto||t.tooltip.style("top",n.tooltip_init_position.top).style("left",n.tooltip_init_position.left).style("display",null)}},getTooltipHTML:function(){var t=this.api,e=this.config;return O(e.tooltip_contents)?e.tooltip_contents.bind(t).apply(void 0,arguments):this.getTooltipContent.apply(this,arguments)},getTooltipContent:function(t,e,i,n){function a(t){return s.axis&&s.isBubbleZType(t)?s.getBubbleZData(t.value,"z"):s.getBaseValue(t)}var r,s=this,o=s.api,c=s.config,l=s.state,u=["title","name","value"].map(function(t){t=c["tooltip_format_"+t];return O(t)?t.bind(o):t}),d=u[0],h=u[1],g=u[2],d=d||e,h=h||function(t){return t},g=g||(s.isStackNormalized()?function(t,e){return(100*e).toFixed(2)+"%"}:i),f=c.tooltip_order,p=s.levelColor?function(t){return s.levelColor(t.value)}:function(t){return n(t)},x=c.tooltip_contents,v=x.template,_=s.mapToTargetIds();null===f&&c.data_groups.length?(r=s.orderTargets(s.data.targets).map(function(t){return t.id}).reverse(),t.sort(function(t,e){var i=t?t.value:null,n=e?e.value:null;return 0<i&&0<n&&(i=t.id?r.indexOf(t.id):null,n=e.id?r.indexOf(e.id):null),i-n})):/^(asc|desc)$/.test(f)?t.sort(function(t,e){t=t?a(t):null,e=e?a(e):null;return"asc"===f?t-e:e-t}):O(f)&&t.sort(f.bind(o));for(var m,y,b,T,w,A,k,S,C,E=s.getTooltipContentTemplate(v),R=t.length,L=0;L<R;L++)if((m=t[L])&&(a(m)||0===a(m)))if(M(b)&&(w=(l.hasAxis||l.hasRadar)&&Y(d?d(m.x):m.x),b=at(E[0],{CLASS_TOOLTIP:I.tooltip,TITLE:z(w)?v?w:'<tr><th colspan="2">'+w+"</th></tr>":""})),!m.ratio&&s.$el.arcs&&(m.ratio=s.getRatio("arc",s.$el.arcs.select("path."+I.arc+"-"+m.id).data()[0])),y=[m.ratio,m.id,m.index,t],T=Y(g.apply(void 0,[a(m)].concat(y))),s.isAreaRangeType(m)?(k=(A=["high","low"].map(function(t){return Y(g.apply(void 0,[s.getRangedData(m,t)].concat(y)))}))[0],S=A[1],T="<b>Mid:</b> "+T+" <b>High:</b> "+k+" <b>Low:</b> "+S):s.isCandlestickType(m)&&(w=(C=["open","high","low","close","volume"].map(function(t){return Y(g.apply(void 0,[s.getRangedData(m,t,"candlestick")].concat(y)))}))[0],A=C[1],k=C[2],S=C[3],C=C[4],T="<b>Open:</b> "+w+" <b>High:</b> "+A+" <b>Low:</b> "+k+" <b>Close:</b> "+S+(C?" <b>Volume:</b> "+C:"")),void 0!==T)if("continue"===function(){if(null===m.name)return"continue";var e,t=Y(h.apply(void 0,[m.name].concat(y))),i=p(m),n={CLASS_TOOLTIP_NAME:I.tooltipName+s.getTargetSelectorSuffix(m.id),COLOR:v||!s.patterns?i:'<svg><rect style="fill:'+i+'" width="10" height="10"></rect></svg>',NAME:t,VALUE:T};v&&N(x.text)&&(e=_.indexOf(m.id),Object.keys(x.text).forEach(function(t){n[t]=x.text[t][e]})),b+=at(E[1],n)}())continue;return b+"</table>"},getTooltipContentTemplate:function(t){return(t||'<table class="{=CLASS_TOOLTIP}"><tbody>\n\t\t\t\t{=TITLE}\n\t\t\t\t{{<tr class="{=CLASS_TOOLTIP_NAME}">\n\t\t\t\t\t<td class="name">'+(this.patterns?"{=COLOR}":'<span style="background-color:{=COLOR}"></span>')+'{=NAME}</td>\n\t\t\t\t\t<td class="value">{=VALUE}</td>\n\t\t\t\t</tr>}}\n\t\t\t</tbody></table>').replace(/(\r?\n|\t)/g,"").split(/{{(.*)}}/)},tooltipPosition:function(t,e,i,n){var a=this,r=a.config,s=a.scale,o=a.state,c=o.width,l=o.height,u=o.current,d=o.isLegendRight,h=o.inputType,g=o.event,f=a.hasType("gauge")&&!r.gauge_fullCircle,p=a.getSvgLeft(!0),x=p+u.width-a.getCurrentPaddingRight(),o=a.getCurrentPaddingLeft(!0),g=L(g,n),n=g[0],g=g[1];a.hasArcType()?"touch"===h||a.hasType("radar")||(g+=f?l:l/2,n+=(c-(d?a.getLegendWidth():0))/2):(t=s.x(t[0].x),r.axis_rotated?(g=t+20,n+=p+100,x-=p):(g-=5,n=p+o+20+(a.scale.zoom?n:t))),x<n+e+15&&(n-=e+o),g+i>u.height&&(g-=f?3*i:i+30);var v={top:g,left:n};return Object.keys(v).forEach(function(t){v[t]<0&&(v[t]=0)}),v},showTooltip:function(t,e){var i,n,a,r,s,o,c=this,l=c.config,u=c.state,d=c.$el.tooltip,h=l.tooltip_contents.bindto,g=t.filter(function(t){return t&&z(c.getBaseValue(t))});d&&0!==g.length&&l.tooltip_show&&(n=void 0===(a=(r=(i=d.datum())||{}).width)?0:a,a=void 0===(s=r.height)?0:s,r=JSON.stringify(t),i&&i.current===r||(s=t.concat().sort()[0].index,S(l.tooltip_onshow,c.api,t),d.html(c.getTooltipHTML(t,c.axis?c.axis.getXAxisTickFormat():c.categoryName.bind(c),c.getDefaultValueFormat(),c.color)).style("display",null).style("visibility",null).datum(i={index:s,current:r,width:n=d.property("offsetWidth"),height:a=d.property("offsetHeight")}),S(l.tooltip_onshown,c.api,t),c._handleLinkedCharts(!0,s)),h||(o=((null==(l=l.tooltip_position)?void 0:l.bind(c.api))||c.tooltipPosition.bind(c))(g,n,a,e),["top","left"].forEach(function(t){var e=o[t];d.style(t,e+"px"),"left"!==t||i.xPosInPercent||(i.xPosInPercent=e/u.current.width*100)})))},bindTooltipResizePos:function(){var t=this.resizeFunction,n=this.state,a=this.$el.tooltip;t.add(function(){var t,e,i;"block"===a.style("display")&&(t=n.current,i=(e=a.datum()).width,e=e.xPosInPercent,e=t.width/100*e,(i=t.width-(e+i))<0&&(e+=i),a.style("left",e+"px"))})},hideTooltip:function(t){var e=this.api,i=this.config,n=this.$el.tooltip;!n||"none"===n.style("display")||i.tooltip_doNotHide&&!t||(t=JSON.parse(n.datum().current),S(i.tooltip_onhide,e,t),n.style("display","none").style("visibility","hidden").datum(null),S(i.tooltip_onhidden,e,t))},_handleLinkedCharts:function(r,s){var o,e=this,t=e.charts,i=e.config,n=e.state.event;n&&n.isTrusted&&i.tooltip_linked&&1<t.length&&(o=i.tooltip_linked_name,t.filter(function(t){return t!==e.api}).forEach(function(t){var e=t.internal,i=e.config,n=e.$el,a=i.tooltip_linked,e=i.tooltip_linked_name,i=P.body.contains(n.chart.node());if(a&&o===e&&i){n=n.tooltip.data()[0],n=s!==(n&&n.index);try{t.tooltip[r&&n?"show":"hide"]({index:s})}catch(t){}}}))}},qt={getTranslate:function(t,e){var i,n,a=this.config,r=this.state,s=a.axis_rotated,a=0;return(e=void 0===e?0:e)&&/^(x|y2?)$/.test(t)&&(a=this.getAxisSize(t)*e),"main"===t?(i=y(r.margin.left),n=y(r.margin.top)):"context"===t?(i=y(r.margin2.left),n=y(r.margin2.top)):"legend"===t?(i=r.margin3.left,n=r.margin3.top):"x"===t?(i=s?-a:0,n=s?0:r.height+a):"y"===t?(i=s?0:-a,n=s?r.height+a:0):"y2"===t?(i=s?0:r.width+a,n=s?1-a:0):"subX"===t?(i=0,n=s?0:r.height2):"arc"===t?(i=r.arcWidth/2,n=r.arcHeight/2):"radar"===t&&(t=this.getRadarSize()[0],i=r.width/2-t,n=y(r.margin.top)),"translate("+i+", "+n+")"},transformMain:function(t,e){var i,n,a,r=this,s=r.$el.main;e&&e.axisX?i=e.axisX:(i=s.select("."+I.axisX),t&&(i=i.transition())),e&&e.axisY?n=e.axisY:(n=s.select("."+I.axisY),t&&(n=n.transition())),e&&e.axisY2?a=e.axisY2:(a=s.select("."+I.axisY2),t&&(a=a.transition())),(t?s.transition():s).attr("transform",r.getTranslate("main")),i.attr("transform",r.getTranslate("x")),n.attr("transform",r.getTranslate("y")),a.attr("transform",r.getTranslate("y2")),s.select("."+I.chartArcs).attr("transform",r.getTranslate("arc"))},transformAll:function(t,e){var i=this,n=i.config,a=i.state.hasAxis,r=i.$el;i.transformMain(t,e),a&&n.subchart_show&&i.transformContext(t,e),r.legend&&i.transformLegend(t)}},Kt={setTargetType:function(t,e){var i=this.config,n=this.state.withoutFadeIn;this.mapToTargetIds(t).forEach(function(t){n[t]=e===i.data_types[t],i.data_types[t]=e}),t||(i.data_type=e)},updateTypesElements:function(){var n=this,a=n.state.current;Object.keys(It).forEach(function(t){var e=It[t],i=n.hasType(e,null,!0),t=a.types.indexOf(e);-1===t&&i?a.types.push(e):-1<t&&!i&&a.types.splice(t,1)}),n.setChartElements()},hasType:function(e,t,i){var n=this.config,a=this.state.current,r=n.data_types,t=t||this.data.targets,s=!1;return!(i=void 0===i?!1:i)&&a.types.length&&-1<a.types.indexOf(e)?s=!0:t&&t.length?t.forEach(function(t){t=r[t.id];t!==e&&(t||"line"!==e)||(s=!0)}):Object.keys(r).length?Object.keys(r).forEach(function(t){r[t]===e&&(s=!0)}):s=n.data_type===e,s},hasTypeOf:function(t,e,i){var n=this;return void 0===i&&(i=[]),!!(t in Pt)&&!Pt[t].filter(function(t){return-1===i.indexOf(t)}).every(function(t){return!n.hasType(t,e)})},isTypeOf:function(t,e){t=w(t)?t:t.id,t=this.config.data_types[t]||this.config.data_type;return B(e)?0<=e.indexOf(t):t===e},hasPointType:function(){return this.hasTypeOf("Line")||this.hasType("bubble")||this.hasType("scatter")},hasArcType:function(t,e){return this.hasTypeOf("Arc",t,e)},hasMultiArcGauge:function(){return this.hasType("gauge")&&"multi"===this.config.gauge_type},isLineType:function(t){t=w(t)?t:t.id;return!this.config.data_types[t]||this.isTypeOf(t,Pt.Line)},isStepType:function(t){return this.isTypeOf(t,Pt.Step)},isSplineType:function(t){return this.isTypeOf(t,Pt.Spline)},isAreaType:function(t){return this.isTypeOf(t,Pt.Area)},isAreaRangeType:function(t){return this.isTypeOf(t,Pt.AreaRange)},isBarType:function(t){return this.isTypeOf(t,"bar")},isBubbleType:function(t){return this.isTypeOf(t,"bubble")},isCandlestickType:function(t){return this.isTypeOf(t,"candlestick")},isScatterType:function(t){return this.isTypeOf(t,"scatter")},isPieType:function(t){return this.isTypeOf(t,"pie")},isGaugeType:function(t){return this.isTypeOf(t,"gauge")},isDonutType:function(t){return this.isTypeOf(t,"donut")},isRadarType:function(t){return this.isTypeOf(t,"radar")},isArcType:function(t){return this.isPieType(t)||this.isDonutType(t)||this.isGaugeType(t)||this.isRadarType(t)},isCirclePoint:function(t){var e=this.config,i=e.point_pattern;return!(!t||"circle"!==t.tagName)||"circle"===e.point_type&&(!i||B(i)&&0===i.length)},lineData:function(t){return this.isLineType(t)?[t]:[]},arcData:function(t){return this.isArcType(t.data)?[t]:[]},labelishData:function(t){return this.isBarType(t)||this.isLineType(t)||this.isScatterType(t)||this.isBubbleType(t)||this.isCandlestickType(t)||this.isRadarType(t)?t.values.filter(function(t){return F(t.value)||!!t.value}):[]},barLineBubbleData:function(t){return this.isBarType(t)||this.isLineType(t)||this.isBubbleType(t)?t.values:[]},isInterpolationType:function(t){return 0<=["basis","basis-closed","basis-open","bundle","cardinal","cardinal-closed","cardinal-open","catmull-rom","catmull-rom-closed","catmull-rom-open","linear","linear-closed","monotone-x","monotone-y","natural"].indexOf(t)}},Jt=function(){function t(t){this.api=void 0,this.config=void 0,this.cache=void 0,this.$el=void 0,this.state=void 0,this.charts=void 0,this.data={xs:{},targets:[]},this.axis=void 0,this.scale={x:null,y:null,y2:null,subX:null,subY:null,subY2:null,zoom:null},this.org={xScale:null,xDomain:null},this.color=void 0,this.patterns=void 0,this.levelColor=void 0,this.point=void 0,this.brush=void 0,this.format={extraLineClasses:null,xAxisTick:null,dataTime:null,defaultAxisTime:null,axisTime:null};var e=this;e.api=t,e.config=new lt,e.cache=new mt;t=new a;e.$el=t.getStore("element"),e.state=t.getStore("state")}var e=t.prototype;return e.$T=function(t,e,i){var n=this.config,a=this.state,r=n.transition_duration,n=n.subchart_show,t=t;return t&&("tagName"in t&&(t=(0,D.select)(t)),t=(!1!==e&&r||e)&&(!a.zooming||a.dragging)&&!a.resizing&&a.rendered&&!n?t.transition(i).duration(r):t),t},e.beforeInit=function(){this.callPluginHook("$beforeInit"),S(this.config.onbeforeinit,this.api)},e.afterInit=function(){this.callPluginHook("$afterInit"),S(this.config.onafterinit,this.api)},e.init=function(){var t=this,e=t.config,i=t.state,n=t.$el;i.hasAxis=!t.hasArcType(),i.hasRadar=!i.hasAxis&&t.hasType("radar"),t.initParams();i={element:e.bindto,classname:"bb"};N(e.bindto)&&(i.element=e.bindto.element||"#chart",i.classname=e.bindto.classname||i.classname),n.chart=O(i.element.node)?e.bindto.element:(0,D.select)(i.element||[]),n.chart.empty()&&(n.chart=(0,D.select)(P.body.appendChild(P.createElement("div")))),n.chart.html("").classed(i.classname,!0),t.initToRender()},e.initToRender=function(t){function i(){return"none"===r.style("display")||"hidden"===r.style("visibility")}var n=this,e=n.config,a=n.state,r=n.$el.chart,s=e.render.lazy||i(),o=p.MutationObserver;s&&o&&!1!==e.render.observe&&!t&&new o(function(t,e){i()||(e.disconnect(),a.rendered||n.initToRender(!0))}).observe(r.node(),{attributes:!0,attributeFilter:["class","style"]}),s&&!t||((e=n.convertData(e,n.initWithData))&&n.initWithData(e),n.afterInit())},e.initParams=function(){var n,t,a=this,e=a.config,r=a.format,i=a.state,s=e.axis_rotated;i.datetimeId="bb-"+ +new Date,a.color=a.generateColor(),a.levelColor=a.generateLevelColor(),a.hasPointType()&&(a.point=a.generatePoint()),i.hasAxis&&(a.initClip(),r.extraLineClasses=a.generateExtraLineClass(),r.dataTime=e.data_xLocaltime?o.timeParse:o.utcParse,r.axisTime=e.axis_x_localtime?o.timeFormat:o.utcFormat,n=a.config.zoom_enabled&&"drag"===a.config.zoom_type,r.defaultAxisTime=function(t){var e=a.scale,i=e.x,e=e.zoom,e=n?e:e&&i.orgDomain().toString()!==e.domain().toString(),e=(t.getMilliseconds()?".%L":t.getSeconds()&&".:%S")||t.getMinutes()&&"%I:%M"||t.getHours()&&"%I %p"||1!==t.getDate()&&"%b %d"||e&&1===t.getDate()&&"%b'%y"||t.getMonth()&&"%-m/%-d"||"%Y";return r.axisTime(e)(t)}),i.isLegendRight="right"===e.legend_position,i.isLegendInset="inset"===e.legend_position,i.isLegendTop="top-left"===e.legend_inset_anchor||"top-right"===e.legend_inset_anchor,i.isLegendLeft="top-left"===e.legend_inset_anchor||"bottom-left"===e.legend_inset_anchor,i.rotatedPaddingRight=s&&!e.axis_x_show?0:30,i.inputType=(t=e.interaction_inputType_mouse,s=e.interaction_inputType_touch,i=!1,/Mobi/.test(p.navigator.userAgent)&&s&&(e=p.navigator&&"maxTouchPoints"in p.navigator&&0<p.navigator.maxTouchPoints,s="ontouchmove"in p||p.DocumentTouch&&P instanceof p.DocumentTouch,i=e||s),(!(!t||i)&&"onmouseover"in p?"mouse":i&&"touch")||null)},e.initWithData=function(t){var e=this,i=e.config,n=e.scale,a=e.state,r=e.$el,s=e.org,o=a.hasAxis,c=i.interaction_enabled;o&&(e.axis=e.getAxisInstance(),i.zoom_enabled&&e.initZoom()),e.data.xs={},e.data.targets=e.convertDataToTargets(t),i.data_filter&&(e.data.targets=e.data.targets.filter(i.data_filter.bind(e.api))),i.data_hide&&e.addHiddenTargetIds(!0===i.data_hide?e.mapToIds(e.data.targets):i.data_hide),i.legend_hide&&e.addHiddenLegendIds(!0===i.legend_hide?e.mapToIds(e.data.targets):i.legend_hide),e.updateSizes(),e.updateScales(!0);var l=n.x,u=n.y,d=n.y2,h=n.subX,t=n.subY,n=n.subY2;l&&(l.domain(tt(e.getXDomain(e.data.targets))),h.domain(l.domain()),s.xDomain=l.domain()),u&&(u.domain(e.getYDomain(e.data.targets,"y")),t.domain(u.domain())),d&&(d.domain(e.getYDomain(e.data.targets,"y2")),n&&n.domain(d.domain())),r.svg=r.chart.append("svg").style("overflow","hidden").style("display","block"),c&&a.inputType&&(g="touch"===a.inputType,r.svg.on(g?"touchstart":"mouseenter",function(){return S(i.onover,e.api)}).on(g?"touchend":"mouseleave",function(){return S(i.onout,e.api)})),i.svg_classname&&r.svg.attr("class",i.svg_classname);var g=O(i.color_tiles)&&e.patterns;(o||g||i.data_labels_backgroundColors)&&(r.defs=r.svg.append("defs"),o&&["id","idXAxis","idYAxis","idGrid"].forEach(function(t){e.appendClip(r.defs,a.clip[t])}),e.generateDataLabelBackgroundColorFilter(),g&&e.patterns.forEach(function(t){return r.defs.append(function(){return t.node})})),e.updateSvgSize(),e.bindResize();g=r.svg.append("g").classed(I.main,!0).attr("transform",e.getTranslate("main"));r.main=g,i.subchart_show&&e.initSubchart(),i.tooltip_show&&e.initTooltip(),i.title_text&&e.initTitle(),i.legend_show&&e.initLegend(),i.data_empty_label_text&&g.append("text").attr("class",I.text+" "+I.empty).attr("text-anchor","middle").attr("dominant-baseline","middle"),o&&(i.regions.length&&e.initRegion(),i.clipPath||e.axis.init()),g.append("g").attr("class",I.chart).attr("clip-path",a.clip.path),e.callPluginHook("$init"),o&&(c&&e.initEventRect&&e.initEventRect(),e.initGrid(),i.clipPath&&e.axis&&e.axis.init()),e.initChartElements(),e.updateTargets(e.data.targets),e.updateDimension(),S(i.oninit,e.api),e.setBackground(),e.redraw({withTransition:!1,withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransitionForAxis:!1,initializing:!0}),(i.data_onmin||i.data_onmax)&&(c=e.getMinMaxData(),S(i.data_onmin,e.api,c.min),S(i.data_onmax,e.api,c.max)),i.tooltip_show&&e.initShowTooltip(),a.rendered=!0},e.initChartElements=function(){var i=this,t=i.state,e=t.hasAxis,t=t.hasRadar,n=[];e?["bar","bubble","candlestick","line"].forEach(function(t){var e=U(t);("line"===t&&i.hasTypeOf(e)||i.hasType(t))&&n.push(e)}):(t||n.push("Arc","Pie"),i.hasType("gauge")?n.push("Gauge"):t&&n.push("Radar")),n.forEach(function(t){i["init"+t]()}),$(i.config.data_labels)&&!i.hasArcType(null,["radar"])&&i.initText()},e.setChartElements=function(){var t=this.$el,e=t.chart,i=t.svg,n=t.defs,a=t.main,r=t.tooltip,s=t.legend,o=t.title,c=t.grid,l=t.arcs,u=t.circle,d=t.bar,h=t.candlestick,g=t.line,f=t.area,t=t.text;this.api.$={chart:e,svg:i,defs:n,main:a,tooltip:r,legend:s,title:o,grid:c,arc:l,circles:u,bar:{bars:d},candlestick:h,line:{lines:g,areas:f},text:{texts:t}}},e.setBackground=function(){var t=this.config.background,e=this.state,i=this.$el.svg;$(t)&&(i=i.select("g").insert(t.imgUrl?"image":"rect",":first-child"),t.imgUrl?i.attr("href",t.imgUrl):t.color&&i.style("fill",t.color).attr("clip-path",e.clip.path),i.attr("class",t.class||null).attr("width","100%").attr("height","100%"))},e.updateTargets=function(i){var n=this,t=n.state,e=t.hasAxis,t=t.hasRadar;n.updateTargetsForText(i),e?(["bar","candlestick","line"].forEach(function(t){var e=U(t);("line"===t&&n.hasTypeOf(e)||n.hasType(t))&&n["updateTargetsFor"+e](i.filter(n["is"+e+"Type"].bind(n)))}),n.updateTargetsForSubchart&&n.updateTargetsForSubchart(i)):n.hasArcType(i)&&(t?n.updateTargetsForRadar(i.filter(n.isRadarType.bind(n))):n.updateTargetsForArc(i.filter(n.isArcType.bind(n)))),(n.hasType("bubble")||n.hasType("scatter"))&&n.updateTargetForCircle&&n.updateTargetForCircle(),n.showTargets()},e.showTargets=function(){var e=this,t=e.config;e.$el.svg.selectAll("."+I.target).filter(function(t){return e.isTargetToShow(t.id)}).transition().duration(t.transition_duration).style("opacity",null)},e.getWithOption=function(i){var n={Dimension:!0,EventRect:!0,Legend:!1,Subchart:!0,Transform:!1,Transition:!0,TrimXDomain:!0,UpdateXAxis:"UpdateXDomain",UpdateXDomain:!1,UpdateOrgXDomain:!1,TransitionForExit:"Transition",TransitionForAxis:"Transition",Y:!0};return Object.keys(n).forEach(function(t){var e=n[t];w(e)&&(e=n[e]),n[t]=A(i,"with"+t,e)}),n},e.initialOpacity=function(t){var e=this.state.withoutFadeIn;return null!==this.getBaseValue(t)&&e[t.id]?null:"0"},e.bindResize=function(){var t,e,i,n=this,a=n.config,r=n.state,s=(e=[],(i=function(){i.clear(),t=yt(function(){e.forEach(function(t){return t()})},200)}).clear=function(){t&&(bt(t),t=null)},i.add=function(t){return e.push(t)},i.remove=function(t){return e.splice(e.indexOf(t),1)},i),o=[];o.push(function(){return S(a.onresize,n,n.api)}),a.resize_auto&&o.push(function(){r.resizing=!0,n.api.flush(!1)}),o.push(function(){S(a.onresized,n,n.api),r.resizing=!1}),o.forEach(function(t){return s.add(t)}),n.resizeFunction=s,p.addEventListener("resize",n.resizeFunction=s)},e.callPluginHook=function(e){for(var i=this,t=arguments.length,n=Array(1<t?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.config.plugins.forEach(function(t){"$beforeInit"===e&&(t.$$=i).api.plugins.push(t),t[e].apply(t,n)})},t}();W(Jt.prototype,[At,kt,St,{categoryName:function(t){var e=this.config.axis_x_categories;return e&&t<e.length?e[t]:t}},Rt,Dt,zt,Et,Xt,Ft,Bt,Yt,Vt,jt,Ht,Ut,Zt,qt,Kt]);St={resize:function(t){var e=this.internal,i=e.config,n=e.state;n.rendered&&(i.size_width=t?t.width:null,i.size_height=t?t.height:null,n.resizing=!0,this.flush(!1,!0),e.resizeFunction())},flush:function(t){var e=this.internal,i=e.state,n=e.$el.zoomResetBtn;i.rendered?(i.resizing?e.brush&&e.brush.updateResize():e.axis&&e.axis.setOrient(),null!=n&&n.style("display","none"),e.scale.zoom=null,t?e.redraw({withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withLegend:!0}):e.updateAndRedraw({withLegend:!0,withTransition:!1,withTransitionForTransform:!1}),!i.resizing&&e.brush&&(e.brush.getSelection().call(e.brush.move),e.unselectRect())):e.initToRender(!0)},destroy:function(){var e=this,i=this.internal,t=i.$el,n=t.chart,t=t.svg;if($(i))for(var a in i.callPluginHook("$willDestroy"),i.charts.splice(i.charts.indexOf(this),1),t.select("*").interrupt(),i.resizeFunction.clear(),p.removeEventListener("resize",i.resizeFunction),n.classed("bb",!1).html(""),Object.keys(this).forEach(function(t){"internal"===t&&Object.keys(i).forEach(function(t){i[t]=null}),e[t]=null,delete e[t]}),this)this[a]=function(){};return null},config:function(t,e,i){var n,a=this.internal.config,t=t&&t.replace(/\./g,"_");return t in a&&(X(e)?(n=a[t]=e,i&&this.flush()):n=a[t]),n}};function Qt(t){var e=this.internal.data.targets;if(M(t))return e;var i=B(t)?t:[t];return e.filter(function(e){return i.some(function(t){return t===e.id})})}W(Qt,{shown:function(t){return this.internal.filterTargetsToShow(this.data(t))},values:function(t,e){void 0===e&&(e=!0);var i=null;return!t||(t=this.data(t))&&B(t)&&(i=[],t.forEach(function(t){t=t.values.map(function(t){return t.value});e?i=i.concat(t):i.push(t)})),i},names:function(t){return this.internal.updateDataAttributes("names",t)},colors:function(t){return this.internal.updateDataAttributes("colors",t)},axes:function(t){return this.internal.updateDataAttributes("axes",t)},min:function(){return this.internal.getMinMaxData().min},max:function(){return this.internal.getMinMaxData().max}});function te(t,e,i){var n,a=e||i,r=a.width,s=a.height,o=new XMLSerializer,c=t.cloneNode(!0),t=(a=Z(P.styleSheets),n=[],a.forEach(function(e){try{e.cssRules&&e.cssRules.length&&(n=n.concat(Z(e.cssRules)))}catch(t){console.error("Error while reading rules from "+e.href+": "+t.toString())}}),n.filter(function(t){return t.cssText}).map(function(t){return t.cssText}));c.setAttribute("xmlns",D.namespaces.xhtml);a=o.serializeToString(c),c=P.createElement("style");c.appendChild(P.createTextNode(t.join("\n")));c=o.serializeToString(c),a=('<svg xmlns="'+D.namespaces.svg+'" width="'+r+'" height="'+s+'" \n\t\tviewBox="0 0 '+i.width+" "+i.height+'" \n\t\tpreserveAspectRatio="'+(e&&!1===e.preserveAspectRatio?"none":"xMinYMid meet")+'">\n\t\t\t<foreignObject width="100%" height="100%">\n\t\t\t\t'+c+"\n\t\t\t\t"+a.replace(/(url\()[^#]+/g,"$1")+"\n\t\t\t</foreignObject></svg>").replace("/\n/g","%0A");return"data:image/svg+xml;base64,"+btoa(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode(+("0x"+e))}))}function ee(t,e,i){var n=this,a=this.internal,r=a.mapToTargetIds(e),s=a.state.hiddenTargetIds.map(function(t){return-1<r.indexOf(t)&&t}).filter(Boolean);a.state.toggling=!0,a[(t?"remove":"add")+"HiddenTargetIds"](r);var o=a.$el.svg.selectAll(a.selectorTargets(r)),c=t?null:"0";t&&s.length&&(o.style("display",null),S(a.config.data_onshown,this,s)),o.transition().style("opacity",c,"important").call(C,function(){t||0!==s.length||(o.style("display","none"),S(a.config.data_onhidden,n,r)),o.style("opacity",c)}),i.withLegend&&a[(t?"show":"hide")+"Legend"](r),a.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),a.state.toggling=!1}var ie=function t(e){this.plugins=[],this.internal=void 0;var i=new Jt(this);this.internal=i,function r(s,o,c){Object.keys(s).forEach(function(t){var e=O(s[t]),i=o!==c,n=$(s[t]),a=n&&0<Object.keys(s[t]).length;o[t]=e&&(!i&&a||i)?s[t].bind(c):n&&!e?{}:s[t],a&&r(s[t],o[t],c)})}(t.prototype,this,this),function(e){var i,n,a,r=this.config,s=function(){var t=n.shift();return t&&i&&b(i)&&t in i?(i=i[t],s()):t?void 0:i};Object.keys(r).forEach(function(t){i=e,n=t.split("_"),a=s(),X(a)&&(r[t]=a)})}.call(i,e),i.beforeInit(),i.init()};function ne(t,e,i){var n=t.config,a="axis_y_"+e,r="axis_y2_"+e;X(i)&&(b(i)?(z(i.x)&&(n["axis_x_"+e]=i.x),z(i.y)&&(n[a]=i.y),z(i.y2)&&(n[r]=i.y2)):(n[a]=i,n[r]=i),t.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0}))}function ae(t,e){t=t.config;return{x:t["axis_x_"+e],y:t["axis_y_"+e],y2:t["axis_y2_"+e]}}W(ie.prototype,[St,{color:function(t){return this.internal.color(t)}},{data:Qt},{export:function(t,i){var n,a=this,e=this.internal,r=e.state,e=e.$el.chart,r=r.current,s=r.width,o=r.height,c=Q({width:s,height:o,preserveAspectRatio:!0,mimeType:"image/png"},t),e=te(e.node(),c,{width:s,height:o});return i&&O(i)&&((n=new Image).crossOrigin="Anonymous",n.onload=function(){var t=P.createElement("canvas"),e=t.getContext("2d");t.width=c.width||s,t.height=c.height||o,e.drawImage(n,0,0),i.bind(a)(t.toDataURL(c.mimeType))},n.src=e),e}},{focus:function(t){var e=this.internal,i=e.state,n=e.mapToTargetIds(t),a=e.$el.svg.selectAll(e.selectorTargets(n.filter(e.isTargetToShow,e)));this.revert(),this.defocus(),a.classed(I.focused,!0).classed(I.defocused,!1),e.hasArcType()&&!i.hasRadar&&(e.expandArc(n),e.hasType("gauge")&&e.markOverlapped(t,e,"."+I.gaugeValue)),e.toggleFocusLegend(n,!0),i.focusedTargetIds=n,i.defocusedTargetIds=i.defocusedTargetIds.filter(function(t){return n.indexOf(t)<0})},defocus:function(t){var e=this.internal,i=e.state,n=e.mapToTargetIds(t);e.$el.svg.selectAll(e.selectorTargets(n.filter(e.isTargetToShow,e))).classed(I.focused,!1).classed(I.defocused,!0),e.hasArcType()&&(e.unexpandArc(n),e.hasType("gauge")&&e.undoMarkOverlapped(e,"."+I.gaugeValue)),e.toggleFocusLegend(n,!1),i.focusedTargetIds=i.focusedTargetIds.filter(function(t){return n.indexOf(t)<0}),i.defocusedTargetIds=n},revert:function(t){var e=this.internal,i=e.config,n=e.state,a=e.$el,t=e.mapToTargetIds(t);a.svg.selectAll(e.selectorTargets(t)).classed(I.focused,!1).classed(I.defocused,!1),e.hasArcType()&&e.unexpandArc(t),i.legend_show&&(e.showLegend(t.filter(e.isLegendToShow.bind(e))),a.legend.selectAll(e.selectorLegends(t)).filter(function(){return(0,D.select)(this).classed(I.legendItemFocused)}).classed(I.legendItemFocused,!1)),n.focusedTargetIds=[],n.defocusedTargetIds=[]}},{legend:{show:function(t){var e=this.internal;e.showLegend(e.mapToTargetIds(t)),e.updateAndRedraw({withLegend:!0})},hide:function(t){var e=this.internal;e.hideLegend(e.mapToTargetIds(t)),e.updateAndRedraw({withLegend:!0})}}},{load:function(e){var t=this.internal,i=t.config;e.xs&&t.addXs(e.xs),"names"in e&&this.data.names(e.names),"classes"in e&&Object.keys(e.classes).forEach(function(t){i.data_classes[t]=e.classes[t]}),"categories"in e&&t.axis.isCategorized()&&(i.axis_x_categories=e.categories),"axes"in e&&Object.keys(e.axes).forEach(function(t){i.data_axes[t]=e.axes[t]}),"colors"in e&&Object.keys(e.colors).forEach(function(t){i.data_colors[t]=e.colors[t]}),"unload"in e&&!1!==e.unload?t.unload(t.mapToTargetIds(!0===e.unload?null:e.unload),function(){p.requestIdleCallback(function(){return t.loadFromArgs(e)})}):t.loadFromArgs(e)},unload:function(t){var e=this,i=this.internal,n=t||{};B(n)?n={ids:n}:w(n)&&(n={ids:[n]});var a=i.mapToTargetIds(n.ids);i.unload(a,function(){i.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),i.cache.remove(a),n.done&&n.done.call(e)})}},{show:function(t,e){ee.call(this,!0,t,e=void 0===e?{}:e)},hide:function(t,e){ee.call(this,!1,t,e=void 0===e?{}:e)},toggle:function(t,e){var i=this;void 0===e&&(e={});var n=this.internal,a={show:[],hide:[]};n.mapToTargetIds(t).forEach(function(t){return a[n.isTargetToShow(t)?"hide":"show"].push(t)}),a.show.length&&this.show(a.show,e),a.hide.length&&setTimeout(function(){return i.hide(a.hide,e)},0)}},{tooltip:{show:function(t){var e,i,n,a,r=this.internal,s=r.config,o=r.state.inputType;t.mouse&&(i=t.mouse),t.data?(n=t.data,a=r.getYScaleById(n.id)(n.value),r.isMultipleX()?i=[r.scale.x(n.x),a]:(s.tooltip_grouped||(i=[0,a]),e=z(n.index)?n.index:r.getIndexByX(n.x))):X(t.x)?e=r.getIndexByX(t.x):X(t.index)&&(e=t.index),("mouse"===o?["mouseover","mousemove"]:["touchstart"]).forEach(function(t){r.dispatchEvent(t,e,i)})},hide:function(){var e,i=this.internal,t=i.state.inputType,n=i.$el.tooltip,n=n&&n.datum();n&&(e=JSON.parse(n.current)[0].index,("mouse"===t?["mouseout"]:["touchend"]).forEach(function(t){i.dispatchEvent(t,e)})),"touch"===t&&i.callOverOutForTouch(),i.hideTooltip(!0),i.hideGridFocus(),i.unexpandCircles&&i.unexpandCircles(),i.expandBarTypeShapes(!1)}}}]);Rt={axis:{labels:function(e){var i,n=this.internal;return e&&(Object.keys(e).forEach(function(t){n.axis.setLabelText(t,e[t])}),n.axis.updateLabels()),["x","y","y2"].forEach(function(t){var e=n.axis.getLabelText(t);e&&((i=!i?{}:i)[t]=e)}),i},min:function(t){var e=this.internal;return z(t)?ne(e,"min",t):ae(e,"min")},max:function(t){var e=this.internal;return arguments.length?ne(e,"max",t):ae(e,"max")},range:function(t){var e=this.axis;if(!arguments.length)return{max:e.max(),min:e.min()};X(t.max)&&e.max(t.max),X(t.min)&&e.min(t.min)}}};function re(t){var e=this.internal,i=e.config;return t&&(i.grid_x_lines=t,e.redrawWithoutRescale()),i.grid_x_lines}W(re,{add:function(t){return this.xgrids(this.internal.config.grid_x_lines.concat(t||[]))},remove:function(t){this.internal.removeGridLines(t,!0)}});Dt={xgrids:re};function se(t){var e=this.internal,i=e.config;return t&&(i.grid_y_lines=t,e.redrawWithoutRescale()),i.grid_y_lines}W(se,{add:function(t){return this.ygrids(this.internal.config.grid_y_lines.concat(t||[]))},remove:function(t){this.internal.removeGridLines(t,!1)}});zt={ygrids:se},Et={groups:function(t){var e=this.internal,i=e.config;return M(t)||(i.data_groups=t,e.redraw()),i.data_groups}};function oe(t){var e=this.internal,i=e.config;return t?(i.regions=t,e.redrawWithoutRescale(),t):i.regions}W(oe,{add:function(t){var e=this.internal,i=e.config;return t&&(i.regions=i.regions.concat(t),e.redrawWithoutRescale()),i.regions},remove:function(t){var e=this.internal,i=e.config,n=t||{},t=A(n,"duration",i.transition_duration),a=A(n,"classes",[I.region]),e=e.$el.main.select("."+I.regions).selectAll(a.map(function(t){return"."+t}));return(t?e.transition().duration(t):e).style("opacity","0").remove(),e=i.regions,Object.keys(n).length?(e=e.filter(function(t){var e=!1;return!t.class||(t.class.split(" ").forEach(function(t){0<=a.indexOf(t)&&(e=!0)}),!e)}),i.regions=e):i.regions=[],e}});function ce(t){return z(t.position)||"end"}function le(t){return"start"===t.position?4:"middle"===t.position?0:-4}var Xt={regions:oe},Ft={x:function(t){var e=this.internal,i=e.axis,n=e.data,i=i.isCustomX()&&i.isCategorized();return B(t)&&(i?this.categories(t):(e.updateTargetX(n.targets,t),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0}))),i?this.categories():n.xs},xs:function(t){var e=this.internal;return N(t)&&(e.updateTargetXs(e.data.targets,t),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),e.data.xs}},Bt={flow:function(t){var e,i,n,a,r,s,o,c,l,u=this.internal,d=0,h=0;(t.json||t.rows||t.columns)&&(l=u.convertData(t)),!u.state.redrawing&&l&&st()&&(a=[],r=u.getMaxDataCount(),s=u.convertDataToTargets(l,!0),o=u.axis.isTimeSeries(),u.data.targets.forEach(function(t){for(var e=!1,i=0;i<s.length;i++)if(t.id===s[i].id){e=!0,t.values[t.values.length-1]&&(h=t.values[t.values.length-1].index+1),d=s[i].values.length;for(var n=0;n<d;n++)s[i].values[n].index=h+n,o||(s[i].values[n].x=h+n);t.values=t.values.concat(s[i].values),s.splice(i,1);break}e||a.push(t.id)}),u.data.targets.forEach(function(t){for(var e=0;e<a.length;e++)if(t.id===a[e]){h=t.values[t.values.length-1].index+1;for(var i=0;i<d;i++)t.values.push({id:t.id,index:h+i,x:o?u.getOtherTargetX(h+i):h+i,value:null})}}),u.data.targets.length&&s.forEach(function(t){for(var e=[],i=u.data.targets[0].values[0].index;i<h;i++)e.push({id:t.id,index:i,x:o?u.getOtherTargetX(i):i,value:null});t.values.forEach(function(t){t.index+=h,o||(t.x+=h)}),t.values=e.concat(t.values)}),u.data.targets=u.data.targets.concat(s),l=(c=u.data.targets[0]).values[0],X(t.to)?(d=0,n=o?rt.call(u,t.to):t.to,c.values.forEach(function(t){t.x<n&&d++})):X(t.length)&&(d=t.length),r?1===r&&o&&(i=(c.values[c.values.length-1].x-l.x)/2,e=[new Date(+l.x-i),new Date(+l.x+i)]):(i=o?1<c.values.length?c.values[c.values.length-1].x-l.x:l.x-u.getXDomain(u.data.targets)[0]:1,e=[l.x-i,l.x]),e&&u.updateXDomain(null,!0,!0,!1,e),u.updateTargets(u.data.targets),u.redraw({flow:{index:l.index,length:d,duration:z(t.duration)?t.duration:u.config.transition_duration,done:t.done,orgDataCount:r},withLegend:!0,withTransition:1<r,withTrimXDomain:!1,withUpdateXAxis:!0}))}},ue=Ri(10),de=function(){function t(t){this.owner=void 0,this.config=void 0,this.scale=void 0;var e=Nt(),i=t.config,n=t.params;this.owner=t,this.config=i,this.scale=e,!i.noTransition&&n.config.transition_duration||(i.withoutTransition=!0),i.range=this.scaleExtent((n.orgXScale||e).range())}t.getSizeFor1Char=function(t){var a={w:5.5,h:11.5};return t.empty()||t.select("text").text("0").call(function(t){try{var e=t.node().getBBox(),i=e.width,n=e.height;i&&n&&(a.w=i,a.h=n)}catch(t){}finally{t.text("")}}),this.getSizeFor1Char=function(){return a},a};var e=t.prototype;return e.getTickTransformSetter=function(t){var e=this.config,i="x"===t?function(t){return"translate("+(t+e.tickOffset)+",0)"}:function(t){return"translate(0,"+t+")"};return function(t,e){t.attr("transform",function(t){return i(Math.ceil(e(t)))})}},e.scaleExtent=function(t){var e=t[0],t=t[t.length-1];return e<t?[e,t]:[t,e]},e.generateTicks=function(t,e){var i=this.owner.params.tickStepSize,n=t.domain(),a=n[0],r=n[1],s=[];if(e&&i)for(var o=a;o<=r;)s.push(o),o+=i;else if(t.ticks){e=this.config.tickArguments;if("log"!==t.type||e)s=t.ticks.apply(t,this.config.tickArguments||[]);else{for(var c=Nt("_log").domain([0<a?a:1,r]).range(t.range()),s=c.ticks(),l=r.toFixed().length;15<s.length;l--)s=c.ticks(l);s.splice(0,1,a),s.splice(s.length-1,1,r)}s=s.map(function(t){return w(t)&&F(t)&&!isNaN(t)&&Math.round(10*t)/10||t})}else{for(var u=Math.ceil(a);u<r;u++)s.push(u);0<s.length&&0<s[0]&&s.unshift(s[0]-(s[1]-s[0]))}return s},e.copyScale=function(){var t=this.scale.copy();return t.domain().length||t.domain(this.scale.domain()),t.type=this.scale.type,t},e.textFormatted=function(t){var e=this.config.tickFormat,t=/\d+\.\d+0{5,}\d$/.test(t)?+(t+"").replace(/0+\d$/,""):t,t=e?e(t):t;return X(t)?t:""},e.transitionise=function(t){var e=this.config,i=t;if(e.withoutTransition)i=t.interrupt();else if(e.transition||!this.owner.params.noTransition)try{i=t.transition(e.transition)}catch(t){}return i},t}(),he=function(){function t(t){void 0===t&&(t={}),this.helper=void 0,this.config=void 0,this.params=void 0,this.g=void 0;var e={innerTickSize:6,outerTickSize:t.outerTick?6:0,orient:"bottom",range:[],tickArguments:null,tickCentered:null,tickCulling:!0,tickFormat:null,tickLength:9,tickOffset:0,tickPadding:3,tickValues:null,transition:null,noTransition:t.noTransition};e.tickLength=Math.max(e.innerTickSize,0)+e.tickPadding,this.config=e,this.params=t,this.helper=new de(this)}var e=t.prototype;return e.create=function(t){var h=this,g=this.config,f=this.helper,p=this.params,x=f.scale,v=g.orient,_=this.splitTickText.bind(this),m=/^(left|right)$/.test(v),y=/^(top|bottom)$/.test(v),b=f.getTickTransformSetter(y?"x":"y"),T=b===f.axisX?"y":"x",w=/^(top|left)$/.test(v)?-1:1,A=p.tickTextRotate;this.config.range=x.rangeExtent?x.rangeExtent():f.scaleExtent((p.orgXScale||x).range());var k,S=g.innerTickSize,C=g.tickLength,E=g.range,e=p.id,R=e&&/^(x|y|y2)$/.test(e)?p.config["axis_"+e+"_tick_text_position"]:{x:0,y:0},i="subX"===e?"subchart_axis_x":"axis_"+e,e=p.config[i+"_show"],L=!!e&&p.config[i+"_tick_show"],O=!!e&&p.config[i+"_tick_text_show"];t.each(function(){var t=(0,D.select)(this),e=this.__chart__||x,i=f.copyScale();k=t,this.__chart__=i,g.tickOffset=p.isCategory?Math.ceil((i(1)-i(0))/2):0;var n,a,r,s,o,c,l,u,d=t.selectAll(".domain").data([0]);d.enter().append("path").attr("class","domain").merge(d).attr("d",function(){var t=g.outerTickSize*w;return y?"M"+E[0]+","+t+"V0H"+E[1]+"V"+t:"M"+t+","+E[0]+"H0V"+E[1]+"H"+t}),(L||O)&&(n=g.tickValues||f.generateTicks(i,m),a=(s=t.selectAll(".tick").data(n,i)).enter().insert("g",".domain").attr("class","tick"),r=s.exit().remove(),s=a.merge(s),L&&a.append("line"),O&&a.append("text"),o=de.getSizeFor1Char(s),c=[],(d=s.select("text").selectAll("tspan").data(function(t,e){t=p.tickMultiline?_(t,i,n,m,o.w):B(f.textFormatted(t))?f.textFormatted(t).concat():[f.textFormatted(t)];return c[e]=t.length,t.map(function(t){return{index:e,splitted:t}})})).exit().remove(),(d=d.enter().append("tspan").merge(d).text(function(t){return t.splitted})).attr("x",y?0:C*w).attr("dx",(t=0,(t=/(top|bottom)/.test(v)&&A?8*Math.sin(Math.PI*(A/180))*("top"===v?-1:1):t)+(R.x||0))).attr("dy",function(t,e){var i=0;return"top"!==v&&(i=o.h,0===e&&(i=m?-((c[t.index]-1)*(o.h/2)-3):0===R.y?".71em":0)),F(i)&&R.y?i+R.y:i||".71em"}),d=s.select("line"),t=s.select("text"),a.select("line").attr(T+"2",S*w),a.select("text").attr(T,C*w),h.setTickLineTextPosition(d,t),p.tickTitle&&((d=t.select("title")).empty()?t.append("title"):d).text(function(t){return p.tickTitle[t]}),i.bandwidth?(u=(l=i).bandwidth()/2,i=e=function(t){return l(t)+u}):e.bandwidth?e=i:b(r,i),b(a,e),b(f.transitionise(s).style("opacity",null),i))}),this.g=k},e.getTickXY=function(){var t=this.config,e={x:0,y:0};return this.params.isCategory&&(e.x=t.tickCentered?0:t.tickOffset,e.y=t.tickCentered?t.tickOffset:0),e},e.getTickSize=function(t){var e=this.helper.scale,i=this.config,n=i.innerTickSize,a=i.range,i=e(t)+(i.tickCentered?0:i.tickOffset);return a[0]<i&&i<a[1]?n:0},e.setTickLineTextPosition=function(t,e){function i(t){var e=["start","end"];return"top"===o&&e.reverse(),t?0<t?e[0]:e[1]:"middle"}function n(t){return t?"rotate("+t+")":null}var a=this.getTickXY(),r=this.config,s=r.innerTickSize,o=r.orient,c=r.tickLength,l=r.tickOffset,u=this.params.tickTextRotate,r=function(t){return t?11.5-2.5*(t/("bottom"===o?15:23))*(0<t?1:-1):c};"bottom"===o?(t.attr("x1",a.x).attr("x2",a.x).attr("y2",this.getTickSize.bind(this)),e.attr("x",0).attr("y",r(u)).style("text-anchor",i(u)).attr("transform",n(u))):"top"===o?(t.attr("x2",0).attr("y2",-s),e.attr("x",0).attr("y",2*-r(u)).style("text-anchor",i(u)).attr("transform",n(u))):"left"===o?(t.attr("x2",-s).attr("y1",a.y).attr("y2",a.y),e.attr("x",-c).attr("y",l).style("text-anchor","end")):"right"===o&&(t.attr("x2",s).attr("y2",0),e.attr("x",c).attr("y",0).style("text-anchor","start"))},e.splitTickText=function(t,e,i,n,s){var a=this.params,r=this.helper.textFormatted(t),t=w(r)&&-1<r.indexOf("\n")?r.split("\n"):[];if(t.length)return t;if(B(r))return r;var o=a.tickWidth;return(!o||o<=0)&&(o=n?95:a.isCategory?Math.ceil(e(i[1])-e(i[0]))-12:110),function t(e,i){for(var n,a,r=1;r<i.length;r++)if(" "===i.charAt(r)&&(n=r),a=i.substr(0,r+1),a=s*a.length,o<a)return t(e.concat(i.substr(0,n||r)),i.slice(n?n+1:r));return e.concat(i)}(t,r+"")},e.scale=function(t){return arguments.length?(this.helper.scale=t,this):this.helper.scale},e.orient=function(t){return arguments.length?(this.config.orient=t in{top:1,right:1,bottom:1,left:1}?t+"":"bottom",this):this.config.orient},e.tickFormat=function(t){var e=this.config;return arguments.length?(e.tickFormat=t,this):e.tickFormat},e.tickCentered=function(t){var e=this.config;return arguments.length?(e.tickCentered=t,this):e.tickCentered},e.tickOffset=function(){return this.config.tickOffset},e.tickInterval=function(t){var e,n=this,i=this.config,a=i.outerTickSize,r=i.tickOffset,i=i.tickValues;return(e=this.params.isCategory?2*r:(e=(this.g.select("path.domain").node().getTotalLength()-2*a)/(t||this.g.selectAll("line").size()),i=i?i.map(function(t,e,i){e+=1;return e<i.length?n.helper.scale(i[e])-n.helper.scale(t):null}).filter(Boolean):[],Math.min.apply(Math,i.concat([e]))))===1/0?0:e},e.ticks=function(){for(var t=this.config,e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.length?(t.tickArguments=Z(i),this):t.tickArguments},e.tickCulling=function(t){var e=this.config;return arguments.length?(e.tickCulling=t,this):e.tickCulling},e.tickValues=function(t){var e=this,i=this.config;if(O(t))i.tickValues=function(){return t(e.helper.scale.domain())};else{if(!arguments.length)return i.tickValues;i.tickValues=t}return this},e.setTransition=function(t){return this.config.transition=t,this},t}(),Yt={getAxisInstance:function(){return this.axis||new ge(this)}},ge=function(){function t(t){this.owner=void 0,this.x=void 0,this.subX=void 0,this.y=void 0,this.y2=void 0,this.axesList={},this.tick={x:null,y:null,y2:null},this.xs=[],this.orient={x:"bottom",y:"left",y2:"right",subX:"bottom"},this.owner=t,this.setOrient()}var e=t.prototype;return e.getAxisClassName=function(t){return I.axis+" "+I["axis"+U(t)]},e.isHorizontal=function(t,e){t=t.config.axis_rotated;return e?t:!t},e.isCategorized=function(){var t=this.owner,e=t.config,t=t.state;return 0<=e.axis_x_type.indexOf("category")||t.hasRadar},e.isCustomX=function(){var t=this.owner.config;return!this.isTimeSeries()&&(t.data_x||$(t.data_xs))},e.isTimeSeries=function(t){return"timeseries"===this.owner.config["axis_"+(t=void 0===t?"x":t)+"_type"]},e.isLog=function(t){return"log"===this.owner.config["axis_"+(t=void 0===t?"x":t)+"_type"]},e.isTimeSeriesY=function(){return this.isTimeSeries("y")},e.getAxisType=function(t){var e="linear";return this.isTimeSeries(t=void 0===t?"x":t)?e=this.owner.config.axis_x_localtime?"time":"utc":this.isLog(t)&&(e="log"),e},e.init=function(){var n=this,a=this.owner,r=a.config,t=a.$el,s=t.main,o=t.axis,c=a.state.clip,l=r.axis_rotated,t=["x","y"];r.axis_y2_show&&t.push("y2"),t.forEach(function(e){var t=n.getAxisClassName(e),i=I["axis"+e.toUpperCase()+"Label"];o[e]=s.append("g").attr("class",t).attr("clip-path",function(){var t=null;return"x"===e?t=c.pathXAxis:"y"===e&&(t=c.pathYAxis),t}).attr("transform",a.getTranslate(e)).style("visibility",r["axis_"+e+"_show"]?null:"hidden"),o[e].append("text").attr("class",i).attr("transform",["rotate(-90)",null]["x"===e?+!l:+l]).style("text-anchor",function(){return n.textAnchorForAxisLabel(e)}),n.generateAxes(e)})},e.setOrient=function(){var t=this.owner.config,e=t.axis_rotated,i=t.axis_y_inner,t=t.axis_y2_inner;this.orient={x:e?"left":"bottom",y:e?i?"top":"bottom":i?"right":"left",y2:e?t?"bottom":"top":t?"left":"right",subX:e?"left":"bottom"}},e.generateAxes=function(n){var a,r=this.owner,t=r.config,s=[],e=t["axis_"+n+"_axes"],t=t.axis_rotated;"x"===n?a=t?ue.axisLeft:ue.axisBottom:"y"===n?a=t?ue.axisBottom:ue.axisLeft:"y2"===n&&(a=t?ue.axisTop:ue.axisRight),e.length&&e.forEach(function(t){var e=t.tick||{},i=r.scale[n].copy();t.domain&&i.domain(t.domain),s.push(a(i).ticks(e.count).tickFormat(O(e.format)?e.format.bind(r.api):function(t){return t}).tickValues(e.values).tickSizeOuter(!1===e.outer?0:6))}),this.axesList[n]=s},e.updateAxes=function(){var l=this,u=this.owner,d=u.config,h=u.$el.main;Object.keys(this.axesList).forEach(function(r){var s=d["axis_"+r+"_axes"],o=u.scale[r].copy(),c=o.range();l.axesList[r].forEach(function(t,e){var i=t.scale().range();c.every(function(t,e){return t===i[e]})||t.scale().range(c);var n=l.getAxisClassName(r)+"-"+(e+1),a=h.select("."+n.replace(/\s/,"."));a.empty()?a=h.append("g").attr("class",n).style("visibility",d["axis_"+r+"_show"]?null:"hidden").call(t):(s[e].domain&&o.domain(s[e].domain),l.x.helper.transitionise(a).call(t.scale(o))),a.attr("transform",u.getTranslate(r,e+1))})})},e.setAxis=function(t,e,i,n){var a=this.owner;"subX"!==t&&(this.tick[t]=this.getTickValues(t)),this[t]=this.getAxis(t,e,i,!("x"!==t||!(a.scale.zoom||a.config.subchart_show||a.state.resizing))||n)},e.getAxis=function(t,e,i,n,a){var r,s=this.owner,o=s.config,c=/^(x|subX)$/.test(t),l=c?"x":t,u=c&&this.isCategorized(),d=this.orient[t],a=a?0:s.getAxisTickRotate(l);c?r=s.format.xAxisTick:(h=o["axis_"+t+"_tick_format"],O(h)&&(r=h.bind(s.api)));var h=this.tick[l],a=Q({outerTick:i,noTransition:n,config:o,id:t,tickTextRotate:a},c&&{isCategory:u,tickMultiline:o.axis_x_tick_multiline,tickWidth:o.axis_x_tick_width,tickTitle:u&&o.axis_x_tick_tooltip&&s.api.categories(),orgXScale:s.scale.x});c||(a.tickStepSize=o["axis_"+l+"_tick_stepSize"]);var g,d=new he(a).scale(c&&s.scale.zoom||e).orient(d);c&&this.isTimeSeries()&&h&&!O(h)?(g=rt.bind(s),h=h.map(function(t){return g(t)})):!c&&this.isTimeSeriesY()&&(d.ticks(o.axis_y_tick_time_value),h=null),h&&d.tickValues(h),d.tickFormat(r||!c&&s.isStackNormalized()&&function(t){return t+"%"}),u&&(d.tickCentered(o.axis_x_tick_centered),T(o.axis_x_tick_culling)&&(o.axis_x_tick_culling=!1));l=o["axis_"+l+"_tick_count"];return l&&d.ticks(l),d},e.updateXAxisTickValues=function(t,e){var i,n=this.owner,a=n.config,r=a.axis_x_tick_fit,a=a.axis_x_tick_count;return(r||a&&r)&&(i=n.mapTargetsToUniqueXs(t),this.isCategorized()&&a>i.length&&(a=i.length),i=this.generateTickValues(i,a,this.isTimeSeries())),e?e.tickValues(i):this.x&&(this.x.tickValues(i),this.subX&&this.subX.tickValues(i)),i},e.getId=function(t){var e=this.owner,i=e.config,e=e.scale,t=i.data_axes[t];return t=!t||!e[t]?"y":t},e.getXAxisTickFormat=function(){var e,i=this.owner,t=i.config,n=i.format,a=t.axis_x_tick_format,t=this.isTimeSeries(),r=this.isCategorized();return a?O(a)?e=a.bind(i.api):t&&(e=function(t){return t?n.axisTime(a)(t):""}):e=t?n.defaultAxisTime:r?i.categoryName:function(t){return t<0?t.toFixed(0):t},O(e)?function(t){return e.apply(i,r?[t,i.categoryName(t)]:[t])}:e},e.getTickValues=function(t){var e=this.owner,i=e.config["axis_"+t+"_tick_values"],t=e[t+"Axis"];return(O(i)?i.call(e.api):i)||(t?t.tickValues():void 0)},e.getLabelOptionByAxisId=function(t){return this.owner.config["axis_"+t+"_label"]},e.getLabelText=function(t){t=this.getLabelOptionByAxisId(t);return w(t)?t:t?t.text:null},e.setLabelText=function(t,e){var i=this.owner.config,n=this.getLabelOptionByAxisId(t);w(n)?i["axis_"+t+"_label"]=e:n&&(n.text=e)},e.getLabelPosition=function(t,e){var i=this.owner.config.axis_rotated,t=this.getLabelOptionByAxisId(t),n=b(t)&&t.position?t.position:e[+!i],i=function(t){return!!~n.indexOf(t)};return{isInner:i("inner"),isOuter:i("outer"),isLeft:i("left"),isCenter:i("center"),isRight:i("right"),isTop:i("top"),isMiddle:i("middle"),isBottom:i("bottom")}},e.getAxisLabelPosition=function(t){return this.getLabelPosition(t,"x"===t?["inner-top","inner-right"]:["inner-right","inner-top"])},e.getLabelPositionById=function(t){return this.getAxisLabelPosition(t)},e.xForAxisLabel=function(t){var e=this.owner,i=e.state,n=i.width,a=i.height,r=this.getAxisLabelPosition(t),i=r.isMiddle?-a/2:0;return this.isHorizontal(e,"x"!==t)?i=r.isLeft?0:r.isCenter?n/2:n:r.isBottom&&(i=-a),i},e.dxForAxisLabel=function(t){var e=this.owner,i=this.getAxisLabelPosition(t),n=i.isBottom?"0.5em":"0";return this.isHorizontal(e,"x"!==t)?n=i.isLeft?"0.5em":i.isRight?"-0.5em":"0":i.isTop&&(n="-0.5em"),n},e.textAnchorForAxisLabel=function(t){var e=this.owner,i=this.getAxisLabelPosition(t),n=i.isMiddle?"middle":"end";return this.isHorizontal(e,"x"!==t)?n=i.isLeft?"start":i.isCenter?"middle":"end":i.isBottom&&(n="start"),n},e.dyForAxisLabel=function(t){var e,i=this.owner,n=i.config,a=n.axis_rotated,r=this.getAxisLabelPosition(t).isInner,s=n["axis_"+t+"_tick_rotate"]?i.getHorizontalAxisHeight(t):0,o=this.getMaxTickWidth(t);return e="x"===t?(i=n.axis_x_height,a?r?"1.2em":-25-o:r?"-0.5em":i?i-10:s?s-10:"3em"):(e={y:["-0.5em",10,"3em","1.2em",10],y2:["1.2em",-20,"-2.2em","-0.5em",15]}[t],a?r?e[0]:s?s*("y2"===t?-1:1)-e[1]:e[2]:r?e[3]:(e[4]+(n["axis_"+t+"_inner"]?0:o+e[4]))*("y"===t?-1:1))},e.getMaxTickWidth=function(t,e){var i=this.owner,n=i.config,a=i.state.current,r=i.$el,s=r.svg,o=r.chart,c=a.maxTickWidths[t],l=0;if(e||!n["axis_"+t+"_show"]||0===i.filterTargetsToShow().length)return c.size;if(s){var u=/^y2?$/.test(t),r=i.filterTargetsToShow(i.data.targets),a=i.scale[t].copy().domain(i["get"+(u?"Y":"X")+"Domain"](r,t)),e=a.domain(),s=e[0]===e[1]&&e.every(function(t){return 0<t}),i=B(c.domain)&&c.domain[0]===c.domain[1]&&c.domain.every(function(t){return 0<t});if(s||i)return c.size;c.domain=e,u||c.ticks.splice(0);i=this.getAxis(t,a,!1,!1,!0),a=n["axis_"+t+"_tick_count"];!n["axis_"+t+"_tick_values"]&&a&&i.tickValues(this.generateTickValues(e,a,u?this.isTimeSeriesY():this.isTimeSeries())),u||this.updateXAxisTickValues(r,i);o=o.append("svg").style("visibility","hidden").style("position","fixed").style("top","0px").style("left","0px");i.create(o),o.selectAll("text").each(function(t,e){var i=this.getBoundingClientRect().width;l=Math.max(l,i),u||(c.ticks[e]=i)}),o.remove()}return 0<l&&(c.size=l),c.size},e.getXAxisTickTextY2Overflow=function(t){var e=this.owner,i=e.axis,n=e.config,a=e.state,r=e.getAxisTickRotate("x");if((i.isCategorized()||i.isTimeSeries())&&n.axis_x_tick_fit&&!n.axis_x_tick_culling&&!n.axis_x_tick_multiline&&0<r&&r<90){e=a.current.width-e.getCurrentPaddingLeft(),r=this.getXAxisTickMaxOverflow(r,e-t),t=Math.max(0,r)+t;return Math.min(t,e/2)}return 0},e.getXAxisTickMaxOverflow=function(t,e){for(var i=this.owner,n=i.axis,a=i.config,r=i.state,s=n.isTimeSeries(),o=r.current.maxTickWidths.x.ticks,c=o.length,n=r.axis.x.padding,l=n.left,u=n.right,d=0,h=c-(s&&a.axis_x_tick_fit?.5:0),g=0;g<c;g++){var f=g+1,p=Math.cos(Math.PI*t/180)*o[g],x=f-(s?1:.5)+l;x<=0||(x=(e-p)/x,d=Math.max(d,p-x/2-((h-f)*x+u*x)))}r=i.filterTargetsToShow(i.data.targets),n=0;return!s&&a.axis_x_tick_count<=r.length&&r[0].values.length&&(i=Nt(i.axis.getAxisType("x"),0,e-d).domain([-1*l,i.getXDomainMax(i.data.targets)+1+u]),n=Math.ceil((i(1)-i(0))/2)),d+n},e.getXAxisPadding=function(t){var e=this.owner,i=e.config.axis_x_padding,n=F(i)?{left:i,right:i}:i,a=n.left,i=void 0===a?0:a,a=n.right,n=void 0===a?0:a;return e.axis.isTimeSeries()&&(a=+e.getXDomainMin(e.data.targets),a=(e=+e.getXDomainMax(e.data.targets)-a)+i+n,t&&a&&(i=i/a/(t=e/t/a),n=n/a/t)),{left:i,right:n}},e.updateLabels=function(i){var n=this,t=this.owner.$el.main,a={x:t.select("."+I.axisX+" ."+I.axisXLabel),y:t.select("."+I.axisY+" ."+I.axisYLabel),y2:t.select("."+I.axisY2+" ."+I.axisY2Label)};Object.keys(a).filter(function(t){return!a[t].empty()}).forEach(function(t){var e=a[t];(i?e.transition():e).attr("x",function(){return n.xForAxisLabel(t)}).attr("dx",function(){return n.dxForAxisLabel(t)}).attr("dy",function(){return n.dyForAxisLabel(t)}).text(function(){return n.getLabelText(t)})})},e.getPadding=function(t,e,i,n){e=F(t)?t:t[e];return z(e)?this.convertPixelsToAxisPadding(e,n):i},e.convertPixelsToAxisPadding=function(t,e){var i=this.owner,n=i.config,a=i.state,i=a.width,a=a.height;return e*(t/(n.axis_rotated?i:a))},e.generateTickValues=function(t,e,i){var n=t;if(e){e=O(e)?e():e;if(1===e)n=[t[0]];else if(2===e)n=[t[0],t[t.length-1]];else if(2<e){for(var a,r=this.isCategorized(),s=e-2,o=t[0],c=t[t.length-1],n=[o],l=0;l<s;l++)a=+o+(c-o)/(1+s)*(l+1),n.push(i?new Date(a):r?Math.round(a):a);n.push(c)}}return n=!i?n.sort(function(t,e){return t-e}):n},e.generateTransitions=function(e){var i=this.owner.$el.axis,t=["x","y","y2","subX"].map(function(t){t=i[t];return t=t&&e?t.transition().duration(e):t});return{axisX:t[0],axisY:t[1],axisY2:t[2],axisSubX:t[3]}},e.redraw=function(n,t,a){var r=this,e=this.owner,s=e.config,o=e.$el,c=t?"0":null;["x","y","y2","subX"].forEach(function(t){var e=r[t],i=o.axis[t];e&&i&&(a||s.transition_duration||(e.config.withoutTransition=!0),i.style("opacity",c),e.create(n["axis"+U(t)]))}),this.updateAxes()},e.redrawAxis=function(a,t,e,i,n){var r,s=this,o=this.owner,c=o.config,l=o.scale,u=o.$el,d=!!l.zoom;!d&&this.isCategorized()&&0===a.length&&l.x.domain([0,u.axis.x.selectAll(".tick").size()]),l.x&&a.length?(d||o.updateXDomain(a,t.UpdateXDomain,t.UpdateOrgXDomain,t.TrimXDomain),c.axis_x_tick_values||this.updateXAxisTickValues(a)):this.x&&(this.x.tickValues([]),this.subX&&this.subX.tickValues([])),c.zoom_rescale&&!i&&(r=l.x.orgDomain()),["y","y2"].forEach(function(t){var e,i,n=l[t];n&&(e=c["axis_"+t+"_tick_values"],i=c["axis_"+t+"_tick_count"],n.domain(o.getYDomain(a,t,r)),!e&&i&&(t=o.axis[t],n=n.domain(),t.tickValues(s.generateTickValues(n,n.every(function(t){return 0===t})?1:i,s.isTimeSeriesY()))))}),this.redraw(e,o.hasArcType(),n),this.updateLabels(t.Transition),(t.UpdateXDomain||t.UpdateXAxis||t.Y)&&a.length&&this.setCulling(),t.Y&&(l.subY&&l.subY.domain(o.getYDomain(a,"y")),l.subY2&&l.subY2.domain(o.getYDomain(a,"y2")))},e.setCulling=function(){var t=this.owner,l=t.config,e=t.state,u=e.clip,d=e.current,h=t.$el;["subX","x","y","y2"].forEach(function(t){var e=h.axis[t],i="subX"===t?"x":t,n=l["axis_"+i+"_tick_culling"];if(e&&n){var a,e=e.selectAll(".tick text"),r=tt(e.data()),s=r.length,o=l["axis_"+i+"_tick_culling_max"];if(s){for(var c=1;c<s;c++)if(s/c<o){a=c;break}e.each(function(t){this.style.display=r.indexOf(t)%a?"none":null})}else e.style("display",null);"x"===t&&(t=d.maxTickWidths.x.clipPath?u.pathXAxisTickTexts:null,h.svg.selectAll("."+I.axisX+" .tick text").attr("clip-path",t))}})},t}(),Vt={initEventRect:function(){this.$el.main.select("."+I.chart).append("g").attr("class",I.eventRects).style("fill-opacity","0")},redrawEventRect:function(){var t=this,e=t.config,i=t.state,n=t.$el,a=t.isMultipleX();n.eventRect?t.updateEventRect(n.eventRect,!0):(e=t.$el.main.select("."+I.eventRects).style("cursor",e.zoom_enabled&&"drag"!==e.zoom_type?e.axis_rotated?"ns-resize":"ew-resize":null).classed(I.eventRectsMultiple,a).classed(I.eventRectsSingle,!a).selectAll("."+I.eventRect).data([0]).enter().append("rect"),t.updateEventRect(e),a?t.generateEventRectsForMultipleXs(e):t.generateEventRectsForSingleX(e),e.call(t.getDraggableSelection()),n.eventRect=e,"touch"!==t.state.inputType||n.svg.on("touchstart.eventRect")||t.hasArcType()||t.bindTouchOnEventRect(a)),a||(a=t.getMaxDataCountTarget(),t.updateDataIndexByX(a),t.updateXs(a),t.updatePointClass&&t.updatePointClass(!0),i.eventReceiver.data=a),t.updateEventRectData()},bindTouchOnEventRect:function(n){function a(){s.unselectRect(),s.callOverOutForTouch()}var r,s=this,o=s.config,c=s.state,t=s.$el,l=t.eventRect,e=t.svg,t=o.interaction_inputType_touch.preventDefault,u=_(t)&&t||!1,d=!isNaN(t)&&t||null;l.on("touchstart",function(t){c.event=t,s.updateEventRect()}).on("touchstart.eventRect touchmove.eventRect",function(t){var e,i;c.event=t,!l.empty()&&l.classed(I.eventRect)?c.dragging||c.flowing||s.hasArcType()||1<t.touches.length||(i=(e=t).type,t=e.changedTouches[0]["client"+(o.axis_rotated?"Y":"X")],"touchstart"===i?u?e.preventDefault():null!==d&&(r=t):"touchmove"===i&&(u||!0===r||null!==d&&Math.abs(r-t)>=d)&&(r=!0,e.preventDefault()),t=l.node(),n?s.selectRectForMultipleXs(t):(e=s.getDataIndexFromEvent(c.event),s.callOverOutForTouch(e),-1===e?s.unselectRect():s.selectRectForSingle(t,l,e))):a()},!0).on("touchend.eventRect",function(t){c.event=t,!l.empty()&&l.classed(I.eventRect)&&(s.hasArcType()||!s.toggleShape||c.cancelClick)&&c.cancelClick&&(c.cancelClick=!1)},!0),e.on("touchstart",function(t){t=(c.event=t).target;t&&t!==l.node()&&a()})},updateEventRect:function(t,e){void 0===e&&(e=!1);var i=this.state,n=this.$el,a=i.eventReceiver,r=i.width,s=i.height,o=i.rendered,i=i.resizing,n=t||n.eventRect;o&&!i&&!e||(n.attr("x",0).attr("y",0).attr("width",r).attr("height",s),o||n.attr("class",I.eventRect)),a&&(a.rect=n.node().getBoundingClientRect())},updateEventRectData:function(){function i(t,e){return O(t)?t(e):t}var n,a,r,s,e,o=this,t=o.config,c=o.scale,l=o.state,u=c.zoom||c.x,d=t.axis_rotated,h=o.isMultipleX()?(a=n=0,r=l.width,l.height):(t=o.axis.isCategorized()?(e=o.getEventRectWidth(),function(t){return u(t.x)-e/2}):(s=function(t){t=t.index;return{prev:o.getPrevX(t),next:o.getNextX(t)}},e=function(t){t=s(t);return null===t.prev&&null===t.next?d?l.height:l.width:(null===t.prev&&(t.prev=u.domain()[0]),null===t.next&&(t.next=u.domain()[1]),Math.max(0,(u(t.next)-u(t.prev))/2))},function(t){var e=s(t),t=t.x;return null===e.prev&&null===e.next?0:(null===e.prev&&(e.prev=u.domain()[0]),(u(t)+u(e.prev))/2)}),n=d?0:t,a=d?t:0,r=d?l.width:e,d?e:l.height),g=l.eventReceiver;g.coords.splice(g.data.length),g.data.forEach(function(t,e){g.coords[e]={x:i(n,t),y:i(a,t),w:i(r,t),h:i(h,t)}})},selectRectForMultipleXs:function(t){var e,i,n=this,a=n.config,r=n.state,s=n.filterTargetsToShow(n.data.targets);r.dragging||n.hasArcType(s)||(e=L(r.event,t),i=n.findClosestFromTargets(s,e),!r.mouseover||i&&i.id===r.mouseover.id||(a.data_onout.call(n.api,r.mouseover),r.mouseover=void 0),i?(s=(n.isBubbleType(i)||n.isScatterType(i)||!a.tooltip_grouped?[i]:n.filterByX(s,i.x)).map(function(t){return n.addName(t)}),n.showTooltip(s,t),n.setExpand(i.index,i.id,!0),n.showGridFocus(s),(n.isBarType(i.id)||n.dist(i,e)<a.point_sensitivity)&&(n.$el.svg.select("."+I.eventRect).style("cursor","pointer"),r.mouseover||(a.data_onover.call(n.api,i),r.mouseover=i))):n.unselectRect())},unselectRect:function(){var t=this.config,e=this.$el,i=e.circle,e=e.tooltip;this.$el.svg.select("."+I.eventRect).style("cursor",null),this.hideGridFocus(),e&&(this.hideTooltip(),this._handleLinkedCharts(!1)),i&&!t.point_focus_only&&this.unexpandCircles(),this.expandBarTypeShapes(!1)},generateEventRectsForSingleX:function(t){var n=this,a=n.config,r=n.state,s=r.eventReceiver,o=t.style("cursor",a.data_selection_enabled&&a.data_selection_grouped?"pointer":null).on("click",function(t){r.event=t;var e=s.currentIdx,e=s.data[-1===e?n.getDataIndexFromEvent(t):e];n.clickHandlerForSingleX.bind(this)(e,n)});return"mouse"===r.inputType&&o.on("mouseover",function(t){r.event=t,n.updateEventRect()}).on("mousemove",function(t){var e,i=function(t){t=t?n.getDataIndexFromEvent(t):s.currentIdx;return-1<t?s.data[t]:null}(t);r.event=t,r.dragging||r.flowing||n.hasArcType()||!i||a.tooltip_grouped&&i&&i.index===s.currentIdx||(e=i.index,n.isStepType(i)&&"step-after"===a.line_step_type&&L(t,this)[0]<n.scale.x(n.getXValue(i.id,e))&&--e,e!==s.currentIdx&&(n.setOverOut(!1,s.currentIdx),s.currentIdx=e),-1===e?n.unselectRect():n.selectRectForSingle(this,o,e),n.setOverOut(-1!==e,e))}).on("mouseout",function(t){r.event=t,!a||n.hasArcType()||-1===s.currentIdx||(n.unselectRect(),n.setOverOut(!1,s.currentIdx),s.currentIdx=-1)}),o},clickHandlerForSingleX:function(t,e){var i,n=e,a=n.config,r=n.state,e=n.$el.main;!t||n.hasArcType()||r.cancelClick?r.cancelClick&&(r.cancelClick=!1):(i=t.index,e.selectAll("."+I.shape+"-"+i).each(function(t){(a.data_selection_grouped||n.isWithinShape(this,t))&&(n.toggleShape&&n.toggleShape(this,t,i),a.data_onclick.bind(n.api)(t,this))}))},generateEventRectsForMultipleXs:function(t){var e=this,i=e.state;t.on("click",function(t){i.event=t,e.clickHandlerForMultipleXS.bind(this)(e)}),"mouse"===i.inputType&&t.on("mouseover mousemove",function(t){i.event=t,e.selectRectForMultipleXs(this)}).on("mouseout",function(t){i.event=t,!e.config||e.hasArcType()||e.unselectRect()})},clickHandlerForMultipleXS:function(t){var e,i=t,n=i.config,a=i.state,t=i.filterTargetsToShow(i.data.targets);i.hasArcType(t)||(a=L(a.event,this),!(e=i.findClosestFromTargets(t,a))||(i.isBarType(e.id)||i.dist(e,a)<n.point_sensitivity)&&i.$el.main.selectAll("."+I.shapes+i.getTargetSelectorSuffix(e.id)).selectAll("."+I.shape+"-"+e.index).each(function(){(n.data_selection_grouped||i.isWithinShape(this,e))&&(i.toggleShape&&i.toggleShape(this,e,e.index),n.data_onclick.bind(i.api)(e,this))}))}},fe=Ri(11),jt={generateFlow:function(t){var i=this,a=i.data,r=i.state,s=i.$el;return function(){var e=t.flow.length;r.flowing=!0,a.targets.forEach(function(t){t.values.splice(0,e)}),i.updateXGrid&&i.updateXGrid(!0);var n={};["axis.x","grid.x","gridLines.x","region.list","text","bar","line","area","circle"].forEach(function(t){var e=t.split("."),i=s[e[0]];(i=i&&1<e.length?i[e[1]]:i)&&i.size()&&(n[t]=i)}),i.hideGridFocus(),i.setFlowList(n,t)}},setFlowList:function(e,t){var i,n=this,a=t.flow,r=t.targets,s=a.duration,o=void 0===s?t.duration:s,c=a.index,s=a.length,a=a.orgDataCount,l=n.getFlowTransform(r,a,c,s),s=Tt();s.add(Object.keys(e).map(function(t){return i=e[t].transition().ease(fe.easeLinear).duration(o),i="axis.x"===t?i.call(function(t){n.axis.x.setTransition(t).create(t)}):("region.list"===t?i.filter(n.isRegionOnX):i).attr("transform",l)})),i.call(s,function(){n.cleanUpFlow(e,t)})},cleanUpFlow:function(i,t){var n=this,a=n.config,r=n.state,s=n.$el.svg,o=a.axis_rotated,e=t.flow,c=t.shape,l=t.xv,t=c.pos,u=t.cx,d=t.cy,h=t.xForText,g=t.yForText,t=e.done,t=void 0===t?function(){}:t,f=e.length;f&&(["circle","text","shape","eventRect"].forEach(function(t){for(var e=[],i=0;i<f;i++)e.push("."+I[t]+"-"+i);s.selectAll("."+I[t+"s"]).selectAll(e).remove()}),s.select("."+I.xgrid).remove()),Object.keys(i).forEach(function(t){var e=i[t];"axis.x"!==t&&e.attr("transform",null),"grid.x"===t?e.attr(r.xgridAttr):"gridLines.x"===t?e.attr("x1",o?0:l).attr("x2",o?r.width:l):"gridLines.x"===t?(e.select("line").attr("x1",o?0:l).attr("x2",o?r.width:l),e.select("text").attr("x",o?r.width:0).attr("y",l)):/^(area|bar|line)$/.test(t)?e.attr("d",c.type[t]):"text"===t?e.attr("x",h).attr("y",g).style("fill-opacity",n.opacityForText.bind(n)):"circle"!==t?"region.list"===t&&e.select("rect").filter(n.isRegionOnX).attr("x",n.regionX.bind(n)).attr("width",n.regionWidth.bind(n)):n.isCirclePoint()?e.attr("cx",u).attr("cy",d):e.attr("x",function(t){return u(t)-a.point_r}).attr("y",function(t){return d(t)-a.point_r}).attr("cx",u).attr("cy",d)}),a.interaction_enabled&&n.redrawEventRect(),t.call(n.api),r.flowing=!1},getFlowTransform:function(t,e,i,n){var a=this.data,r=this.scale.x,s=a.targets[0].values,a=this.getValueOnIndex(s,i),i=this.getValueOnIndex(s,i+n),n=r.domain(),t=this.updateXDomain(t,!0,!0),r=e?1===e||(a&&a.x)===(i&&i.x)||this.axis.isTimeSeries()?r(n[0])-r(t[0]):r(a.x)-r(i.x):1===s.length?this.axis.isTimeSeries()?(a=this.getValueOnIndex(s,0),i=this.getValueOnIndex(s,s.length-1),r(a.x)-r(i.x)):k(t)/2:r(n[0])-r(t[0]);return"translate("+r+",0) scale("+k(n)/k(t)+",1)"}},Ht={initClip:function(){var t=this.state.clip;t.id=this.state.datetimeId+"-clip",t.idXAxis=t.id+"-xaxis",t.idYAxis=t.id+"-yaxis",t.idGrid=t.id+"-grid",t.path=this.getClipPath(t.id),t.pathXAxis=this.getClipPath(t.idXAxis),t.pathYAxis=this.getClipPath(t.idYAxis),t.pathGrid=this.getClipPath(t.idGrid)},getClipPath:function(t){var e=this.config;return!e.clipPath&&/-clip$/.test(t)||!e.axis_x_clipPath&&/-clip-xaxis$/.test(t)||!e.axis_y_clipPath&&/-clip-yaxis$/.test(t)?null:"url("+(!!p.navigator&&0<=p.navigator.appVersion.toLowerCase().indexOf("msie 9.")?"":P.URL.split("#")[0])+"#"+t+")"},appendClip:function(t,e){e&&t.append("clipPath").attr("id",e).append("rect")},setXAxisClipPath:function(t){var e=this.config,i=this.state,n=i.margin,a=i.width,r=i.height,s=e.axis_rotated,o=Math.max(30,n.left)-(s?0:20),i=s?-(1+o):-(o-1),e=-Math.max(15,n.top),o=s?n.left+20:a+10+o,n=(s?n.top+r+10:n.bottom)+20;t.attr("x",i).attr("y",e).attr("width",o).attr("height",n)},setYAxisClipPath:function(t){var e=this.config,i=this.state,n=i.margin,a=i.width,r=i.height,s=e.axis_rotated,o=Math.max(30,n.left)-(s?20:0),i=e.axis_y_inner,e=-(s?20:n.top),a=(s?a+15+o:n.left+20)+(i?20:0),r=(s?n.bottom:n.top+r)+10;t.attr("x",i?-1:s?-(1+o):-(o-1)).attr("y",e).attr("width",a).attr("height",r)},updateXAxisTickClip:function(){var t=this,e=t.config,i=t.state,n=i.clip,a=i.xAxisHeight,r=t.$el.defs,s=t.getHorizontalAxisHeight("x");r&&!n.idXAxisTickTexts&&(i=n.id+"-xaxisticktexts",t.appendClip(r,i),n.pathXAxisTickTexts=t.getClipPath(n.idXAxisTickTexts),n.idXAxisTickTexts=i),!e.axis_x_tick_multiline&&t.getAxisTickRotate("x")&&s!==a&&(t.setXAxisTickClipWidth(),t.setXAxisTickTextClipPathWidth()),t.state.xAxisHeight=s},setXAxisTickClipWidth:function(){var t=this.config,e=this.state.current.maxTickWidths,i=this.getAxisTickRotate("x");!t.axis_x_tick_multiline&&i?(i=Math.sin(Math.PI/180*Math.abs(i)),e.x.clipPath=(this.getHorizontalAxisHeight("x")-20)/i):e.x.clipPath=null},setXAxisTickTextClipPathWidth:function(){var t=this.state,e=t.clip,i=t.current,t=this.$el.svg;t&&t.select("#"+e.idXAxisTickTexts+" rect").attr("width",i.maxTickWidths.x.clipPath).attr("height",30)}};function pe(i,n,a){return function(t){var e=i?0:n;return"start"===t.position?e=i?-a:0:"middle"===t.position&&(e=(i?-a:n)/2),e}}function xe(t,e){"grid"===e&&t.each(function(){var e=(0,D.select)(this);["x1","x2","y1","y2"].forEach(function(t){return e.attr(t,Math.ceil(+e.attr(t)))})})}Ut={hasGrid:function(){var e=this.config;return["x","y"].some(function(t){return e["grid_"+t+"_show"]||e["grid_"+t+"_lines"].length})},initGrid:function(){this.hasGrid()&&this.initGridLines(),this.initFocusGrid()},initGridLines:function(){var t=this.config,e=this.state.clip,i=this.$el;(t.grid_x_lines.length||t.grid_y_lines.length)&&(i.gridLines.main=i.main.insert("g","."+I.chart+(t.grid_lines_front?" + *":"")).attr("clip-path",e.pathGrid).attr("class",I.grid+" "+I.gridLines),i.gridLines.main.append("g").attr("class",I.xgridLines),i.gridLines.main.append("g").attr("class",I.ygridLines),i.gridLines.x=(0,D.selectAll)([]))},updateXGrid:function(t){var e=this.config,i=this.scale,n=this.state,a=this.$el,r=a.main,s=a.grid,o=e.axis_rotated,a=this.generateGridData(e.grid_x_type,i.x),c=this.axis.isCategorized()?this.axis.x.tickOffset():0,e=function(t){return(i.zoom||i.x)(t)+c*(o?-1:1)};n.xgridAttr=o?{x1:0,x2:n.width,y1:e,y2:e}:{x1:e,x2:e,y1:0,y2:n.height},s.x=r.select("."+I.xgrids).selectAll("."+I.xgrid).data(a),s.x.exit().remove(),s.x=s.x.enter().append("line").attr("class",I.xgrid).merge(s.x),t||s.x.each(function(){var e=(0,D.select)(this);Object.keys(n.xgridAttr).forEach(function(t){e.attr(t,n.xgridAttr[t]).style("opacity",function(){return e.attr(o?"y1":"x1")===(o?n.height:0)?"0":null})})})},updateYGrid:function(){var e=this,t=e.config,i=e.state,n=e.$el,a=n.grid,r=n.main,s=t.axis_rotated,n=e.axis.y.tickValues()||e.scale.y.ticks(t.grid_y_ticks),t=function(t){return Math.ceil(e.scale.y(t))};a.y=r.select("."+I.ygrids).selectAll("."+I.ygrid).data(n),a.y.exit().remove(),a.y=a.y.enter().append("line").attr("class",I.ygrid).merge(a.y),a.y.attr("x1",s?t:0).attr("x2",s?t:i.width).attr("y1",s?0:t).attr("y2",s?i.height:t),xe(a.y,"grid")},updateGrid:function(t){var e=this.$el,i=e.grid;e.gridLines.main||this.initGridLines(),i.main.style("visibility",this.hasArcType()?"hidden":null),this.hideGridFocus(),this.updateXGridLines(t),this.updateYGridLines(t)},updateXGridLines:function(t){var e=this.config,i=this.$el,n=i.gridLines,a=i.main,i=e.axis_rotated;e.grid_x_show&&this.updateXGrid();a=a.select("."+I.xgridLines).selectAll("."+I.xgridLine).data(e.grid_x_lines);a.exit().transition().duration(t).style("opacity","0").remove();e=a.enter().append("g");e.append("line").style("opacity","0"),e.append("text").attr("transform",i?"":"rotate(-90)").attr("dy",-5).style("opacity","0"),(a=e.merge(a)).attr("class",function(t){return(I.xgridLine+" "+(t.class||"")).trim()}).select("text").attr("text-anchor",ce).attr("dx",le).transition().duration(t).text(function(t){return t.text}).transition().style("opacity",null),n.x=a},updateYGridLines:function(t){var e=this.config,i=this.state,n=i.width,a=i.height,r=this.$el,s=e.axis_rotated;e.grid_y_show&&this.updateYGrid(),(i=r.main.select("."+I.ygridLines).selectAll("."+I.ygridLine).data(e.grid_y_lines)).exit().transition().duration(t).style("opacity","0").remove();e=i.enter().append("g");e.append("line").style("opacity","0"),e.append("text").attr("transform",s?"rotate(-90)":"").style("opacity","0");i=e.merge(i),e=this.yv.bind(this);i.attr("class",function(t){return(I.ygridLine+" "+(t.class||"")).trim()}).select("line").transition().duration(t).attr("x1",s?e:0).attr("x2",s?e:n).attr("y1",s?0:e).attr("y2",s?a:e).transition().style("opacity",null),i.select("text").attr("text-anchor",ce).attr("dx",le).transition().duration(t).attr("dy",-5).attr("x",pe(s,n,a)).attr("y",e).text(function(t){return t.text}).transition().style("opacity",null),r.gridLines.y=i},redrawGrid:function(t){var e=this.config.axis_rotated,i=this.state,n=i.width,a=i.height,r=this.$el.gridLines,s=this.xv.bind(this),i=r.x.select("line"),r=r.x.select("text"),i=(t?i.transition():i).attr("x1",e?0:s).attr("x2",e?n:s).attr("y1",e?s:0).attr("y2",e?s:a),r=(t?r.transition():r).attr("x",pe(!e,n,a)).attr("y",s).text(function(t){return t.text});return[i.style("opacity",null),r.style("opacity",null)]},initFocusGrid:function(){var t=this.config,e=this.state.clip,i=this.$el,n=t.grid_front,n="."+I[n&&i.gridLines.main?"gridLines":"chart"]+(n?" + *":""),e=i.main.insert("g",n).attr("clip-path",e.pathGrid).attr("class",I.grid);i.grid.main=e,t.grid_x_show&&e.append("g").attr("class",I.xgrids),t.grid_y_show&&e.append("g").attr("class",I.ygrids),t.interaction_enabled&&t.grid_focus_show&&(e.append("g").attr("class",I.xgridFocus).append("line").attr("class",I.xgridFocus),t.grid_focus_y&&!t.tooltip_grouped&&e.append("g").attr("class",I.ygridFocus).append("line").attr("class",I.ygridFocus))},showGridFocus:function(t){var a,r,s=this,e=s.config,i=s.state,o=i.width,c=i.height,l=e.axis_rotated,n=s.$el.main.selectAll("line."+I.xgridFocus+", line."+I.ygridFocus),i=(t||[n.datum()]).filter(function(t){return t&&z(s.getBaseValue(t))});!e.tooltip_show||0===i.length||s.hasType("bubble")||s.hasArcType()||(a=e.grid_focus_edge&&!e.tooltip_grouped,r=s.xx.bind(s),n.style("visibility",null).data(i.concat(i)).each(function(t){var i,n=(0,D.select)(this),e={x:r(t),y:s.getYScaleById(t.id)(t.value)};i=n.classed(I.xgridFocus)?l?[null,e.x,a?e.y:o,e.x]:[e.x,a?e.y:null,e.x,c]:(t="y2"===s.axis.getId(t.id),l?[e.y,a&&!t?e.x:null,e.y,a&&t?e.x:c]:[a&&t?e.x:null,e.y,a&&!t?e.x:o,e.y]),["x1","y1","x2","y2"].forEach(function(t,e){return n.attr(t,i[e])})}),xe(n,"grid"),s.showCircleFocus&&s.showCircleFocus(t))},hideGridFocus:function(){var t=this.state,e=t.inputType,i=t.resizing,t=this.$el.main;"mouse"!==e&&i||(t.selectAll("line."+I.xgridFocus+", line."+I.ygridFocus).style("visibility","hidden"),this.hideCircleFocus&&this.hideCircleFocus())},updateGridFocus:function(){var t=this.state,e=t.inputType,i=t.width,n=t.height,a=t.resizing,t=this.$el.grid.main.select("line."+I.xgridFocus);return"touch"===e?t.empty()?a&&this.showCircleFocus():this.showGridFocus():(a=this.config.axis_rotated,t.attr("x1",a?0:-10).attr("x2",a?i:-10).attr("y1",a?-10:0).attr("y2",a?-10:n)),!0},generateGridData:function(t,e){var i=this.$el.main.select("."+I.axisX).selectAll(".tick").size(),n=[];if("year"===t)for(var a=this.getXDomain(),t=a[0].getFullYear(),r=a[1].getFullYear(),s=t;s<=r;s++)n.push(new Date(s+"-01-01 00:00:00"));else(n=e.ticks(10)).length>i&&(n=n.filter(function(t){return(t+"").indexOf(".")<0}));return n},getGridFilterToRemove:function(t){return t?function(e){var i=!1;return(B(t)?t.concat():[t]).forEach(function(t){("value"in t&&e.value===t.value||"class"in t&&e.class===t.class)&&(i=!0)}),i}:function(){return!0}},removeGridLines:function(t,e){var i=this.config,n=this.getGridFilterToRemove(t),a=e?I.xgridLines:I.ygridLines,t=e?I.xgridLine:I.ygridLine;this.$el.main.select("."+a).selectAll("."+t).filter(n).transition().duration(i.transition_duration).style("opacity","0").remove();e="grid_"+(e?"x":"y")+"_lines";i[e]=i[e].filter(function(t){return!n(t)})}},Zt={initRegion:function(){var t=this.$el;t.region.main=t.main.insert("g",":first-child").attr("clip-path",this.state.clip.path).attr("class",I.regions)},updateRegion:function(t){var e=this.config,i=this.$el.region;i.main||this.initRegion(),i.main.style("visibility",this.hasArcType()?"hidden":null);e=i.main.selectAll("."+I.region).data(e.regions);e.exit().transition().duration(t).style("opacity","0").remove(),(e=e.enter().append("g").merge(e).attr("class",this.classRegion.bind(this))).append("rect").style("fill-opacity","0"),i.list=e},redrawRegion:function(t){var e=this.$el.region.list.select("rect"),e=(t?e.transition():e).attr("x",this.regionX.bind(this)).attr("y",this.regionY.bind(this)).attr("width",this.regionWidth.bind(this)).attr("height",this.regionHeight.bind(this));return[(t?e.transition():e).style("fill-opacity",function(t){return z(t.opacity)?t.opacity:null}).on("end",function(){(0,D.select)(this.parentNode).selectAll("rect:not([x])").remove()})]},getRegionXY:function(t,e){var i=this.config,n=this.scale,a=i.axis_rotated,r="x"===t,i="start",t=0;return"y"===e.axis||"y2"===e.axis?(r||(i="end"),(r?a:!a)&&i in e&&(t=(0,n[e.axis])(e[i]))):(r?!a:a)&&i in e&&(t=(n.zoom||n.x)(this.axis.isTimeSeries()?rt.call(this,e[i]):e[i])),t},regionX:function(t){return this.getRegionXY("x",t)},regionY:function(t){return this.getRegionXY("y",t)},getRegionSize:function(t,e){var i=this.config,n=this.scale,a=this.state,r=i.axis_rotated,s="width"===t,o=this[s?"regionX":"regionY"](e),i="end",t=a[t];return"y"===e.axis||"y2"===e.axis?(s||(i="start"),(s?r:!r)&&i in e&&(t=(0,n[e.axis])(e[i]))):(s?!r:r)&&i in e&&(t=(n.zoom||n.x)(this.axis.isTimeSeries()?rt.call(this,e[i]):e[i])),t<o?0:t-o},regionWidth:function(t){return this.getRegionSize("width",t)},regionHeight:function(t){return this.getRegionSize("height",t)},isRegionOnX:function(t){return!t.axis||"x"===t.axis}},qt={getAxisSize:function(t){var e=this.config.axis_rotated;return e&&"x"===t||!e&&/y2?/.test(t)?this.getAxisWidthByAxisId(t,!0):this.getHorizontalAxisHeight(t)},getAxisWidthByAxisId:function(t,e){if(this.axis){var i=this.axis&&this.axis.getLabelPositionById(t);return this.axis.getMaxTickWidth(t,e)+(i.isInner?20:40)}return 40},getHorizontalAxisHeight:function(t){var e=this.config,i=this.state,n=i.current,a=i.rotatedPadding,r=i.isLegendRight,s=i.isLegendInset,o=e.axis_rotated,i=30;if("x"===t&&!e.axis_x_show)return 8;if("x"===t&&e.axis_x_height)return e.axis_x_height;if("y"===t&&!e.axis_y_show)return!e.legend_show||r||s?1:10;if("y2"===t&&!e.axis_y2_show)return a.top;a=this.getAxisTickRotate(t);return("x"===t&&!o||/y2?/.test(t)&&o)&&a&&(i=30+this.axis.getMaxTickWidth(t)*Math.cos(Math.PI*(90-Math.abs(a))/180),!e.axis_x_tick_multiline&&n.height&&i>n.height/2&&(i=n.height/2)),i+(this.axis.getLabelPositionById(t).isInner?0:10)+("y2"!==t||o?0:-10)},getEventRectWidth:function(){return Math.max(0,this.axis.x.tickInterval())},getAxisTickRotate:function(t){var e,i,n=this.axis,a=this.config,r=this.state,s=this.$el,o=a["axis_"+t+"_tick_rotate"];return"x"===t&&(e=n.isCategorized()||n.isTimeSeries(),a.axis_x_tick_fit&&e&&(i=a.axis_x_tick_count,t=r.current.maxTickWidths.x.ticks.length,n=0,i?n=t<i?t:i:t&&(n=t),n!==r.axis.x.tickCount&&(r.axis.x.padding=this.axis.getXAxisPadding(n)),r.axis.x.tickCount=n),s.svg&&a.axis_x_tick_fit&&!a.axis_x_tick_multiline&&!a.axis_x_tick_culling&&a.axis_x_tick_autorotate&&e&&(o=this.needToRotateXAxisTickTexts()?a.axis_x_tick_rotate:0)),o},needToRotateXAxisTickTexts:function(){var t=this.state,e=t.axis,t=t.current.width-this.getCurrentPaddingLeft(!1)-this.getCurrentPaddingRight(),e=e.x.tickCount+e.x.padding.left+e.x.padding.right;return(e?t/e:0)<this.axis.getMaxTickWidth("x")}},Kt={axis_y_clipPath:!0,axis_y_show:!0,axis_y_type:"indexed",axis_y_max:void 0,axis_y_min:void 0,axis_y_inverted:!1,axis_y_center:void 0,axis_y_inner:!1,axis_y_label:{},axis_y_tick_format:void 0,axis_y_tick_culling:!1,axis_y_tick_culling_max:5,axis_y_tick_outer:!0,axis_y_tick_values:null,axis_y_tick_rotate:0,axis_y_tick_count:void 0,axis_y_tick_show:!0,axis_y_tick_stepSize:null,axis_y_tick_text_show:!0,axis_y_tick_text_position:{x:0,y:0},axis_y_tick_time_value:void 0,axis_y_padding:{},axis_y_default:void 0,axis_y_axes:[]},St={axis_y2_show:!1,axis_y2_type:"indexed",axis_y2_max:void 0,axis_y2_min:void 0,axis_y2_inverted:!1,axis_y2_center:void 0,axis_y2_inner:!1,axis_y2_label:{},axis_y2_tick_format:void 0,axis_y2_tick_culling:!1,axis_y2_tick_culling_max:5,axis_y2_tick_outer:!0,axis_y2_tick_values:null,axis_y2_tick_rotate:0,axis_y2_tick_count:void 0,axis_y2_tick_show:!0,axis_y2_tick_stepSize:null,axis_y2_tick_text_show:!0,axis_y2_tick_text_position:{x:0,y:0},axis_y2_padding:{},axis_y2_default:void 0,axis_y2_axes:[]};function ve(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}function _e(e){for(var i,t=1;t<arguments.length;t++)i=null==arguments[t]?{}:arguments[t],t%2?ve(Object(i),!0).forEach(function(t){r(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ve(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))});return e}var St=_e(_e(_e({axis_rotated:!1},{axis_x_clipPath:!0,axis_x_show:!0,axis_x_type:"indexed",axis_x_localtime:!0,axis_x_categories:[],axis_x_tick_centered:!1,axis_x_tick_format:void 0,axis_x_tick_culling:{},axis_x_tick_culling_max:10,axis_x_tick_count:void 0,axis_x_tick_show:!0,axis_x_tick_text_show:!0,axis_x_tick_text_position:{x:0,y:0},axis_x_tick_fit:!0,axis_x_tick_values:null,axis_x_tick_autorotate:!1,axis_x_tick_rotate:0,axis_x_tick_outer:!0,axis_x_tick_multiline:!0,axis_x_tick_width:null,axis_x_tick_tooltip:!1,axis_x_max:void 0,axis_x_min:void 0,axis_x_padding:{},axis_x_height:void 0,axis_x_extent:void 0,axis_x_label:{},axis_x_axes:[]}),Kt),St),me=[Rt,{category:function(t,e){var i=this.internal,n=i.config;return 1<arguments.length&&(n.axis_x_categories[t]=e,i.redraw()),n.axis_x_categories[t]},categories:function(t){var e=this.internal,i=e.config;return arguments.length&&(i.axis_x_categories=t,e.redraw()),i.axis_x_categories}},Dt,zt,Bt,Et,Xt,Ft],ye=[Yt,Ht,Vt,jt,Ut,Zt,qt],be=[{data_xs:{},data_xFormat:"%Y-%m-%d",data_xLocaltime:!0,data_xSort:!0,data_axes:{},data_regions:{},data_stack_normalize:!1},St,{grid_x_show:!1,grid_x_type:"tick",grid_x_lines:[],grid_y_show:!1,grid_y_lines:[],grid_y_ticks:10,grid_focus_edge:!1,grid_focus_show:!0,grid_focus_y:!1,grid_front:!1,grid_lines_front:!0}],Te=Ri(12),we={initPie:function(){var t=this.config,e=t.data_type,i=t.pie_padding,n=t[e+"_startingAngle"]||0,e=(this.hasType("pie")&&i?.01*i:t[e+"_padAngle"])||0;this.pie=(0,Gt.pie)().startAngle(n).endAngle(n+2*Math.PI).padAngle(e).value(function(t){return t.values.reduce(function(t,e){return t+e.value},0)}).sort(this.getSortCompareFn.bind(this)(!0))},updateRadius:function(){var t=this.config,e=this.state,i=t.pie_padding,n=t.gauge_width||t.donut_width,a=this.filterTargetsToShow(this.data.targets).length*t.gauge_arcs_minWidth;e.radiusExpanded=Math.min(e.arcWidth,e.arcHeight)/2*(this.hasMultiArcGauge()?.85:1),e.radius=.95*e.radiusExpanded,e.innerRadiusRatio=n?(e.radius-n)/e.radius:.6,e.gaugeArcWidth=n||(a<=e.radius-e.innerRadius?e.radius-e.innerRadius:a<=e.radius?a:e.radius);i=t.pie_innerRadius||(i?i*(e.innerRadiusRatio+.1):0);e.outerRadius=t.pie_outerRadius,e.innerRadius=this.hasType("donut")||this.hasType("gauge")?e.radius*e.innerRadiusRatio:i},getRadius:function(t){var e=t&&t.data,i=this.state,t=i.innerRadius,i=i.outerRadius;return!F(t)&&e&&(t=t[e.id]||0),N(i)&&e&&e.id in i?i=i[e.id]:F(i)||(i=this.state.radius),{innerRadius:t,outerRadius:i}},updateArc:function(){this.updateRadius(),this.svgArc=this.getSvgArc(),this.svgArcExpanded=this.getSvgArcExpanded()},getArcLength:function(){var t=3.6*this.config.gauge_arcLength,e=t/360*2;return t<-360?e=-2:360<t&&(e=2),e*Math.PI},getStartAngle:function(){var t=this.config,e=t.gauge_fullCircle,i=-1*Math.PI/2,n=Math.PI/2,t=t.gauge_startingAngle;return!e&&t<=i?t=i:!e&&n<=t?t=n:(t>Math.PI||t<-1*Math.PI)&&(t=Math.PI),t},updateAngle:function(t){var e=this,i=e.config,n=e.state,a=e.pie,r=t,s=!1;if(!i)return null;var o,c=e.getStartAngle(),l=i.gauge_fullCircle?e.getArcLength():-2*c;return r.data&&e.isGaugeType(r.data)&&!e.hasMultiArcGauge()&&(o=i.gauge_min,t=i.gauge_max,n=e.getTotalDataSum(n.rendered),a=a.startAngle(c).endAngle(l*((n-o)/(t-o))+c)),a(e.filterTargetsToShow()).forEach(function(t,e){s||t.data.id!==r.data.id||(s=!0,(r=t).index=e)}),isNaN(r.startAngle)&&(r.startAngle=0),isNaN(r.endAngle)&&(r.endAngle=r.startAngle),r.data&&e.hasMultiArcGauge()&&(a=i.gauge_min,e=i.gauge_max,i=r.value<a?0:r.value<e?r.value-a:e-a,r.startAngle=c,r.endAngle=c+l/(e-a)*i),s?r:null},getSvgArc:function(){function t(t,e){var i,n="M 0 0";return(t.value||t.data)&&(i=!e&&a.updateAngle(t),e?n=s(t):i&&(n=s(i))),n}var a=this,i=a.state,n=i.gaugeArcWidth/a.filterTargetsToShow(a.data.targets).length,r=a.hasMultiArcGauge(),s=(0,Gt.arc)().innerRadius(function(t){var e=a.getRadius(t).innerRadius;return r?i.radius-n*(t.index+1):F(e)?e:0}).outerRadius(function(t){var e=a.getRadius(t).outerRadius;return r?i.radius-n*t.index:e});return t.centroid=s.centroid,t},getSvgArcExpanded:function(t){var i=this,n=i.state,a=t||1,r=n.gaugeArcWidth/i.filterTargetsToShow(i.data.targets).length,s=i.hasMultiArcGauge(),o=Math.min(n.radiusExpanded*a-n.radius,.8*r-100*(1-a)),e=(0,Gt.arc)().innerRadius(function(t){return s?n.radius-r*(t.index+1):i.getRadius(t).innerRadius}).outerRadius(function(t){var e=s?n.radius-r*t.index+o:(t=i.getRadius(t).outerRadius,e=n.radiusExpanded,n.radius!==t&&(e-=Math.abs(n.radius-t)),e*a);return e});return function(t){t=i.updateAngle(t);return t?e(t):"M 0 0"}},getArc:function(t,e,i){return i||this.isArcType(t.data)?this.svgArc(t,e):"M 0 0"},transformForArcLabel:function(t){var e,i,n,a=this,r=a.config,s=a.state.radiusExpanded,o=a.updateAngle(t),c="";return o&&(a.hasMultiArcGauge()?(e=Math.sin(o.endAngle-Math.PI/2),c="translate("+(i=Math.cos(o.endAngle-Math.PI/2)*(s+25))+","+(n=e*(s+15-Math.abs(10*e))+3)+")"):(!a.hasType("gauge")||1<a.data.targets.length)&&(e=a.getRadius(t).outerRadius,o=this.svgArc.centroid(o),i=isNaN(o[0])?0:o[0],n=isNaN(o[1])?0:o[1],o=Math.sqrt(i*i+n*n),c="translate("+i*(r=(r=a.hasType("donut")&&r.donut_label_ratio||a.hasType("pie")&&r.pie_label_ratio)?O(r)?r.bind(a.api)(t,e,o):r:e&&(o?(.375<36/e?1.175-36/e:.8)*e/o:0))+","+n*r+")")),c},convertToArcData:function(t){return this.addName({id:(t.data||t).id,value:t.value,ratio:this.getRatio("arc",t),index:t.index})},textForArcLabel:function(t){var a=this,r=a.hasType("gauge");a.shouldShowArcLabel()&&t.style("fill",a.updateTextColor.bind(a)).attr("filter",a.updateTextBacgroundColor.bind(a)).each(function(t){var e=(0,D.select)(this),i=a.updateAngle(t),n=a.getRatio("arc",i);a.meetsLabelThreshold(n,(a.hasType("donut")?"donut":a.hasType("gauge")&&"gauge")||a.hasType("pie")&&"pie")?(i=(i||t).value,E(e,(a.getArcLabelFormat()||a.defaultArcValueFormat)(i,n,t.data.id).toString(),[-1,1],r)):e.text("")})},expandArc:function(t){var e,i,n=this,a=n.state.transiting,r=n.$el;a?e=setInterval(function(){a||(clearInterval(e),0<r.legend.selectAll("."+I.legendItemFocused).size()&&n.expandArc(t))},10):(i=n.mapToTargetIds(t),r.svg.selectAll(n.selectorTargets(i,"."+I.chartArc)).each(function(t){var e;n.shouldExpand(t.data.id)&&(e=n.getExpandConfig(t.data.id,"duration"),t=n.getSvgArcExpanded(n.getExpandConfig(t.data.id,"rate")),(0,D.select)(this).selectAll("path").transition().duration(e).attr("d",n.svgArcExpanded).transition().duration(2*e).attr("d",t))}))},unexpandArc:function(t){var e=this,i=e.state.transiting,n=e.$el.svg;i||(t=e.mapToTargetIds(t),n.selectAll(e.selectorTargets(t,"."+I.chartArc)).selectAll("path").transition().duration(function(t){return e.getExpandConfig(t.data.id,"duration")}).attr("d",e.svgArc),n.selectAll(""+I.arc).style("opacity",null))},getExpandConfig:function(t,e){var i,n=this.config;return this.isDonutType(t)?i="donut":this.isGaugeType(t)?i="gauge":this.isPieType(t)&&(i="pie"),i?n[i+"_expand_"+e]:{duration:50,rate:.98}[e]},shouldExpand:function(t){var e=this.config;return this.isDonutType(t)&&e.donut_expand||this.isGaugeType(t)&&e.gauge_expand||this.isPieType(t)&&e.pie_expand},shouldShowArcLabel:function(){var e=this,i=e.config;return["pie","donut","gauge"].some(function(t){return e.hasType(t)&&i[t+"_label_show"]})},getArcLabelFormat:function(){var t=this.config,e=t.pie_label_format;return this.hasType("gauge")?e=t.gauge_label_format:this.hasType("donut")&&(e=t.donut_label_format),O(e)?e.bind(this.api):e},getArcTitle:function(){var t=this.hasType("donut")?"donut":this.hasType("gauge")&&"gauge";return t?this.config[t+"_title"]:""},updateTargetsForArc:function(t){var e=this.$el,i=this.hasType("gauge"),n=this.getChartClass("Arc"),a=this.getClass("arcs",!0),r=this.classFocus.bind(this),s=e.main.select("."+I.chartArcs),o=s.selectAll("."+I.chartArc).data(this.pie(t)).attr("class",function(t){return n(t)+r(t.data)}),t=o.enter().append("g").attr("class",n);t.append("g").attr("class",a).merge(o),t.append("text").attr("dy",i&&!this.hasMultiTargets()?"-.1em":".35em").style("opacity","0").style("text-anchor","middle").style("pointer-events","none"),e.text=s.selectAll("."+I.target+" text")},initArc:function(){var t=this.$el;t.arcs=t.main.select("."+I.chart).append("g").attr("class",I.chartArcs).attr("transform",this.getTranslate("arc")),this.setArcTitle()},setArcTitle:function(){var t,e=this.getArcTitle(),i=this.hasType("gauge");e&&(t=this.$el.arcs.append("text").attr("class",I[i?"chartArcsGaugeTitle":"chartArcsTitle"]).style("text-anchor","middle"),i&&t.attr("dy","-0.3em").style("font-size","27px"),E(t,e,i?void 0:[-.6,1.35],!0))},redrawArc:function(t,e,i){var n=this,a=n.config,r=n.state,s=n.$el.main,o=a.interaction_enabled,c=o&&a.data_selection_isselectable,s=s.selectAll("."+I.arcs).selectAll("."+I.arc).data(n.arcData.bind(n));s.exit().transition().duration(e).style("opacity","0").remove(),s=s.enter().append("path").attr("class",n.getClass("arc",!0)).style("fill",function(t){return n.color(t.data)}).style("cursor",function(t){return c&&c.bind(n.api)(t)?"pointer":null}).style("opacity","0").each(function(t){n.isGaugeType(t.data)&&(t.startAngle=a.gauge_startingAngle,t.endAngle=a.gauge_startingAngle),this._current=t}).merge(s),n.hasType("gauge")&&(n.updateGaugeMax(),n.hasMultiArcGauge()&&n.redrawMultiArcGauge()),s.attr("transform",function(t){return!n.isGaugeType(t.data)&&i?"scale(0)":""}).style("opacity",function(t){return t===this._current?"0":null}).each(function(){r.transiting=!0}).transition().duration(t).attrTween("d",function(e){var t=n.updateAngle(e);if(!t)return function(){return"M 0 0"};isNaN(this._current.startAngle)&&(this._current.startAngle=0),isNaN(this._current.endAngle)&&(this._current.endAngle=this._current.startAngle);var i=(0,Te.interpolate)(this._current,t);return this._current=i(0),function(t){t=i(t);return t.data=e.data,n.getArc(t,!0)}}).attr("transform",i?"scale(1)":"").style("fill",function(t){var e;return n.levelColor?(e=n.levelColor(t.data.values[0].value),a.data_colors[t.data.id]=e):e=n.color(t.data),e}).style("opacity",null).call(C,function(){var t,e;n.levelColor&&(e=(t=(0,D.select)(this)).datum(),n.updateLegendItemColor(e.data.id,t.style("fill"))),r.transiting=!1,S(a.onrendered,n.api)}),o&&n.bindArcEvent(s),n.hasType("gauge")&&n.redrawBackgroundArcs(),n.redrawArcText(t)},redrawBackgroundArcs:function(){var e,i=this,n=i.config,a=i.state,t=i.hasMultiArcGauge(),r=n.gauge_fullCircle,s=i.getStartAngle(),o=r?s+i.getArcLength():-1*s,r=i.$el.arcs.select((t?"g":"")+"."+I.chartArcsBackground);t?(e=0,(r=r.selectAll("path."+I.chartArcsBackground).data(i.data.targets)).enter().append("path").attr("class",function(t,e){return I.chartArcsBackground+" "+I.chartArcsBackground+"-"+e}).merge(r).style("fill",n.gauge_background||null).attr("d",function(t){t=t.id;if(0<=a.hiddenTargetIds.indexOf(t))return"M 0 0";t={data:[{value:n.gauge_max}],startAngle:s,endAngle:o,index:e++};return i.getArc(t,!0,!0)}),r.exit().remove()):r.attr("d",function(){var t={data:[{value:n.gauge_max}],startAngle:s,endAngle:o};return i.getArc(t,!0,!0)})},bindArcEvent:function(t){function i(t,e,i){a.expandArc(i),a.api.focus(i),a.toggleFocusLegend(i,!0),a.showTooltip([e],t)}function n(t){t=t&&t.id||void 0;a.unexpandArc(t),a.api.revert(),a.revertLegend(),a.hideTooltip()}var a=this,r=a.config,s=a.state,e="touch"===s.inputType,o="mouse"===s.inputType;t.on("click",function(t,e,i){var e=a.updateAngle(e);e&&(e=a.convertToArcData(e),a.toggleShape&&a.toggleShape(this,e,i),r.data_onclick.bind(a.api)(e,this))}),o&&t.on("mouseover",function(t,e){s.transiting||(s.event=t,i(this,e=(e=a.updateAngle(e))?a.convertToArcData(e):null,e&&e.id||void 0),a.setOverOut(!0,e))}).on("mouseout",function(t,e){s.transiting||(s.event=t,e=(e=a.updateAngle(e))?a.convertToArcData(e):null,n(),a.setOverOut(!1,e))}).on("mousemove",function(t,e){e=a.updateAngle(e),e=e?a.convertToArcData(e):null;s.event=t,a.showTooltip([e],this)}),e&&a.hasArcType()&&!a.radars&&a.$el.svg.on("touchstart touchmove",function(t){var e;s.transiting||(t=(e=(t=(e=function(t){t=t.changedTouches[0];return(0,D.select)(P.elementFromPoint(t.clientX,t.clientY))}(t).datum())&&e.data&&e.data.id?a.updateAngle(e):null)?a.convertToArcData(t):null)&&e.id||void 0,a.callOverOutForTouch(e),M(t)?n():i(this,e,t))})},redrawArcText:function(t){var e,i=this,n=i.config,a=i.state,r=i.$el,s=r.main,o=r.arcs,r=i.hasType("gauge"),c=i.hasMultiArcGauge();r&&1===i.data.targets.length&&n.gauge_title||(e=s.selectAll("."+I.chartArc).select("text").style("opacity","0").attr("class",function(t){return i.isGaugeType(t.data)?I.gaugeValue:null}).call(i.textForArcLabel.bind(i)).attr("transform",i.transformForArcLabel.bind(i)).style("font-size",function(t){return i.isGaugeType(t.data)&&1===i.data.targets.length&&!c?Math.round(a.radius/5)+"px":null}).transition().duration(t).style("opacity",function(t){return i.isTargetToShow(t.data.id)&&i.isArcType(t.data)?null:"0"}),c&&e.attr("dy","-.1em")),s.select("."+I.chartArcsTitle).style("opacity",i.hasType("donut")||r?null:"0"),r&&((r=n.gauge_fullCircle)&&e&&e.attr("dy",""+(c?0:Math.round(a.radius/14))),n.gauge_label_show&&(o.select("."+I.chartArcsGaugeUnit).attr("dy",(r?1.5:.75)+"em").text(n.gauge_units),o.select("."+I.chartArcsGaugeMin).attr("dx",-1*(a.innerRadius+(a.radius-a.innerRadius)/(r?1:2))+"px").attr("dy","1.2em").text(i.textForGaugeMinMax(n.gauge_min,!1)),r||o.select("."+I.chartArcsGaugeMax).attr("dx",a.innerRadius+(a.radius-a.innerRadius)/2+"px").attr("dy","1.2em").text(i.textForGaugeMinMax(n.gauge_max,!0))))}},Ae={initArea:function(t){var e=this.config;t.insert("g","."+I[e.area_front?"circles":"lines"]).attr("class",this.getClass("areas",!0))},updateAreaGradient:function(){var o=this,c=o.config,l=o.state.datetimeId,u=o.$el.defs;o.data.targets.forEach(function(i){var n,t,e,a,r,s=l+"-areaGradient"+o.getTargetSelectorSuffix(i.id);o.isAreaType(i)&&u.select("#"+s).empty()&&(n=o.color(i),t=void 0===(e=(a=c.area_linearGradient).x)?[0,0]:e,e=void 0===(e=a.y)?[0,1]:e,a=void 0===(a=a.stops)?[[0,n,1],[1,n,0]]:a,r=u.append("linearGradient").attr("id",s).attr("x1",t[0]).attr("x2",t[1]).attr("y1",e[0]).attr("y2",e[1]),a.forEach(function(t){var e=O(t[1])?t[1].bind(o.api)(i.id):t[1];r.append("stop").attr("offset",t[0]).attr("stop-color",e||n).attr("stop-opacity",t[2])}))})},updateAreaColor:function(t){return this.config.area_linearGradient?"url(#"+this.state.datetimeId+"-areaGradient"+this.getTargetSelectorSuffix(t.id)+")":this.color(t)},updateArea:function(t,e){var i=this.config,n=this.state,a=this.$el,a=(e=void 0===e?!1:e)?a.subchart:a;i.area_linearGradient&&this.updateAreaGradient();i=a.main.selectAll("."+I.areas).selectAll("."+I.area).data(this.lineData.bind(this));i.exit().transition().duration(t).style("opacity","0").remove(),a.area=i.enter().append("path").attr("class",this.getClass("area",!0)).style("fill",this.updateAreaColor.bind(this)).style("opacity",function(){return n.orgAreaOpacity=(0,D.select)(this).style("opacity"),"0"}).merge(i),i.style("opacity",n.orgAreaOpacity)},redrawArea:function(t,e,i){var n=this,i=((i=void 0===i?!1:i)?this.$el.subchart:this.$el).area,a=n.state.orgAreaOpacity;return[(e?i.transition(j()):i).attr("d",t).style("fill",n.updateAreaColor.bind(n)).style("opacity",function(t){return(n.isAreaRangeType(t)?a/1.75:a)+""})]},generateDrawArea:function(t,i){function r(t){return(i?c.subxx:c.xx).call(c,t)}function s(t,e){return c.isGrouped(t.id)?n(t,e)[0][1]:a(t.id,i)(c.isAreaRangeType(t)?c.getRangedData(t,"high"):c.getShapeYMin(t.id))}function o(t,e){return c.isGrouped(t.id)?n(t,e)[1][1]:a(t.id,i)(c.isAreaRangeType(t)?c.getRangedData(t,"low"):t.value)}var c=this,l=c.config,u=l.line_connectNull,d=l.axis_rotated,n=c.generateGetAreaPoints(t,i),a=c.getYScaleById.bind(c);return function(t){var e,i=u?c.filterRemoveNull(t.values):t.values,n=0,a=0,a=c.isAreaType(t)?(e=(0,Gt.area)(),e=d?e.y(r).x0(s).x1(o):e.x(r).y0(l.area_above?0:s).y1(o),u||(e=e.defined(function(t){return null!==c.getBaseValue(t)})),c.isStepType(t)&&(i=c.convertValuesToStep(i)),e.curve(c.getCurve(t))(i)):(i[0]&&(n=c.scale.x(i[0].x),a=c.getYScaleById(t.id)(i[0].value)),d?"M "+a+" "+n:"M "+n+" "+a);return a||"M 0 0"}},generateGetAreaPoints:function(t,r){var s=this,o=s.config,c=s.getShapeX(0,t,r),l=s.getShapeY(!!r),u=s.getShapeOffset(s.isAreaType,t,r),d=s.getYScaleById.bind(s);return function(t,e){var i=d.call(s,t.id,r)(s.getShapeYMin(t.id)),n=u(t,e)||i,a=c(t),e=l(t);return[[a,n],[a,(e=o.axis_rotated&&(0<t.value&&e<i||t.value<0&&i<e)?i:e)-(i-n)],[a,e-(i-n)],[a,n]]}}},ke={initBar:function(){var t=this.$el;t.bar=t.main.select("."+I.chart).insert("g",":first-child").attr("class",I.chartBars)},updateTargetsForBar:function(t){var e=this,i=e.config,n=e.$el,a=e.getChartClass("Bar"),r=e.getClass("bars",!0),s=e.classFocus.bind(e),o=i.interaction_enabled&&i.data_selection_isselectable;n.bar||e.initBar(),e.$el.main.select("."+I.chartBars).selectAll("."+I.chartBar).data(t.filter(function(t){return!t.values.every(function(t){return!F(t.value)})})).attr("class",function(t){return a(t)+s(t)}).enter().append("g").attr("class",a).style("opacity","0").style("pointer-events","none").append("g").attr("class",r).style("cursor",function(t){return o&&o.bind(e.api)(t)?"pointer":null})},updateBar:function(t,e){var i=(e=void 0===e?!1:e)?this.$el.subchart:this.$el,n=this.getClass("bar",!0),a=this.initialOpacity.bind(this),e=i.main.selectAll("."+I.bars).selectAll("."+I.bar).data(this.labelishData.bind(this));e.exit().transition().duration(t).style("opacity","0").remove(),i.bar=e.enter().append("path").attr("class",n).style("fill",this.color).merge(e).style("opacity",a)},redrawBar:function(e,t,i){i=((i=void 0===i?!1:i)?this.$el.subchart:this.$el).bar;return[(t?i.transition(j()):i).attr("d",function(t){return t.value&&e(t)}).style("fill",this.color).style("opacity",null)]},generateDrawBar:function(t,e){var i=this.config,o=this.generateGetBarPoints(t,e),c=i.axis_rotated,l=i.data_groups.length,n=i.bar_radius,a=i.bar_radius_ratio,u=F(n)&&0<n?function(){return n}:F(a)?function(t){return t*a}:null;return function(t,e){var i=o(t,e),n=+c,a=+!n,r=t.value<0,s=["",""],e=0;u&&!l&&(t=i[2][t=c?a:n]-i[0][t],t="a"+(e=u(t))+","+e+" "+(r?"1 0 0":"0 0 1")+" ",s[+!c]=t+e+","+e,s[+c]=t+[-e,e][c?"sort":"reverse"](),r&&s.reverse());s=c?"H"+(i[1][n]-e)+" "+s[0]+"V"+(i[2][a]-e)+" "+s[1]+"H"+i[3][n]:"V"+(i[1][a]+(r?-e:e))+" "+s[0]+"H"+(i[2][n]-e)+" "+s[1]+"V"+i[3][a];return"M"+i[0][n]+","+i[0][a]+s+"z"}},generateGetBarPoints:function(t,s){var o=this,c=o.config,e=s?o.axis.subX:o.axis.x,i=o.getIndicesMax(t)+1,l=o.getBarW("bar",e,i),u=o.getShapeX(l,t,!!s),d=o.getShapeY(!!s),h=o.getShapeOffset(o.isBarType,t,!!s),g=o.getYScaleById.bind(o);return function(t,e){var i=g.call(o,t.id,s)(o.getShapeYMin(t.id)),n=h(t,e)||i,a=F(l)?l:l[t.id]||l._$width,r=u(t),e=d(t);c.axis_rotated&&(0<t.value&&e<i||t.value<0&&i<e)&&(e=i);a=r+a;return[[r,n],[r,e-=i-n],[a,e],[a,n]]}},isWithinBar:function(t){var e=L(this.state.event,t),i=R(t),n=i[0],a=i[1],r=Math.min(n.x,a.x),i=Math.min(n.y,a.y),n=this.config.bar_sensitivity,a=t.getBBox(),t=a.width,a=a.height;return r-n<e[0]&&e[0]<r+t+n&&i-n<e[1]&&e[1]<i+a+n}};function Se(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}var Ce={initCandlestick:function(){var t=this.$el;t.candlestick=t.main.select("."+I.chart).append("g").attr("class",I.chartCandlesticks)},updateTargetsForCandlestick:function(t){var e=this.$el,i=this.getChartClass("Candlestick"),n=this.classFocus.bind(this);e.candlestick||this.initCandlestick(),this.$el.main.select("."+I.chartCandlesticks).selectAll("."+I.chartCandlestick).data(t).attr("class",function(t){return i(t)+n(t)}).enter().append("g").attr("class",i).style("pointer-events","none")},updateCandlestick:function(t,e){var i=this.$el,n=(e=void 0===e?!1:e)?i.subchart:i,a=this.getClass("candlestick",!0),e=this.initialOpacity.bind(this),i=n.main.selectAll("."+I.chartCandlestick).selectAll("."+I.candlestick).data(this.labelishData.bind(this));i.exit().transition().duration(t).style("opacity","0").remove();a=i.enter().filter(function(t){return t.value}).append("g").attr("class",a);a.append("line"),a.append("path"),n.candlestick||(n.candlestick={}),n.candlestick=i.merge(a).style("opacity",e)},generateDrawCandlestick:function(t,e){var c=this,i=c.config,l=c.generateGetCandlestickPoints(t,e),u=i.axis_rotated,d=i.candlestick_color_down;return function(t,e,i){var n=l(t,e),e=c.getCandlestickData(t),a=null==e?void 0:e._isUp,t=+u;i.classed&&i.classed(I[a?"valueUp":"valueDown"],!0);e=u?"H"+n[1][1]+" V"+n[1][0]+" H"+n[0][1]:"V"+n[1][1]+" H"+n[1][0]+" V"+n[0][1];i.select("path").attr("d","M"+n[0][t]+","+n[0][+!t]+e+"z").style("fill",function(t){return(a?c.color(t):N(d)?d[t.id]:d)||c.color(t)});var r,s=i.select("line"),o=u?{x1:n[2][1],x2:n[2][2],y1:n[2][0],y2:n[2][0]}:{x1:n[2][0],x2:n[2][0],y1:n[2][1],y2:n[2][2]};for(r in o)s.attr(r,o[r])}},generateGetCandlestickPoints:function(t,c){var l=this,u=l.config,e=(c=void 0===c?!1:c)?l.axis.subX:l.axis.x,i=l.getIndicesMax(t)+1,d=l.getBarW("candlestick",e,i),h=l.getShapeX(d,t,!!c),g=l.getShapeY(!!c),f=l.getShapeOffset(l.isBarType,t,!!c),p=l.getYScaleById.bind(l);return function(t,e){var i,n=p.call(l,t.id,c)(l.getShapeYMin(t.id)),a=f(t,e)||n,r=F(d)?d:d[t.id]||d._$width,s=l.getCandlestickData(t),o=s?((i={start:h(t),end:0}).end=i.start+r,e={start:g(s.open),end:g(s.close)},o={x:i.start+r/2,high:g(s.high),low:g(s.low)},u.axis_rotated&&(0<t.value&&e.start<n||t.value<0&&n<e.start)&&(e.start=n),e.start-=n-a,[[i.start,e.start],[i.end,e.end],[o.x,o.low,o.high]]):[[0,0],[0,0],[0,0,0]];return o}},redrawCandlestick:function(n,a,t){var t=((t=void 0===t?!1:t)?this.$el.subchart:this.$el).candlestick,r=j(!0);return[t.each(function(t,e){var i=a?(0,D.select)(this).transition(r):(0,D.select)(this);n(t,e,i)}).style("opacity",null)]},getCandlestickData:function(t){var e,i=t.value;return B(i)?!(e={open:i[0],high:i[1],low:i[2],close:i[3]})!==(t=void 0!==(t=i[4])&&t)&&(e.volume=t):N(i)&&(e=function(e){for(var i,t=1;t<arguments.length;t++)i=null==arguments[t]?{}:arguments[t],t%2?Se(Object(i),!0).forEach(function(t){r(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Se(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))});return e}({},i)),e&&(e._isUp=e.close>=e.open),e||null}},Ee={initGauge:function(){function t(t){n.append("text").attr("class",t).style("text-anchor","middle").style("pointer-events","none")}var e,i=this.config,n=this.$el.arcs;this.hasType("gauge")&&(e=this.hasMultiArcGauge(),n.append(e?"g":"path").attr("class",I.chartArcsBackground).style("fill",!e&&i.gauge_background||null),i.gauge_units&&t(I.chartArcsGaugeUnit),i.gauge_label_show&&(t(I.chartArcsGaugeMin),i.gauge_fullCircle||t(I.chartArcsGaugeMax)))},updateGaugeMax:function(){var t=this.config,e=this.state,e=this.hasMultiArcGauge()?this.getMinMaxData().max[0].value:this.getTotalDataSum(e.rendered);e+t.gauge_min*(0<t.gauge_min?-1:1)>t.gauge_max&&(t.gauge_max=e-t.gauge_min)},redrawMultiArcGauge:function(){var c=this,t=c.config,l=c.state,e=c.$el,u=c.state.hiddenTargetIds,e=e.main.selectAll("."+I.arcs).selectAll("."+I.arcLabelLine).data(c.arcData.bind(c));e.enter().append("rect").attr("class",function(t){return I.arcLabelLine+" "+I.target+" "+I.target+"-"+t.data.id}).merge(e).style("fill",function(t){return c.levelColor?c.levelColor(t.data.values[0].value):c.color(t.data)}).style("display",t.gauge_label_show?null:"none").each(function(t){var e,i,n,a=0,r=0,s=0,o="";u.indexOf(t.data.id)<0&&(n=c.updateAngle(t),e=l.gaugeArcWidth/c.filterTargetsToShow(c.data.targets).length*(n.index+1),n=(i=n.endAngle-Math.PI/2)-(0==(t=l.radius-e)?0:1/t),a=l.radiusExpanded-l.radius+e,r=Math.cos(n)*t,s=Math.sin(n)*t,o="rotate("+180*i/Math.PI+", "+r+", "+s+")"),(0,D.select)(this).attr("x",r).attr("y",s).attr("width",a).attr("height",2).attr("transform",o).style("stroke-dasharray","0, "+(a+2)+", 0")})},textForGaugeMinMax:function(t,e){var i=this.config.gauge_label_extents;return O(i)?i.bind(this.api)(t,e):t},getGaugeLabelHeight:function(){var t=this.config;return this.config.gauge_label_show&&!t.gauge_fullCircle?20:0},getPaddingBottomForGauge:function(){return this.getGaugeLabelHeight()*(this.config.gauge_label_show?2:2.5)}},Re={initBubble:function(){var t=this.config;this.hasType("bubble")&&(t.point_show=!0,t.point_type="circle",t.point_sensitivity=25)},getBaseLength:function(){var t=this.state,e=t.width,i=t.height,n=ut,t=this.cache.get(n);return t||this.cache.add(n,t=et("min",[e,i])),t},getBubbleR:function(t){var e=this,i=e.config.bubble_maxR;O(i)?i=i.bind(e.api)(t):F(i)||(i=e.getBaseLength()/(2*e.getMaxDataCount())+12);var n=et("max",e.getMinMaxData().max.map(function(t){return e.isBubbleZType(t)?e.getBubbleZData(t.value,"y"):N(t.value)?t.value.mid:t.value})),i=i*i*Math.PI,n=(e.isBubbleZType(t)?e.getBubbleZData(t.value,"z"):t.value)*(i/n);return Math.sqrt(n/Math.PI)},getBubbleZData:function(t,e){return N(t)?t[e]:t["y"===e?0:1]}},Le={initLine:function(){var t=this.$el;t.line=t.main.select("."+I.chart).append("g").attr("class",I.chartLines)},updateTargetsForLine:function(t){var e=this,i=e.$el,n=i.area,a=i.line,r=i.main,s=e.getChartClass("Line"),i=e.getClass("lines",!0),o=e.classFocus.bind(e);a||e.initLine();a=t.filter(function(t){return!(e.isScatterType(t)||e.isBubbleType(t))}),t=r.select("."+I.chartLines).selectAll("."+I.chartLine).data(a).attr("class",function(t){return s(t)+o(t)}),r=t.enter().append("g").attr("class",s).style("opacity","0").style("pointer-events","none");r.append("g").attr("class",i),e.hasTypeOf("Area")&&e.initArea(!n&&r.empty()?t:r),e.updateTargetForCircle(a,r)},updateLine:function(t,e){var i=this,n=i.format.extraLineClasses,a=i.$el,e=(e=void 0===e?!1:e)?a.subchart:a,a=e.main.selectAll("."+I.lines).selectAll("."+I.line).data(i.lineData.bind(i));a.exit().transition().duration(t).style("opacity","0").remove(),e.line=a.enter().append("path").attr("class",function(t){return i.getClass("line",!0)(t)+" "+(n(t)||"")}).style("stroke",i.color).merge(a).style("opacity",i.initialOpacity.bind(i)).style("shape-rendering",function(t){return i.isStepType(t)?"crispEdges":""}).attr("transform",null)},redrawLine:function(t,e,i){i=((i=void 0===i?!1:i)?this.$el.subchart:this.$el).line;return[(e?i.transition(j()):i).attr("d",t).style("stroke",this.color).style("opacity",null)]},getCurve:function(e){var i=this;return i.config.axis_rotated&&i.isStepType(e)?function(t){t=i.getInterpolate(e)(t);return t.orgPoint=t.point,t.pointRotated=function(t,e){1===this._point&&(this._point=2);var i=this._y*(1-this._t)+e*this._t;this._context.lineTo(this._x,i),this._context.lineTo(t,i),this._x=t,this._y=e},t.point=function(t,e){0===this._point?this.orgPoint(t,e):this.pointRotated(t,e)},t}:i.getInterpolate(e)},generateDrawLine:function(t,s){function e(t){return(s?o.subxx:o.xx).call(o,t)}var o=this,c=o.config,l=o.scale,u=c.line_connectNull,d=c.axis_rotated,i=o.generateGetLinePoints(t,s),h=o.getYScaleById.bind(o),t=function(t,e){return o.isGrouped(t.id)?i(t,e)[0][1]:h(t.id,s)(o.getBaseValue(t))},g=(0,Gt.line)(),g=d?g.x(t).y(e):g.x(e).y(t);u||(g=g.defined(function(t){return null!==o.getBaseValue(t)}));var f=s?l.subX:l.x;return function(t){var e,i=h(t.id,s),n=u?o.filterRemoveNull(t.values):t.values,a=0,r=0;return(o.isLineType(t)?(e=c.data_regions[t.id])?o.lineWithRegions(n,l.zoom||f,i,e):(o.isStepType(t)&&(n=o.convertValuesToStep(n)),g.curve(o.getCurve(t))(n)):(n[0]&&(a=f(n[0].x),r=i(n[0].value)),d?"M "+r+" "+a:"M "+a+" "+r))||"M 0 0"}},lineWithRegions:function(t,r,s,e){var i=this,o=i.config.axis_rotated,n=i.axis.isTimeSeries(),a=i.axis.isCategorized()?.5:0,c=[];if(X(e))for(var l,u=function(t,e){return M(t)?e:n?rt.call(i,t):t},d=0;l=e[d];d++){var h=u(l.start,t[0].x),g=u(l.end,t[t.length-1].x),f=l.style||{dasharray:"2 2"};c[d]={start:h,end:g,style:f}}for(var p,x=o?function(t){return s(t.value)}:function(t){return r(t.x)},v=o?function(t){return r(t.x)}:function(t){return s(t.value)},_=function(t){return"M"+t[0][0]+","+t[0][1]+"L"+t[1][0]+","+t[1][1]},m=n?function(t,e,i,n){var a=t.x.getTime(),e=e.x-t.x,t=new Date(a+e*i),n=new Date(a+e*(i+n)),i=o?[[s(C(i)),r(t)],[s(C(i+k)),r(n)]]:[[r(t),s(C(i))],[r(n),s(C(i+k))]];return _(i)}:function(t,e,i,n){n=o?[[s(C(i),!0),r(S(i))],[s(C(i+n),!0),r(S(i+n))]]:[[r(S(i),!0),s(C(i))],[r(S(i+n),!0),s(C(i+n))]];return _(n)},y={x:i.axis.getAxisType("x"),y:i.axis.getAxisType("y")},b="",T=0;p=t[T];T++){var w=t[T-1],A=w&&z(w.value),f=function(t,e){for(var i,n=0;i=e[n];n++)if(i.start<t&&t<=i.end)return i.style;return!1}(p.x,c);if(z(p.value))if(!M(c)&&f&&A){if(A){try{f=f.dasharray.split(" ")}catch(t){f="2 2".split(" ")}for(var k,S=Nt(y.x,w.x+a,p.x+a),C=Nt(y.y,w.value,p.value),E=r(p.x)-r(w.x),R=s(p.value)-s(w.value),R=Math.sqrt(Math.pow(E,2)+Math.pow(R,2)),L=(k=f[0]/R)*f[1],O=k;O<=1;O+=L)b+=m(w,p,O,k),1<=O+L&&(b+=m(w,p,1,0))}}else b+=(T&&A?"L":"M")+x(p)+","+v(p)}return b},isWithinStep:function(t,e){return Math.abs(e-L(this.state.event,t)[1])<30},shouldDrawPointsForLine:function(t){var e=this.config.line_point;return!0===e||B(e)&&-1!==e.indexOf(t.id)}},Oe={hasValidPointType:function(t){return/^(circle|rect(angle)?|polygon|ellipse|use)$/i.test(t||this.config.point_type)},hasValidPointDrawMethods:function(t){t=t||this.config.point_type;return b(t)&&O(t.create)&&O(t.update)},initialOpacityForCircle:function(t){var e=this.config,i=this.state.withoutFadeIn,e=e.point_opacity;return e=M(e)?null!==this.getBaseValue(t)&&i[t.id]?this.opacityForCircle(t):"0":e},opacityForCircle:function(t){var e=this.config,i=e.point_opacity;return M(i)&&(i=e.point_show&&!e.point_focus_only?null:"0",i=z(this.getBaseValue(t))?this.isBubbleType(t)||this.isScatterType(t)?"0.5":i:"0"),i},initCircle:function(){var t=this.$el.main;this.point=this.generatePoint(),(this.hasType("bubble")||this.hasType("scatter"))&&t.select("."+I.chartCircles).empty()&&t.select("."+I.chart).append("g").attr("class",I.chartCircles)},updateTargetForCircle:function(t,e){var i=this,n=this,a=n.config,r=n.data,s=n.$el,o=a.interaction_enabled&&a.data_selection_enabled,c=o&&a.data_selection_isselectable,l=n.getClass("circles",!0);a.point_show&&(s.circle||n.initCircle(),e=e,(t=t)||(t=r.targets.filter(function(t){return i.isScatterType(t)||i.isBubbleType(t)}),(r=s.main.select("."+I.chartCircles).style("pointer-events","none").selectAll("."+I.circles).data(t).attr("class",l)).exit().remove(),e=r.enter()),o&&e.append("g").attr("class",function(t){return n.generateClass(I.selectedCircles,t.id)}),e.append("g").attr("class",l).style("cursor",function(t){return c&&c(t)?"pointer":null}),o&&t.forEach(function(e){s.main.selectAll("."+I.selectedCircles+n.getTargetSelectorSuffix(e.id)).selectAll(""+I.selectedCircle).each(function(t){t.value=e.values[t.index].value})}))},updateCircle:function(t){var e=this,i=e.config,n=e.state,a=e.$el,r=i.point_focus_only,a=(t=void 0===t?!1:t)?a.subchart:a;i.point_show&&!n.toggling&&((n=a.main.selectAll("."+I.circles).selectAll("."+I.circle).data(function(t){return e.isLineType(t)&&e.shouldDrawPointsForLine(t)||e.isBubbleType(t)||e.isRadarType(t)||e.isScatterType(t)?r?[t.values[0]]:t.values:[]})).exit().remove(),n.enter().filter(Boolean).append(e.point("create",this,e.pointR.bind(e),e.color)),a.circle=a.main.selectAll("."+I.circles+" ."+I.circle).style("stroke",e.color).style("opacity",e.initialOpacityForCircle.bind(e)))},redrawCircle:function(t,e,i,n,a){var r=this.state.rendered,s=this.$el,a=(a=void 0===a?!1:a)?s.subchart:s,s=a.main.selectAll("."+I.selectedCircle);if(!this.config.point_show)return[];var o=this.point("update",this,t,e,this.color,i,n,s),n=this.isCirclePoint()?"c":"",c=j(),l=this.opacityForCircle.bind(this),u=[];return a.circle.each(function(t){t=o.bind(this)(t),t=(i||!r?t.transition(c):t).style("opacity",l);u.push(t)}),[u,(i?s.transition():s).attr(n+"x",t).attr(n+"y",e)]},showCircleFocus:function(i){var r,s=this,t=s.config,e=s.state,n=e.hasRadar,a=e.resizing,o=e.toggling,c=e.transiting,e=s.$el.circle;!1===c&&t.point_focus_only&&e&&(t=(n?s.radarCircleX:s.circleX).bind(s),n=(n?s.radarCircleY:s.circleY).bind(s),o=o||M(i),r=s.point("update",s,t,n,s.color,!a&&o),(e=i?e.filter(function(e){var t=i.filter(function(t){return t.id===e.id});return!!t.length&&(0,D.select)(this).datum(t[0])}):e).attr("class",this.updatePointClass.bind(this)).style("opacity",null).each(function(t){var e=t.id,i=t.index,n=t.value,a="hidden";z(n)&&(r.bind(this)(t),s.expandCircles(i,e),a=""),this.style.visibility=a}))},hideCircleFocus:function(){var t=this.config,e=this.$el.circle;t.point_focus_only&&e&&(this.unexpandCircles(),e.style("visibility","hidden"))},circleX:function(t){return this.xx(t)},updateCircleY:function(n){void 0===n&&(n=!1);var a=this,r=a.generateGetLinePoints(a.getShapeIndices(a.isLineType),n);return function(t,e){var i=t.id;return a.isGrouped(i)?r(t,e)[0][1]:a.getYScaleById(i,n)(a.getBaseValue(t))}},getCircles:function(t,e){t=z(t)?"-"+t:"";return(e?this.$el.main.selectAll("."+I.circles+this.getTargetSelectorSuffix(e)):this.$el.main).selectAll("."+I.circle+t)},expandCircles:function(t,e,i){var n=this.pointExpandedR.bind(this);i&&this.unexpandCircles();var e=this.getCircles(t,e).classed(I.EXPANDED,!0),a=n(e)/this.config.point_r,r=1-a;this.isCirclePoint()?e.attr("r",n):e.each(function(){var t,e,i=(0,D.select)(this);"circle"===this.tagName?i.attr("r",n):(t=(e=this.getBBox()).width,e=e.height,t=r*(+i.attr("x")+t/2),e=r*(+i.attr("y")+e/2),i.attr("transform","translate("+t+" "+e+") scale("+a+")"))})},unexpandCircles:function(t){var e=this.pointR.bind(this),t=this.getCircles(t).filter(function(){return(0,D.select)(this).classed(I.EXPANDED)}).classed(I.EXPANDED,!1);t.attr("r",e),this.isCirclePoint()||t.attr("transform","scale("+e(t)/this.config.point_r+")")},pointR:function(t){var e=this.config.point_r,i=e;return this.isBubbleType(t)?i=this.getBubbleR(t):O(e)&&(i=e.bind(this.api)(t)),i},pointExpandedR:function(t){var e=this.config,i=this.isBubbleType(t)?1.15:1.75;return e.point_focus_expand_enabled?e.point_focus_expand_r||this.pointR(t)*i:this.pointR(t)},pointSelectR:function(t){var e=this.config.point_select_r;return O(e)?e(t):e||4*this.pointR(t)},isWithinCircle:function(t,e){var i=L(this.state.event,t),n=(0,D.select)(t),a=this.isCirclePoint(t)?"c":"",r=+n.attr(a+"x"),a=+n.attr(a+"y");return r||a||1!==t.nodeType||(r=(t=V(t)).x,a=t.y),Math.sqrt(Math.pow(r-i[0],2)+Math.pow(a-i[1],2))<(e||this.config.point_sensitivity)},insertPointInfoDefs:function(t,e){function i(t,e){for(var i,n=t.attributes,a=0;i=n[a];a++)i=i.name,e.setAttribute(i,t.getAttribute(i))}var n,a=(new DOMParser).parseFromString(t,"image/svg+xml").documentElement,t=P.createElementNS(D.namespaces.svg,a.nodeName.toLowerCase());t.id=e,t.style.fill="inherit",t.style.stroke="inherit",i(a,t),a.childNodes&&a.childNodes.length&&(n=(0,D.select)(t),"innerHTML"in t?n.html(a.innerHTML):Z(a.childNodes).forEach(function(t){i(t,n.append(t.tagName).node())})),this.$el.defs.node().appendChild(t)},pointFromDefs:function(t){return this.$el.defs.select("#"+t)},updatePointClass:function(t){var e=this,i=e.$el.circle,n=!1;return n=N(t)||i?!0===t?i.each(function(t){t=e.getClass("circle",!0)(t);-1<this.getAttribute("class").indexOf(I.EXPANDED)&&(t+=" "+I.EXPANDED),this.setAttribute("class",t)}):e.getClass("circle",!0)(t):n},generateGetLinePoints:function(t,r){var s=this,o=s.config,c=s.getShapeX(0,t,r),l=s.getShapeY(r),u=s.getShapeOffset(s.isLineType,t,r),d=s.getYScaleById.bind(s);return function(t,e){var i=d.call(s,t.id,r)(s.getShapeYMin(t.id)),n=u(t,e)||i,a=c(t),e=l(t),n=[a,(e=o.axis_rotated&&(0<t.value&&e<i||t.value<0&&i<e)?i:e)-(i-n)];return[n,n,n,n]}},generatePoint:function(){var s=this,t=s.config,o=s.state.datetimeId,c=[],l=$(t.point_pattern)?t.point_pattern:[t.point_type];return function(n,a){for(var t=arguments.length,r=Array(2<t?t-2:0),e=2;e<t;e++)r[e-2]=arguments[e];return function(t){var e=s.getTargetSelectorSuffix(t.id||t.data&&t.data.id||t),i=(0,D.select)(this);c.indexOf(e)<0&&c.push(e);t=l[c.indexOf(e)%l.length];if(s.hasValidPointType(t))t=s[t];else if(!s.hasValidPointDrawMethods(t)){e=o+"-point"+e;if(s.pointFromDefs(e).size()<1&&s.insertPointInfoDefs(t,e),"create"===n)return s.custom.create.bind(a).apply(void 0,[i,e].concat(r));if("update"===n)return s.custom.update.bind(a).apply(void 0,[i].concat(r))}return t[n].bind(a).apply(void 0,[i].concat(r))}}},custom:{create:function(t,e,i,n){return t.append("use").attr("xlink:href","#"+e).attr("class",this.updatePointClass.bind(this)).style("fill",n).node()},update:function(t,e,i,n,a,r,s){var o=t.node().getBBox(),c=o.width,l=o.height,o=function(t){return z(t.value)?e(t)-c/2:0},t=t;return a&&(a=j(),r&&t.attr("x",o),t=t.transition(a),s&&s.transition(j())),t.attr("x",o).attr("y",function(t){return z(t.value)?i(t)-l/2:0}).style("fill",n)}},circle:{create:function(t,e,i){return t.append("circle").attr("class",this.updatePointClass.bind(this)).attr("r",e).style("fill",i).node()},update:function(t,e,i,n,a,r,s){return this.hasType("bubble")&&t.attr("r",this.pointR.bind(this)),a&&(a=j(),r&&t.attr("cx",e),t.attr("cx")&&(t=t.transition(a)),s&&s.transition(j())),t.attr("cx",e).attr("cy",i).style("fill",n)}},rectangle:{create:function(t,e,i){function n(t){return 2*e(t)}return t.append("rect").attr("class",this.updatePointClass.bind(this)).attr("width",n).attr("height",n).style("fill",i).node()},update:function(t,e,i,n,a,r,s){function o(t){return e(t)-c}var c=this.config.point_r,t=t;return a&&(a=j(),r&&t.attr("x",o),t=t.transition(a),s&&s.transition(j())),t.attr("x",o).attr("y",function(t){return i(t)-c}).style("fill",n)}}};var De=pt,Ie={initRadar:function(){var t=this.config,e=this.state.current,i=this.$el;this.hasType("radar")&&(i.radar=i.main.select("."+I.chart).append("g").attr("class",I.chartRadars),i.radar.levels=i.radar.append("g").attr("class",I.levels),i.radar.axes=i.radar.append("g").attr("class",I.axis),i.radar.shapes=i.radar.append("g").attr("class",I.shapes),e.dataMax=t.radar_axis_max||this.getMinMaxData().max[0].value)},getRadarSize:function(){var t=this.config,e=this.state,i=e.arcWidth,e=e.arcHeight,t=t.axis_x_categories.length<4?-20:10,t=(Math.min(i,e)-t)/2;return[t,t]},updateTargetsForRadar:function(t){var e=this.config;T(e.axis_x_categories)&&(e.axis_x_categories=it(0,et("max",t.map(function(t){return t.values.length})))),this.generateRadarPoints()},getRadarPosition:function(o,c,l,u){var d=this.config,t=this.getRadarSize(),h=t[0],g=t[1],f=d.axis_x_categories.length,p=d.radar_direction_clockwise,t=Z(o).map(function(t){return e=p,i=t,n=f,a=c,r=X(l)?l:"x"===o?h:g,s=F(u)?u:d.radar_size_ratio,t=2*Math.PI,r*(1-s*("x"===i?Math.sin:Math.cos)((e&&0<a?n-a:a)*t/n));var e,i,n,a,r,s});return 1===t.length?t[0]:t},generateRadarPoints:function(){var i=this,t=i.data.targets,e=i.getRadarSize(),n=e[0],a=e[1],r=i.cache.get(De)||{},e=r._size;e&&(e.width===n||e.height===a)||(t.forEach(function(t){r[t.id]=t.values.map(function(t,e){return i.getRadarPosition(["x","y"],e,void 0,i.getRatio("radar",t))})}),r._size={width:n,height:a},i.cache.add(De,r))},redrawRadar:function(t){var e=this.$el,i=e.radar,n=e.main,e=this.getTranslate("radar");e&&(i.attr("transform",e),n.select("."+I.chartTexts).attr("transform",e),this.generateRadarPoints(),this.updateRadarLevel(),this.updateRadarAxes(),this.updateRadarShape(t))},generateGetRadarPoints:function(){var i=this.cache.get(De);return function(t,e){e=i[t.id][e];return[e,e,e,e]}},updateRadarLevel:function(){var i=this,t=i.config,e=i.state,n=i.$el.radar,a=i.getRadarSize(),r=a[0],s=a[1],o=t.radar_level_depth,c=t.axis_x_categories.length,l=t.radar_level_text_show,u=n.levels,d=it(0,o),h=t.radar_size_ratio*Math.min(r,s),g=d.map(function(t){return(t+1)/o*h}),f=(t.radar_level_text_format||function(){}).bind(i.api),p=d.map(function(t){var e=g[t];return it(0,c).map(function(t){return i.getRadarPosition(["x","y"],t,e,1).join(",")}).join(" ")}),a=u.selectAll("."+I.level).data(d);a.exit().remove();n=a.enter().append("g").attr("class",function(t,e){return I.level+" "+I.level+"-"+e});n.append("polygon").style("visibility",t.radar_level_show?null:"hidden"),l&&(u.select("text").empty()&&u.append("text").attr("dx","-.5em").attr("dy","-.7em").style("text-anchor","end").text(function(){return f(0)}),n.append("text").attr("dx","-.5em").style("text-anchor","end").text(function(t){return f(e.current.dataMax/d.length*(t+1))})),n.merge(a).attr("transform",function(t){return"translate("+(r-g[t])+", "+(s-g[t])+")"}).selectAll("polygon").attr("points",function(t){return p[t]}),l&&u.selectAll("text").attr("x",function(t){return M(t)?r:p[t].split(",")[0]}).attr("y",function(t){return M(t)?s:0})},updateRadarAxes:function(){var i=this,t=i.config,e=i.$el.radar,n=i.getRadarSize(),a=n[0],r=n[1],n=t.axis_x_categories,e=e.axes.selectAll("g").data(n);e.exit().remove();var s,o,n=e.enter().append("g").attr("class",function(t,e){return I.axis+"-"+e});t.radar_axis_line_show&&n.append("line"),t.radar_axis_text_show&&n.append("text"),e=n.merge(e),t.radar_axis_line_show&&e.select("line").attr("x1",a).attr("y1",r).attr("x2",function(t,e){return i.getRadarPosition("x",e)}).attr("y2",function(t,e){return i.getRadarPosition("y",e)}),t.radar_axis_text_show&&(t=(n=t.radar_axis_text_position).x,s=void 0===t?0:t,n=n.y,o=void 0===n?0:n,e.select("text").style("text-anchor","middle").attr("dy",".5em").call(function(t){t.each(function(t){E((0,D.select)(this),t+"",[-.6,1.2])})}).datum(function(t,e){return{index:e}}).attr("transform",function(t){M(this.width)&&(this.width=this.getBoundingClientRect().width/2);var e=i.getRadarPosition("x",t.index,void 0,1),t=Math.round(i.getRadarPosition("y",t.index,void 0,1));return a<e?e+=this.width+s:Math.round(e)<a&&(e-=this.width+s),r<t?(t/2===r&&"tspan"===this.firstChild.tagName&&this.firstChild.setAttribute("dy","0em"),t+=o):t<r&&(t-=o),"translate("+e+" "+t+")"})),i.bindEvent()},bindEvent:function(){var i,n,a=this,t=a.config,e=a.state,r=a.$el,s=r.radar,o=r.svg,c=t.point_focus_only,r=e.inputType,l=e.transiting;t.interaction_enabled&&(i="mouse"===r,n=function(t){t=t.target;/tspan/i.test(t.tagName)&&(t=t.parentNode);t=(0,D.select)(t).datum();return t&&1===Object.keys(t).length?t.index:void 0},r=function(t){var e=n(t),t=M(e);(i||t)&&(a.hideTooltip(),c?a.hideCircleFocus():a.unexpandCircles(),i?a.setOverOut(!1,e):t&&a.callOverOutForTouch())},s.axes.selectAll("text").on(i?"mouseover ":"touchstart",function(t){l||(e.event=t,t=n(t),a.selectRectForSingle(o.node(),null,t),i?a.setOverOut(!0,t):a.callOverOutForTouch(t))}).on("mouseout",i?r:null),i||o.on("touchstart",r))},updateRadarShape:function(t){var e=this,i=e.data.targets.filter(function(t){return e.isRadarType(t)}),n=e.cache.get(De),a=e.$el.radar.shapes.selectAll("polygon").data(i),r=a.enter().append("g").attr("class",e.getChartClass("Radar"));a.exit().transition().duration(t).remove(),r.append("polygon").merge(a).style("fill",e.color).style("stroke",e.color).attr("points",function(t){return n[t.id].join(" ")}),e.updateTargetForCircle(i,r)},radarCircleX:function(t){return this.cache.get(De)[t.id][t.index][0]},radarCircleY:function(t){return this.cache.get(De)[t.id][t.index][1]}},Pe={point_show:!0,point_r:2.5,point_sensitivity:10,point_focus_expand_enabled:!0,point_focus_expand_r:void 0,point_focus_only:!1,point_opacity:void 0,point_pattern:[],point_select_r:void 0,point_type:"circle"},ze={area_above:!1,area_front:!0,area_linearGradient:!1,area_zerobased:!0},Me={bar_label_threshold:0,bar_padding:0,bar_radius:void 0,bar_radius_ratio:void 0,bar_sensitivity:2,bar_width:void 0,bar_width_ratio:.6,bar_width_max:void 0,bar_zerobased:!0},Xe={bubble_maxR:35,bubble_zerobased:!1},Fe={candlestick_width:void 0,candlestick_width_ratio:.6,candlestick_width_max:void 0,candlestick_color_down:"red"},$e={line_connectNull:!1,line_step_type:"step",line_zerobased:!1,line_classes:void 0,line_point:!0},Be={scatter_zerobased:!1},Ne={spline_interpolation_type:"cardinal"},Ye={donut_label_show:!0,donut_label_format:void 0,donut_label_threshold:.05,donut_label_ratio:void 0,donut_width:void 0,donut_title:"",donut_expand:{},donut_expand_rate:.98,donut_expand_duration:50,donut_padAngle:0,donut_startingAngle:0},Ge={gauge_background:"",gauge_fullCircle:!1,gauge_label_show:!0,gauge_label_format:void 0,gauge_label_extents:void 0,gauge_label_threshold:0,gauge_min:0,gauge_max:100,gauge_type:"single",gauge_startingAngle:-1*Math.PI/2,gauge_arcLength:100,gauge_title:"",gauge_units:void 0,gauge_width:void 0,gauge_arcs_minWidth:5,gauge_expand:{},gauge_expand_rate:.98,gauge_expand_duration:50},Ve={pie_label_show:!0,pie_label_format:void 0,pie_label_threshold:.05,pie_label_ratio:void 0,pie_expand:{},pie_expand_rate:.98,pie_expand_duration:50,pie_innerRadius:0,pie_outerRadius:void 0,pie_padAngle:0,pie_padding:0,pie_startingAngle:0},je={radar_axis_max:void 0,radar_axis_line_show:!0,radar_axis_text_show:!0,radar_axis_text_position:{},radar_level_depth:3,radar_level_show:!0,radar_level_text_format:function(t){return t%1==0?t:t.toFixed(2)},radar_level_text_show:!0,radar_size_ratio:.87,radar_direction_clockwise:!1};function He(t,e){W(Jt.prototype,ye.concat(t)),W(ie.prototype,me),lt.setOptions(be.concat(e||[]))}function We(t,e){He([Oe,Le].concat(t||[])),lt.setOptions([Pe,$e].concat(e||[]))}function Ue(t,e){W(Jt.prototype,[we].concat(t||[])),lt.setOptions(e)}var Ze=function(){return We(Ae,[ze]),(Ze=function(){return It.AREA})()},qe=function(){return We(Ae,[ze]),(qe=function(){return It.AREA_LINE_RANGE})()},Ke=function(){return We(Ae,[ze,Ne]),(Ke=function(){return It.AREA_SPLINE})()},Je=function(){return We(Ae,[ze,Ne]),(Je=function(){return It.AREA_SPLINE_RANGE})()},Qe=function(){return We(Ae,[ze]),(Qe=function(){return It.AREA_STEP})()},ti=function(){return We(),(ti=function(){return It.LINE})()},ei=function(){return We(void 0,[Ne]),(ei=function(){return It.SPLINE})()},ii=function(){return We(),(ii=function(){return It.STEP})()},ni=function(){return Ue(void 0,[Ye]),(ni=function(){return It.DONUT})()},ai=function(){return Ue([Ee],[Ge]),(ai=function(){return It.GAUGE})()},ri=function(){return Ue(void 0,[Ve]),(ri=function(){return It.PIE})()},si=function(){return Ue([Oe,Ie],[Pe,je]),(si=function(){return It.RADAR})()},oi=function(){return He([ke],Me),(oi=function(){return It.BAR})()},ci=function(){return He([Oe,Re],[Xe,Pe]),(ci=function(){return It.BUBBLE})()},li=function(){return He([Ce],[Fe]),(li=function(){return It.CANDLESTICK})()},ui=function(){return He([Oe],[Pe,Be]),(ui=function(){return It.SCATTER})()},di={selected:function(t){var e=this.internal,i=[];return e.$el.main.selectAll("."+(I.shapes+e.getTargetSelectorSuffix(t))).selectAll("."+I.shape).filter(function(){return(0,D.select)(this).classed(I.SELECTED)}).each(function(t){return i.push(t)}),i},select:function(o,c,l){var u=this.internal,d=u.config,t=u.$el;d.data_selection_enabled&&t.main.selectAll("."+I.shapes).selectAll("."+I.shape).each(function(t,e){var i=(0,D.select)(this),n=(t.data||t).id,a=u.getToggle(this,t).bind(u),r=d.data_selection_grouped||!o||0<=o.indexOf(n),s=!c||0<=c.indexOf(e),n=i.classed(I.SELECTED);i.classed(I.line)||i.classed(I.area)||(r&&s?d.data_selection_isselectable.bind(u.api)(t)&&!n&&a(!0,i.classed(I.SELECTED,!0),t,e):X(l)&&l&&n&&a(!1,i.classed(I.SELECTED,!1),t,e))})},unselect:function(o,c){var l=this.internal,u=l.config,t=l.$el;u.data_selection_enabled&&t.main.selectAll("."+I.shapes).selectAll("."+I.shape).each(function(t,e){var i=(0,D.select)(this),n=(t.data||t).id,a=l.getToggle(this,t).bind(l),r=u.data_selection_grouped||!o||0<=o.indexOf(n),s=!c||0<=c.indexOf(e),n=i.classed(I.SELECTED);i.classed(I.line)||i.classed(I.area)||r&&s&&u.data_selection_isselectable.bind(l.api)(t)&&n&&a(!1,i.classed(I.SELECTED,!1),t,e)})}},hi={subchart:{show:function(){var t=this.internal,e=t.$el.subchart,i=t.config,n=i.subchart_show;n||(t.unbindZoomEvent(),i.subchart_show=!n,e.main||t.initSubchart(),n=e.main.selectAll("."+I.target),t.data.targets.length!==n.size()&&(t.updateSizes(),t.updateTargetsForSubchart(t.data.targets),n=e.main.selectAll("."+I.target)),n.style("opacity",null),e.main.style("display",null),this.flush())},hide:function(){var t=this.internal,e=t.$el.subchart,t=t.config;t.subchart_show&&"none"!==e.main.style("display")&&(t.subchart_show=!1,e.main.style("display","none"),this.flush())},toggle:function(){var t=this.internal.config;this.subchart[t.subchart_show?"hide":"show"]()}}},gi=Ri(14);pt=function(t){var e,i,n,a,r=this.internal,s=r.$el,o=r.config,c=r.org,l=r.scale,u=o.axis_rotated,d=r.axis.isCategorized(),h=t;return o.zoom_enabled&&h?(r.axis.isTimeSeries()&&(h=h.map(function(t){return rt.bind(r)(t)})),e=h,i=r.getZoomDomain(!0),t=r.getZoomDomain(),n=t[0],a=t[1],!e.every(function(t,e){return 0===e?n<=t:t<=a})||e[0]===i[0]&&e[1]===i[1]||(d&&(h=h.map(function(t,e){return+t+(0===e?0:1)})),r.api.tooltip.hide(),o.subchart_show?(o=l.zoom||l.x,r.brush.getSelection().call(r.brush.move,[o(h[0]),o(h[1])])):(c=[-(d=d?l.x.orgScale():c.xScale||l.x)(h[0]),0],c=(d=gi.zoomIdentity.scale(d.range()[1]/(d(h[1])-d(h[0])))).translate.apply(d,u?c.reverse():c),r.$T(s.eventRect).call(r.zoom.transform,c)),r.setZoomResetButton())):h=l.zoom?l.zoom.domain():l.x.orgDomain(),h};W(pt,{enable:function(t){var e=this.internal,i=e.config;/^(drag|wheel)$/.test(t)&&(i.zoom_type=t),i.zoom_enabled=!!t,e.zoom?!1===t&&e.bindZoomEvent(!1):(e.initZoom(),e.bindZoomEvent()),e.updateAndRedraw()},max:function(t){var e=this.internal,i=e.config,e=e.org.xDomain;return 0!==t&&!t||(i.zoom_x_max=et("max",[e[1],t])),i.zoom_x_max},min:function(t){var e=this.internal,i=e.config,e=e.org.xDomain;return 0!==t&&!t||(i.zoom_x_min=et("min",[e[0],t])),i.zoom_x_min},range:function(t){var e,i=this.zoom;return N(t)&&(e=t.min,t=t.max,X(e)&&i.min(e),X(t)&&i.max(t)),{min:i.min(),max:i.max()}}});var fi={zoom:pt,unzoom:function(){var t=this.internal,e=t.config,i=t.$el,n=i.eventRect,i=i.zoomResetBtn;t.scale.zoom&&(e.subchart_show?t.brush.getSelection().call(t.brush.move,null):t.zoom.updateTransformScale(gi.zoomIdentity),t.updateZoom(!0),null!=i&&i.style("display","none"),(0,gi.zoomTransform)(n.node())!==gi.zoomIdentity&&t.zoom.transform(n,gi.zoomIdentity))}},pi=Ri(13);function xi(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}function vi(e){for(var i,t=1;t<arguments.length;t++)i=null==arguments[t]?{}:arguments[t],t%2?xi(Object(i),!0).forEach(function(t){r(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):xi(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))});return e}var _i=vi(vi({},{drag:function(t){var e,i,d,h,g,f,p=this,n=p.config,a=p.state,r=p.$el.main,s=n.data_selection_grouped,o=n.interaction_enabled&&n.data_selection_isselectable;p.hasArcType()||!n.data_selection_enabled||n.zoom_enabled&&!p.zoom.altDomain||!n.data_selection_multiple||(e=(i=a.dragStart||[0,0])[0],n=i[1],i=t[0],t=t[1],d=Math.min(e,i),h=Math.max(e,i),g=s?a.margin.top:Math.min(n,t),f=s?a.height:Math.max(n,t),r.select("."+I.dragarea).attr("x",d).attr("y",g).attr("width",h-d).attr("height",f-g),r.selectAll("."+I.shapes).selectAll("."+I.shape).filter(function(t){return o&&o.bind(p.api)(t)}).each(function(t,e){var i,n=(0,D.select)(this),a=n.classed(I.SELECTED),r=n.classed(I.INCLUDED),s=!1;if(n.classed(I.circle))var o=+n.attr("cx"),c=+n.attr("cy"),l=p.togglePoint,s=d<o&&o<h&&g<c&&c<f;else{if(!n.classed(I.bar))return;var o=(o=(u=(i=this).getBoundingClientRect()).width,u=u.height,{x:(i=R(i))[0].x,y:Math.min(i[0].y,i[1].y),width:o,height:u}),u=o.x,c=o.y;l=p.togglePath,s=!(h<u||u+o.width<d||f<c||c+o.height<g)}s^r&&(n.classed(I.INCLUDED,!r),n.classed(I.SELECTED,!a),l.call(p,!a,n,t,e))}))},dragstart:function(t){var e=this.config,i=this.state,n=this.$el.main;this.hasArcType()||!e.data_selection_enabled||(i.dragStart=t,n.select("."+I.chart).append("rect").attr("class",I.dragarea).style("opacity","0.1"),this.setDragStatus(!0))},dragend:function(){var t=this.config,e=this.$el.main;this.hasArcType()||!t.data_selection_enabled||(e.select("."+I.dragarea).transition().duration(100).style("opacity","0").remove(),e.selectAll("."+I.shape).classed(I.INCLUDED,!1),this.setDragStatus(!1))}}),{},{selectPoint:function(t,e,i){var n=this,a=n.config,r=n.$el.main,s=a.axis_rotated,o=(s?n.circleY:n.circleX).bind(n),c=(s?n.circleX:n.circleY).bind(n),s=n.pointSelectR.bind(n);S(a.data_onselected,n.api,e,t.node()),r.select("."+I.selectedCircles+n.getTargetSelectorSuffix(e.id)).selectAll("."+I.selectedCircle+"-"+i).data([e]).enter().append("circle").attr("class",function(){return n.generateClass(I.selectedCircle,i)}).attr("cx",o).attr("cy",c).attr("stroke",n.color).attr("r",function(t){return 1.4*n.pointSelectR(t)}).transition().duration(100).attr("r",s)},unselectPoint:function(t,e,i){var n=this.config,a=this.$el;S(n.data_onunselected,this.api,e,t.node()),a.main.select("."+I.selectedCircles+this.getTargetSelectorSuffix(e.id)).selectAll("."+I.selectedCircle+"-"+i).transition().duration(100).attr("r",0).remove()},togglePoint:function(t,e,i,n){this[(t?"":"un")+"selectPoint"](e,i,n)},selectPath:function(t,e){var i=this,n=i.config;S(n.data_onselected,i.api,e,t.node()),n.interaction_brighten&&t.transition().duration(100).style("fill",function(){return(0,pi.rgb)(i.color(e)).brighter(.75)})},unselectPath:function(t,e){var i=this,n=i.config;S(n.data_onunselected,i.api,e,t.node()),n.interaction_brighten&&t.transition().duration(100).style("fill",function(){return i.color(e)})},togglePath:function(t,e,i,n){this[(t?"":"un")+"selectPath"](e,i,n)},getToggle:function(t,e){return"path"===t.nodeName?this.togglePath:this.isStepType(e)?function(){}:this.togglePoint},toggleShape:function(t,e,i){var n,a=this.config,r=this.$el.main,s=(0,D.select)(t),o=s.classed(I.SELECTED),c=this.getToggle(t,e).bind(this);a.data_selection_enabled&&a.data_selection_isselectable.bind(this.api)(e)&&(a.data_selection_multiple||(t="."+I.shapes,a.data_selection_grouped&&(t+=this.getTargetSelectorSuffix(e.id)),r.selectAll(t).selectAll("."+I.shape).each(function(t,e){var i=(0,D.select)(this);i.classed(I.SELECTED)&&c(!1,(n=i).classed(I.SELECTED,!1),t,e)})),n&&n.node()===s.node()||(s.classed(I.SELECTED,!o),c(!o,s,e,i)))}}),mi={initBrush:function(){var n,t,a=this,r=a.config,s=a.scale,e=a.$el.subchart,o=r.axis_rotated;a.brush=(o?(0,f.brushY):(0,f.brushX))().handleSize(5);a.brush.on("start brush end",function(t){var i=t.selection,e=t.target,t=t.type;"start"===t&&"touch"===a.state.inputType&&a.hideTooltip(),/(start|brush)/.test(t)&&a.redrawForBrush(),"end"===t&&(n=s.x.orgDomain()),null!=e&&e.handle&&(null===i?a.brush.handle.attr("display","none"):a.brush.handle.attr("display",null).attr("transform",function(t,e){return"translate("+(o?[33,i[e]-(0===e?30:24)]:[i[e],3])+")"}))}),a.brush.updateResize=function(){var e=this;t&&clearTimeout(t),t=setTimeout(function(){var t=e.getSelection();n&&(0,f.brushSelection)(t.node())&&e.move(t,n.map(s.subX.orgScale()))},0)},a.brush.update=function(){return 0===this.extent()()[1].filter(function(t){return isNaN(t)}).length&&e.main&&e.main.select("."+I.brush).call(this),this},a.brush.scale=function(t){var e,i,n=r.subchart_size_height||(e=a.$el.svg.select("."+I.brush+" .overlay"),i={width:0,height:0},e.size()&&(i.width=+e.attr("width"),i.height=+e.attr("height")),i[o?"width":"height"]),i=a.getExtent();!i&&t.range?i=[[0,0],[t.range()[1],n]]:B(i)&&(i=i.map(function(t,e){return[t,0<e?n:e]})),o&&i[1].reverse(),this.extent(i),this.update()},a.brush.getSelection=function(){return e.main?e.main.select("."+I.brush):(0,D.select)([])}},initSubchart:function(){var i,n=this,t=n.config,e=n.state,a=e.clip,r=e.hasAxis,s=n.$el,o=s.defs,c=s.svg,l=s.subchart,u=s.axis;r&&(e=t.subchart_show?null:"hidden",s=a.id+"-subchart",r=n.getClipPath(s),a.idSubchart=s,n.appendClip(o,s),n.initBrush(),l.main=c.append("g").classed(I.subchart,!0).attr("transform",n.getTranslate("context")),(i=l.main).style("visibility",e),i.append("g").attr("clip-path",r).attr("class",I.chart),["bar","line","bubble","candlestick","scatter"].forEach(function(t){var e=U(/^(bubble|scatter)$/.test(t)?"circle":t);(n.hasType(t)||n.hasTypeOf(e))&&(t=i.select("."+I.chart),e=I["chart"+e+"s"],t.select("."+e).empty()&&t.append("g").attr("class",e))}),r=i.append("g").attr("clip-path",r).attr("class",I.brush).call(n.brush),t.subchart_showHandle&&n.addBrushHandle(r),u.subX=i.append("g").attr("class",I.axisX).attr("transform",n.getTranslate("subX")).attr("clip-path",t.axis_rotated?"":a.pathXAxis).style("visibility",t.subchart_axis_x_show?e:"hidden"))},addBrushHandle:function(t){var e=this.config,i=e.axis_rotated,n=e.subchart_init_range,e="handle--custom",a=i?["M 5.2491724,29.749209 a 6,6 0 0 0 -5.50000003,-6.5 H -5.7508276 a 6,6 0 0 0 -6.0000004,6.5 z m -5.00000003,-2 H -6.7508276 m 6.99999997,-2 H -6.7508276Z","M 5.2491724,23.249172 a 6,-6 0 0 1 -5.50000003,6.5 H -5.7508276 a 6,-6 0 0 1 -6.0000004,-6.5 z m -5.00000003,2 H -6.7508276 m 6.99999997,2 H -6.7508276Z"]:["M 0 18 A 6 6 0 0 0 -6.5 23.5 V 29 A 6 6 0 0 0 0 35 Z M -2 23 V 30 M -4 23 V 30Z","M 0 18 A 6 6 0 0 1 6.5 23.5 V 29 A 6 6 0 0 1 0 35 Z M 2 23 V 30 M 4 23 V 30Z"];this.brush.handle=t.selectAll("."+e).data(i?[{type:"n"},{type:"s"}]:[{type:"w"},{type:"e"}]).enter().append("path").attr("class",e).attr("cursor",(i?"ns":"ew")+"-resize").attr("d",function(t){return a[+/[se]/.test(t.type)]}).attr("display",n?null:"none")},updateTargetsForSubchart:function(s){var o=this,t=o.config,e=o.state,c=o.$el.subchart.main;t.subchart_show&&(["bar","line","bubble","candlestick","scatter"].filter(function(t){return o.hasType(t)||o.hasTypeOf(U(t))}).forEach(function(t){var e=/^(bubble|scatter)$/.test(t),i=U(e?"circle":t),n=o.getChartClass(i,!0),a=o.getClass(e?"circles":t+"s",!0),r=c.select("."+I["chart"+i+"s"]);e?((e=r.selectAll("."+I.circles).data(s.filter(o["is"+U(t)+"Type"].bind(o))).attr("class",a)).exit().remove(),e.enter().append("g").attr("class",a)):(a=(i=r.selectAll("."+I["chart"+i]).attr("class",n).data(s.filter(o["is"+i+"Type"].bind(o)))).enter().append("g").style("opacity","0").attr("class",n).append("g").attr("class",a),i.exit().remove(),"line"===t&&o.hasTypeOf("Area")&&a.append("g").attr("class",o.getClass("areas",!0)))}),c.selectAll("."+I.brush+" rect").attr(t.axis_rotated?"width":"height",t.axis_rotated?e.width2:e.height2))},redrawSubchart:function(t,i,n){var a=this,e=a.config,r=a.$el.subchart.main,s=a.state,o=!!i;r.style("visibility",e.subchart_show?null:"hidden"),e.subchart_show&&(s.event&&"zoom"===s.event.type&&a.brush.update(),t)&&(r=e.subchart_init_range,H(a)||a.brush.update(),Object.keys(n.type).forEach(function(t){var e=U(t),t=a["generateDraw"+e](n.indices[t],!0);a["update"+e](i,!0),a["redraw"+e](t,o,!0)}),(a.hasType("bubble")||a.hasType("scatter"))&&(t=n.pos.cx,e=a.updateCircleY(!0),a.updateCircle(!0),a.redrawCircle(t,e,o,void 0,!0)),!s.rendered&&r&&a.brush.move(a.brush.getSelection(),r.map(a.scale.x)))},redrawForBrush:function(){var t=this.config,e=t.subchart_onbrush,i=t.zoom_rescale,t=this.scale;this.redraw({withTransition:!1,withY:i,withSubchart:!1,withUpdateXDomain:!0,withDimension:!1}),e.bind(this.api)(t.x.orgDomain())},transformContext:function(t,e){var i,n=this.$el.subchart.main;e&&e.axisSubX?i=e.axisSubX:(i=n.select("."+I.axisX),t&&(i=i.transition())),n.attr("transform",this.getTranslate("context")),i.attr("transform",this.getTranslate("subX"))},getExtent:function(){var e,t=this.config,i=this.scale,t=t.axis_x_extent;return t&&(O(t)?t=t.bind(this.api)(this.getXDomain(this.data.targets),i.subX):this.axis.isTimeSeries()&&t.every(isNaN)&&(e=rt.bind(this),t=t.map(function(t){return i.subX(e(t))}))),t}},yi={initZoom:function(){this.scale.zoom=null,this.generateZoom(),this.initZoomBehaviour()},bindZoomEvent:function(t){void 0===t&&(t=!0);var e=this.config;e.zoom_enabled&&t?e.subchart_show||this.bindZoomOnEventRect():!1===t&&(this.api.unzoom(),this.unbindZoomEvent())},generateZoom:function(){var n=this,a=n.config,r=n.org,s=n.scale,t=(0,gi.zoom)().duration(0).on("start",n.onZoomStart.bind(n)).on("zoom",n.onZoom.bind(n)).on("end",n.onZoomEnd.bind(n));t.orgScaleExtent=function(){var t=a.zoom_extent||[1,10];return[t[0],Math.max(n.getMaxDataCount()/t[1],t[1])]},t.updateScaleExtent=function(){var t=k(n.scale.x.orgDomain())/k(n.getZoomDomain()),e=this.orgScaleExtent();return this.scaleExtent([e[0]*t,e[1]*t]),this},t.updateTransformScale=function(t){r.xScale&&r.xScale.range(s.x.range());var e=t[a.axis_rotated?"rescaleY":"rescaleX"](r.xScale||s.x),i=n.trimXDomain(e.domain()),t=a.zoom_rescale;e.domain(i,r.xDomain),n.state.xTickOffset||(n.state.xTickOffset=n.axis.x.tickOffset()),s.zoom=n.getCustomizedScale(e),n.axis.x.scale(s.zoom),t&&(r.xScale||(r.xScale=s.x.copy()),s.x.domain(i))},t.getDomain=function(){var t=s[s.zoom?"zoom":"subX"].domain();return n.axis.isCategorized()&&(t[1]-=2),t},n.zoom=t},onZoomStart:function(t){var e=t.sourceEvent;e&&(this.zoom.startEvent=e,this.state.zooming=!0,S(this.config.zoom_onzoomstart,this.api,t))},onZoom:function(t){var e,i=this,n=i.config,a=i.scale,r=i.state,s=i.org,o=t.sourceEvent,c=(null==t?void 0:t.transform)===gi.zoomIdentity;!n.zoom_enabled||0===i.filterTargetsToShow(i.data.targets).length||!a.zoom&&-1<(null==o?void 0:o.type.indexOf("touch"))&&1===(null==o?void 0:o.touches.length)||(e="mousemove"===(null==o?void 0:o.type),o=(null==o?void 0:o.wheelDelta)<0,t=t.transform,!e&&o&&a.x.domain().every(function(t,e){return t!==s.xDomain[e]})&&a.x.domain(s.xDomain),i.zoom.updateTransformScale(t),r=0<n.transition_duration&&!n.subchart_show&&(r.dragging||c),i.redraw({withTransition:r,withY:n.zoom_rescale,withSubchart:!1,withEventRect:!1,withDimension:!1}),i.state.cancelClick=e,c||S(n.zoom_onzoom,i.api,i.zoom.getDomain()))},onZoomEnd:function(t){var e=this.config,i=this.state,n=this.zoom.startEvent,a=null==t?void 0:t.sourceEvent,t=(null==t?void 0:t.transform)===gi.zoomIdentity;n&&-1<n.type.indexOf("touch")&&(n=n.changedTouches[0],a=a.changedTouches[0]),"drag"===e.zoom_type&&a&&n.clientX===a.clientX&&n.clientY===a.clientY||(this.redrawEventRect(),this.updateZoom(),i.zooming=!1,t||S(e.zoom_onzoomend,this.api,this.zoom.getDomain()))},updateZoom:function(t){var e=this.scale,i=e.subX,n=e.x,a=e.zoom;a&&(e=a.domain(),a=i.domain(),e=(e[0]<=a[0]||e[0]-.015<=a[0])&&(a[1]<=e[1]||a[1]<=e[1]-.015),(t||e)&&(this.axis.x.scale(i),n.domain(i.orgDomain()),this.scale.zoom=null))},bindZoomOnEventRect:function(){var t=this.config,e=this.$el.eventRect,t="drag"===t.zoom_type?this.zoomBehaviour:this.zoom;this.$el.svg.on("wheel",function(){}),e.call(t).on("dblclick.zoom",null)},initZoomBehaviour:function(){var i,n=this,t=n.config,a=n.state,e=t.axis_rotated,r=0,s=0,o={axis:e?"y":"x",attr:e?"height":"width",index:e?1:0};n.zoomBehaviour=(0,Ct.drag)().clickDistance(4).on("start",function(t){a.event=t,n.setDragStatus(!0),n.unselectRect(),i=i||n.$el.main.append("rect").attr("clip-path",a.clip.path).attr("class",I.zoomBrush).attr("width",e?a.width:0).attr("height",e?0:a.height),r=L(t,this)[o.index],s=r,i.attr(o.axis,r).attr(o.attr,0),n.onZoomStart(t)}).on("drag",function(t){s=L(t,this)[o.index],i.attr(o.axis,Math.min(r,s)).attr(o.attr,Math.abs(s-r))}).on("end",function(t){var e=n.scale.zoom||n.scale.x;a.event=t,i.attr(o.axis,0).attr(o.attr,0),s<r&&(r=(t=[s,r])[0],s=t[1]),r<0&&(s+=Math.abs(r),r=0),r!==s&&n.api.zoom([r,s].map(function(t){return e.invert(t)})),n.setDragStatus(!1)})},setZoomResetButton:function(){var t=this,e=t.config,i=t.$el,n=e.zoom_resetButton;n&&"drag"===e.zoom_type&&(i.zoomResetBtn?i.zoomResetBtn.style("display",null):i.zoomResetBtn=t.$el.chart.append("div").classed(I.button,!0).append("span").on("click",function(){O(n.onclick)&&n.onclick.bind(t.api)(this),t.api.unzoom()}).classed(I.buttonZoomReset,!0).text(n.text||"Reset Zoom"))}},bi={data_selection_enabled:!1,data_selection_grouped:!1,data_selection_isselectable:function(){return!0},data_selection_multiple:!0,data_selection_draggable:!1,data_onselected:function(){},data_onunselected:function(){}},Ti={subchart_show:!1,subchart_showHandle:!1,subchart_size_height:60,subchart_axis_x_show:!0,subchart_axis_x_tick_show:!0,subchart_axis_x_tick_text_show:!0,subchart_init_range:void 0,subchart_onbrush:function(){}},wi={zoom_enabled:!1,zoom_type:"wheel",zoom_extent:void 0,zoom_privileged:!1,zoom_rescale:!1,zoom_onzoom:void 0,zoom_onzoomstart:void 0,zoom_onzoomend:void 0,zoom_resetButton:!0,zoom_x_min:void 0,zoom_x_max:void 0},Ai=function(){return W(Jt.prototype,_i),W(ie.prototype,di),lt.setOptions([bi]),(Ai=function(){return!0})()},ki=function(){return W(Jt.prototype,mi),W(ie.prototype,hi),lt.setOptions([Ti]),(ki=function(){return!0})()},Si=function(){return W(Jt.prototype,yi),W(ie.prototype,fi),lt.setOptions([wi]),(Si=function(){return!0})()},Ci={},Ei={version:"3.1.5",generate:function(t){t=Q({},Ci,t),t=new ie(t);return t.internal.charts=this.instance,this.instance.push(t),t},defaults:function(t){return Ci=N(t)?t:Ci},instance:[],plugin:{}};Object.keys(e).forEach(function(t){return e[t]()}),Object.keys(i).forEach(function(t){return i[t]()})}(),Li}()});